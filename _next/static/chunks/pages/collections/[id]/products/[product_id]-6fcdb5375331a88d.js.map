{"version":3,"file":"static/chunks/pages/collections/[id]/products/[product_id]-6fcdb5375331a88d.js","mappings":"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","sources":["webpack://_N_E/?cb1b","webpack://_N_E/./components/core/svg_button.tsx","webpack://_N_E/./components/pages/product/gallery.tsx","webpack://_N_E/./components/pages/product/options/commons/title.tsx","webpack://_N_E/./components/pages/product/options/select-with-quantity.tsx","webpack://_N_E/./hooks/use_pub_sub_request.ts","webpack://_N_E/./components/pages/product/options/checkbox.tsx","webpack://_N_E/./components/pages/product/title-price-badge.tsx","webpack://_N_E/./components/pages/product/add-to-cart.tsx","webpack://_N_E/./components/pages/product/options/buttons.tsx","webpack://_N_E/./components/pages/product/options/checkbox-group.tsx","webpack://_N_E/./components/pages/product/options/color-picker.tsx","webpack://_N_E/./components/pages/product/options/multi-select.tsx","webpack://_N_E/./components/pages/product/options/select.tsx","webpack://_N_E/./components/pages/product/price-top-slider.tsx","webpack://_N_E/./components/pages/product/header.tsx","webpack://_N_E/./components/pages/product/options.tsx","webpack://_N_E/./components/common/vertical-slider.tsx","webpack://_N_E/./components/pages/product/frequently-bought-with.tsx","webpack://_N_E/./components/pages/product/reviews.tsx","webpack://_N_E/./hooks/use_product_reviews_summary.ts","webpack://_N_E/./components/common/tabs_header.tsx","webpack://_N_E/./pages/collections/[id]/products/[product_id].tsx","webpack://_N_E/./node_modules/use-async-effect/index.js"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/collections/[id]/products/[product_id]\",\n      function () {\n        return require(\"private-next-pages/collections/[id]/products/[product_id].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/collections/[id]/products/[product_id]\"])\n      });\n    }\n  ","import { misc } from \"../../lib/misc\";\nimport { Image } from \"../common/scaled-next-image\";\nimport { EventPane } from \"./event_pane\";\n\nexport type SvgButtonProps = {\n    src: string;\n    aspectRatio: {width: number;height: number};\n    height?: number;\n    padding?: number;\n    paddingVert?: number;\n    paddingHori?: number;\n    filter?: string;\n    filterHover?: string;\n    filterTouchdown?: string;\n    animationDuration?: number;\n    onClick?: () => void;\n    opacity?: number;\n    opacityHover?: number;\n    opacityTouchdown?: number;\n};\n\nexport default function SvgButton({\n    src,\n    aspectRatio,\n    height = aspectRatio.height,\n    padding = 0,\n    paddingVert = padding,\n    paddingHori = padding,\n    filter,\n    filterHover = filter,\n    filterTouchdown = filterHover,\n    animationDuration = 0.3,\n    opacity = 1,\n    opacityHover = opacity,\n    opacityTouchdown = opacity,\n    onClick = () => {}\n}:SvgButtonProps)\n{\n    const imgSize = misc.createImageDimensions(aspectRatio.width,aspectRatio.height,height);\n\n    return (\n        <>\n            <div className=\"container\" style={{padding: `${paddingVert}rem ${paddingHori}rem`}}>\n                <div className=\"image-wrapper\" style={{width: `${imgSize.width}rem`,height: `${imgSize.height}rem`}}>\n                    <Image className=\"normal\" src={src} layout=\"fill\" />\n                    <Image className=\"hover\" src={src} layout=\"fill\" />\n                    <Image className=\"touchdown\" src={src} layout=\"fill\" />\n                </div>\n                <EventPane onClick={onClick} touchDownOnMouseDown />\n            </div>\n            <style jsx>{`\n            .container {                \n                display: inline-block;\n            }\n            .image-wrapper {\n                position: relative;\n            }\n            .image-wrapper img:global(.normal) {\n                ${filter?`filter: ${filter};`:\"\"}\n                opacity: ${opacity};\n                transition: opacity ${animationDuration}s;\n            }\n            .image-wrapper img:global(.hover) {\n                ${filterHover?`filter: ${filterHover};`:\"\"}\n                opacity: 0;\n                transition: opacity ${animationDuration}s;\n            }\n            .image-wrapper img:global(.touchdown) {\n                ${filterTouchdown?`filter: ${filterTouchdown};`:\"\"}\n                opacity: 0;\n                transition: opacity ${animationDuration}s;\n            }\n            .container.hover .image-wrapper img:global(.hover) {\n                opacity: ${opacityHover};\n            }            \n            .container.touchdown .image-wrapper img:global(.touchdown) {\n                opacity: ${opacityTouchdown};\n            }\n            .container.hover .image-wrapper img:global(.normal) {\n                opacity: 0;\n            }\n            .container.touchdown .image-wrapper img:global(.normal) {\n                opacity: 0;\n            }\n            `}</style>\n        </>\n    );\n}","import { forwardRef, MutableRefObject, useContext, useEffect, useImperativeHandle, useRef } from \"react\";\nimport { EventPane } from \"../../core/event_pane\";\nimport SvgButton from \"../../core/svg_button\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../hooks/use_smart_state\";\nimport { ConfigProductData } from \"../../../lib/prebuild-data/types\";\nimport { useResizeObserver } from \"../../../hooks/use_resize_observer\";\nimport { trackTouchMoveDelta } from \"../../../lib/touch_move_tracker\";\nimport { Image } from \"../../common/scaled-next-image\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\n\nexport type ProductGalleryProps = {\n    product: ConfigProductData;\n    onFrameResize?: (height: number) => void;\n};\n\nfunction FillImage({src}: {src: string}) {\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const show = cssStateManager.useState(false,\"show\");\n\n    const loadHandler = () => {\n        show.value = true;\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <Image src={src} layout=\"fill\" onLoad={loadHandler} />\n            </div>\n            <style jsx>{`\n            .container {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;\n                opacity: 0;\n                transition: opacity 1s;\n            }\n            .container.show {\n                opacity: 1;\n            }\n            `}</style>\n        </>\n    );\n}\n\nfunction GradualFillImage({smallSrc,largeSrc}: {smallSrc: string;largeSrc: string}) {\n    const { scalePixelToRem } = useContext(LayoutStateContext);\n    const cssStateManager = useCssStateManager([\"container\",\"gradual\"]);\n    const show = cssStateManager.useState(false,\"show\");\n    const showLarge = cssStateManager.useState(false,\"show-large\");\n    const loadLarge = useSmartState(false);\n\n    const ref = useRef<HTMLDivElement>();\n\n    const loadHandler = () => {\n        show.value = true;\n        if (ref.current) {\n            if (scalePixelToRem(ref.current.offsetHeight)>450) {\n                loadLarge.value = true;\n            }\n        }        \n    };\n\n    const loadLargeHandler = () => {\n        showLarge.value = true;\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()} ref={ref}>\n                <div className=\"image-frame\">\n                    <Image src={smallSrc} layout=\"fill\" onLoad={loadHandler} />\n                </div>\n                {loadLarge.value?(\n                    <div className=\"image-frame large-image\">\n                        <Image src={largeSrc} layout=\"fill\" onLoad={loadLargeHandler} />\n                    </div>\n                ):\"\"}\n            </div>\n            <style jsx>{`\n            .container {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;\n                opacity: 0;\n                transition: opacity 1s;\n            }\n            .container.show {\n                opacity: 1;\n            }\n\n            .image-frame {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;                \n            }\n\n            .large-image {\n                opacity: 0;\n            }\n\n            .show-large .large-image {\n                opacity: 1;\n            }\n            `}</style>\n        </>\n    );\n}\n\n\nfunction SliderPane({smallSrc,largeSrc,visible,position}: {smallSrc: string;largeSrc: string;visible: boolean;position: \"left\" | \"middle\" | \"right\"}) {\n    return (\n        <>\n            <div className={`container ${position} ${visible?\"visible\":\"\"}`}>\n                <GradualFillImage smallSrc={smallSrc} largeSrc={largeSrc} />\n            </div>\n            <style jsx>{`\n                .container {\n                    position: absolute;\n                    left: 0rem;\n                    top: 0rem;\n                    height: 100%;\n                    width: 100%;\n                    visibility: hidden;\n                }\n                .container.left {\n                    transform: translateX(-100%);    \n                }\n                .container.right {\n                    transform: translateX(100%);    \n                }\n                .container.visible {\n                    visibility: visible;\n                }\n            `}</style>\n        </>\n    );\n}\n\nexport type ProductGalleryRefInterface = {\n    slideToIndex: (index: number,bypassSlideshowAnimation?: boolean) => void;\n};\n\nfunction _ProductGallery({product,onFrameResize = () => {}}:ProductGalleryProps,ref: MutableRefObject<ProductGalleryRefInterface>)\n{\n    const { mobileDetect,scaleRemToPixel } = useContext(LayoutStateContext);\n    const { widthCutoff: mobileCutoff } = mobileDetect;\n    const g = useRef<string>();\n    const { largeImages: images,smallImages: thumbs } = product;\n\n    const rawIndexToRealIndex: {[index: number]: number} = {};\n    \n    if (images.length===2) {\n        rawIndexToRealIndex[0] = 0;\n        rawIndexToRealIndex[1] = 1;\n        rawIndexToRealIndex[2] = 0;\n        rawIndexToRealIndex[3] = 1;\n    }\n    else {\n        for(let i=0;i<images.length;i++) rawIndexToRealIndex[i] = i;\n    }\n\n    const rawIndexReserves: {[index: number]: number[]} = {};\n\n    Object.keys(rawIndexToRealIndex).forEach((_rawIndex) => {\n        const rawIndex = parseInt(_rawIndex);\n        const realIndex = rawIndexToRealIndex[rawIndex];\n        rawIndexReserves[realIndex] = rawIndexReserves[realIndex] || [];\n        rawIndexReserves[realIndex].push(rawIndex);        \n    });\n\n    const realIndexToRawIndex = (realIndex: number) => (realIndex===-1)?-1:rawIndexReserves[realIndex].shift();\n\n    const containIndex = (index: number) => (images.length+index)%images.length;\n\n    const viewIndex = useSmartState(0);\n    const thumbViewIndexRef = useRef(0);\n    const jumpViewIndexRef = useRef(-1);        \n    const lineUp = ((images.length>1)?[\n        ((jumpViewIndexRef.current!==-1) && (jumpViewIndexRef.current<viewIndex.value))?jumpViewIndexRef.current:containIndex(viewIndex.value-1),\n        viewIndex.value,\n        ((jumpViewIndexRef.current!==-1) && (jumpViewIndexRef.current>viewIndex.value))?jumpViewIndexRef.current:containIndex(viewIndex.value+1)\n    ]:[-1,0,-1])\n        .map(realIndexToRawIndex);\n\n    const bypassAnimationRef = useRef(false);\n\n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(bypassAnimationRef.current,\"bypass-animation\");    \n    const slideToLeft = useSmartState(false);\n    const slideToRight = useSmartState(false);\n    // const slideToLeft = cssStateManager.useState(false,\"slide-to-left\");\n    // const slideToRight = cssStateManager.useState(false,\"slide-to-right\");\n    const disableTransition = cssStateManager.useState(false,\"disable-transition\");    \n    cssStateManager.useProperty(images.length===1,\"single-image\");\n\n    const sliderTouchOffset = useSmartState(0);\n\n    const transitionEndCbRef = useRef<() => void>();\n\n    const transitionHasEnded = () => {\n        if (transitionEndCbRef.current) {\n            const saved = transitionEndCbRef.current;\n            transitionEndCbRef.current = undefined;\n            saved();\n        }\n        bypassAnimationRef.current = false;\n    };\n\n    const setSlidePosition = (index: number,cb: () => void = () => {}) => {\n        transitionEndCbRef.current = cb;\n        slideToLeft.value = index===-1;\n        slideToRight.value = index===1;\n    };\n\n    const sliderButtonHeight = 34;\n    const sliderButtonPadding = 15;\n    const sliderButtonOpacity = 0.2;\n    const sliderButtonOpacityHoverFactor = 1.45;\n    const sliderButtonOuterShift = 48;\n    const thumbSize = 63.5;\n    const thumbSpacer = 20;    \n\n    const thumbsFrameRef = useRef<HTMLDivElement>();\n\n    const scrollThumbToCenter = () => {\n        if (thumbsFrameRef.current) {            \n            const { current: thumbsFrameElem } = thumbsFrameRef;\n            const thumbSizePixels = scaleRemToPixel(thumbSize);\n            const thumbSpacerPixels = scaleRemToPixel(thumbSpacer);\n            const frameWidth = thumbsFrameElem.offsetWidth;\n            const thumbOffset = thumbViewIndexRef.current*(thumbSizePixels+thumbSpacerPixels);\n            const thumbOffsetCenter = thumbOffset+thumbSizePixels/2;\n            const idealScrollLeft = thumbOffsetCenter-frameWidth/2;\n\n            thumbsFrameElem.scrollTo({\n                left: idealScrollLeft,\n                behavior: \"smooth\"\n            });\n\n        }\n    };\n\n    const slideToNext = () => {\n        if (images.length===1) return;\n        const newViewIndex = (viewIndex.value+1)%images.length;\n        thumbViewIndexRef.current = newViewIndex;\n        scrollThumbToCenter();\n        setSlidePosition(1,() => {\n            disableTransition.value = true;\n            viewIndex.value = newViewIndex;\n            setSlidePosition(0);\n        });\n    };\n\n    const slideToPrevious = () => {\n        if (images.length===1) return;\n        const newViewIndex = (viewIndex.value===0)?images.length-1:viewIndex.value-1;\n        thumbViewIndexRef.current = newViewIndex;\n        scrollThumbToCenter();\n        setSlidePosition(-1,() => {\n            disableTransition.value = true;            \n            viewIndex.value = (viewIndex.value===0)?images.length-1:viewIndex.value-1;\n            setSlidePosition(0);\n        });\n    };    \n\n    const slideToIndex = (index: number,bypassSlideshowAnimation?: boolean) => {\n        if (images.length===1) return;\n        if (index===viewIndex.value) return;\n        if (bypassSlideshowAnimation) {\n            bypassAnimationRef.current = true;\n        }\n        const nextIndex = (viewIndex.value+1)%images.length;\n        const previousIndex = (viewIndex.value===0)?images.length-1:viewIndex.value-1;\n        if ((nextIndex===index) && (previousIndex===index)) {\n            if (index===0) {\n                slideToPrevious();    \n            }\n            else {\n                slideToNext();    \n            }\n        }\n        else if (nextIndex===index) {\n            slideToNext();\n        }\n        else if (previousIndex===index) {\n            slideToPrevious();\n        }\n        else {            \n            jumpViewIndexRef.current = index;\n            thumbViewIndexRef.current = index;\n            scrollThumbToCenter();\n            setSlidePosition((index>viewIndex.value)?1:-1,() => {\n                disableTransition.value = true;\n                jumpViewIndexRef.current = -1;\n                viewIndex.value = index;                    \n                setSlidePosition(0);\n            });        \n        }        \n    };\n\n    useImperativeHandle(ref,() => ({\n        slideToIndex\n    }));\n\n    useEffect(() => {\n        if (disableTransition.value) {\n            disableTransition.value = false;\n        }\n    },[disableTransition.value])\n\n    const imageIndexes: number[] = [];\n    for(let i=0;i<images.length+1;i++) imageIndexes.push(i);\n\n    const frameRef = useResizeObserver(({height}) => {\n        onFrameResize(height);\n    },{initialCall: true});\n\n    const touchPaneRef = useRef<HTMLDivElement>();    \n    const sliderRef = useRef<HTMLDivElement>();\n\n    const sliderTransitionAdjustment = useSmartState(false); \n\n    useEffect(() => {\n        return trackTouchMoveDelta(touchPaneRef.current,({wx}) => {\n            if (sliderRef.current) {\n                sliderRef.current.style.transition = \"transform 0s\";\n                sliderRef.current.style.transform = `translateX(${wx}rem)`;\n            }\n        },{\n            onStart: () => {\n            },onEnd: ({wx}) => {\n                if (sliderRef.current) {\n                    const sliderWidth = sliderRef.current.offsetWidth;\n                    const thresholdPerc = 20;\n                    const division = 100/thresholdPerc;\n                    if (wx<=(sliderWidth*-1)/division) {\n                        slideToNext();\n                    }\n                    else if (wx>=sliderWidth/division) {\n                        slideToPrevious();\n                    }\n                    sliderTransitionAdjustment.value = !sliderTransitionAdjustment.value;\n                }\n            },\n            deltaDirection: \"Horizontal\",\n            preventDefaultOnDelta: true\n        });\n    },[]);\n    \n    const sliderTranslateXPercNormal = 0+(sliderTransitionAdjustment.value?0.0000001:0);\n    const sliderTranslateXPerc = slideToLeft.value?100:(slideToRight.value?-100:sliderTranslateXPercNormal);\n    const sliderTransitionDurationNormal = 0.3+(sliderTransitionAdjustment.value?0.0000001:0);\n    const sliderTransitionDuration = disableTransition.value?0:(bypassAnimationRef.current?0.0000001:sliderTransitionDurationNormal);\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()} ref={frameRef} >\n                <div className=\"overflow-hidden-wrapper\">\n                    <div \n                        className=\"slider\" \n                        ref={sliderRef}\n                        onTransitionEnd={(e) => {\n                            if (e.propertyName===\"transform\") {\n                                transitionHasEnded();\n                            }\n                        }}\n                        style={{\n                            transform: `translateX(${sliderTranslateXPerc}%)`,\n                            transition: `transform ${sliderTransitionDuration}s`\n                        }}\n                    >\n                        {Object.keys(rawIndexToRealIndex).map((_rawIndex) => {\n                            const rawIndex = parseInt(_rawIndex);                            \n                            return <SliderPane \n                                key={rawIndex} \n                                smallSrc={prebuildData.bustCache(thumbs[rawIndexToRealIndex[rawIndex]].src)}\n                                largeSrc={prebuildData.bustCache(images[rawIndexToRealIndex[rawIndex]].src)}\n                                position={(lineUp[0]===rawIndex)?\"left\":((lineUp[2]===rawIndex)?\"right\":\"middle\")} \n                                visible={lineUp.indexOf(rawIndex)!==-1} \n                            />;\n                        })}\n                    </div>\n                </div>\n                <div className=\"slider-button slider-button-left\">\n                    <SvgButton \n                        src={prebuildData.bustCache(\"/images/product/gallery/left-arrow.svg\")} \n                        aspectRatio={{width: 120,height: 188}} \n                        height={sliderButtonHeight}\n                        paddingHori={sliderButtonPadding}\n                        paddingVert={sliderButtonPadding}\n                        opacity={sliderButtonOpacity}\n                        opacityHover={sliderButtonOpacity*sliderButtonOpacityHoverFactor}\n                        onClick={slideToPrevious}\n                    />\n                </div>\n                <div className=\"slider-button slider-button-right\">\n                    <SvgButton \n                        src={prebuildData.bustCache(\"/images/product/gallery/right-arrow.svg\")} \n                        aspectRatio={{width: 120,height: 188}} \n                        height={sliderButtonHeight}\n                        paddingHori={sliderButtonPadding}\n                        paddingVert={sliderButtonPadding}\n                        opacity={sliderButtonOpacity}\n                        opacityHover={sliderButtonOpacity*sliderButtonOpacityHoverFactor}\n                        onClick={slideToNext}\n                    />\n                </div>\n                <div className=\"touch-pane\" ref={touchPaneRef}>\n\n                </div>\n                {/*}\n                <EventPane onClick={() => slideToNext()} />\n                {*/}\n            </div>\n            <div className={`thumbs ${(images.length===1)?\"single-image\":\"\"}`}>\n                <div className=\"thumbs-frame\" ref={thumbsFrameRef} >\n                    {thumbs.map(({src},index) => (\n                        <div key={index} className={`thumb-wrapper ${(index===0)?\"first\":\"\"} ${(index===thumbViewIndexRef.current)?\"selected\":\"\"}`}>\n                            <div className=\"thumb-image-wrapper\">\n                                <FillImage src={prebuildData.bustCache(src)} />\n                            </div>                            \n                            <div className=\"outline\"></div>\n                            <EventPane onClick={() => slideToIndex(index)} />\n                        </div>\n                    ))}\n                </div>\n            </div>\n            <style jsx>{`\n            .thumbs {\n                position: relative;\n                height: ${thumbSize}rem;\n                width: 100%;\n                overflow: hidden;\n                margin-top: 10rem;\n            }\n            .thumbs.single-image {\n                display: none;\n            }\n            .thumbs-frame {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: calc(100% + 50rem);\n                overflow-x: auto;\n                overflow-y: hidden;\n                white-space: nowrap;\n            }\n            .thumb-wrapper {\n                width: ${thumbSize}rem;\n                height: ${thumbSize}rem;\n                margin-left: ${thumbSpacer}rem;                \n                display: inline-block;\n                position: relative;\n            }\n            .thumb-wrapper.first {\n                margin-left: 0rem;                \n            }\n            .thumb-wrapper .outline {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;\n                border: 2rem solid rgba(0,0,0,0.25);\n                opacity: 0;\n                transition: opacity 0.3s;\n            }\n            .thumb-wrapper.selected .outline {\n                opacity: 1;\n            }\n            .thumb-image-wrapper {\n                position: absolute;\n                --padding: 4rem;\n                left: var(--padding);\n                top: var(--padding);\n                right: var(--padding);\n                bottom: var(--padding);\n            }\n\n            `}</style>                \n            <style jsx>{`                \n            .container {\n                position: relative;\n                width: 100%;\n                padding: 50%;\n            }\n            .overflow-hidden-wrapper {\n                position: absolute;\n                overflow: hidden; \n                left: 0rem;\n                top: 0rem;\n                width: 100%;           \n                height: 100%;\n            }\n            .slider {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;              \n                transform: translateX(0rem);\n                /* transition: transform 0.3s; */               \n            }\n            .slider-wrapper {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                width: 100%;\n                height: 100%;             \n            }\n            .bypass-animation .slider {\n                /* transition-duration: 0.0000001s; */\n            }\n            .slider-pane {\n                position: absolute;\n                left: 0rem;\n                top: 0rem;\n                height: 100%;\n                width: 100%;\n            }\n            .slider-pane1 {\n                transform: translateX(-100%);\n            }\n            .slider-pane2 {\n            }\n            .slider-pane3 {\n                transform: translateX(100%);\n            }\n\n            /*\n            .slide-to-left .slider {\n                transform: translateX(100%);\n            }\n\n            .slide-to-right .slider {\n                transform: translateX(-100%);\n            }\n            */\n\n            .disable-transition .slider {\n                /* transition-duration: 0s; */\n            }\n            .slider-button {                \n                position: absolute;\n                top: calc(50% - ${(sliderButtonHeight+sliderButtonPadding*2)/2}rem);                \n            }\n            .slider-button-left {\n                left: -${sliderButtonOuterShift}rem;\n            }\n            .slider-button-right {\n                right: -${sliderButtonOuterShift}rem;\n            }\n            .single-image .slider-button {\n                display: none;\n            }\n\n            .touch-pane {\n                    display: block;\n                    position: absolute;\n                    left: 0rem;\n                    top: 0rem;\n                    right: 0rem;\n                    bottom: 0rem;\n                }\n\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .slider-button {\n                    display: none;\n                }\n\n                .touch-action-none .touch-pane {\n                    /* touch-action: none; */\n                }\n            }            \n            `}</style>            \n        </>\n    );\n}\n\nconst ProductGallery = forwardRef(_ProductGallery);\n\nexport default ProductGallery;","import { useContext } from \"react\";\nimport { LayoutStateContext } from \"../../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../../hooks/use_css_state_manager\";\nimport { SmartState } from \"../../../../../hooks/use_smart_state\";\nimport { OptionsOptionButtonsQuantity } from \"../../../../../lib/shared/options/types\";\nimport { prebuildData } from \"../../../../../lib/prebuild-data\";\nimport PriceDisplay from \"../../../../common/price-display\";\nimport { EventPane } from \"../../../../core/event_pane\";\n\nexport type OptionTitleProps = {\n    caption: string;\n    subCaption?: string;\n    quantity?: OptionsOptionButtonsQuantity;\n    quantityOn?: SmartState<boolean>;\n    price?: number;\n    priceEnabled?: boolean;\n};\n\nexport type QuantityOptionProps = {\n    quantity: OptionsOptionButtonsQuantity;\n    quantityOn: SmartState<boolean>;\n};\n\nexport type YesNoProps = {\n    quantityOn: SmartState<boolean>;\n};\n\nfunction YesNo({quantityOn}:YesNoProps)\n{\n    const cssStateManager = useCssStateManager([\"yes-no\"]);\n    cssStateManager.useProperty(quantityOn.value,\"on\");    \n\n    const clickHandler = () => {\n        quantityOn.value = !quantityOn.value;\n    };\n\n    const { productOptions: { sliderNoColor,sliderNoTextColor,sliderYesColor,sliderYesTextColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"switch\">\n                    <div className=\"slider\"></div>\n                    <div className=\"option right\">No</div>\n                    <div className=\"option left\">Yes</div>\n                </div>\n                <EventPane onClick={clickHandler} />\n            </div>\n            <style jsx>{`\n            .yes-no {\n                display: inline-block;\n                position: relative;\n                left: 6rem;           \n                top: 5rem; \n                font-size: 15rem;\n                --height: 22rem;\n                --width: 48rem;\n                --padding: 3rem;\n                --slider-size: calc(var(--height) - (var(--padding) * 2));\n                --duration: 0.2s;\n            }\n            .switch {\n                position: relative;\n                width: var(--width);\n                height: var(--height);\n                background-color: ${sliderNoColor};\n                border-radius: var(--height);\n                transition: background-color var(--duration);\n            }\n            .on .switch {\n                background-color: ${sliderYesColor};\n            }\n            .slider {\n                position: absolute;                                \n                height: var(--slider-size);\n                width: var(--slider-size);\n                background-color: ${sliderNoTextColor};\n                top: var(--padding);\n                left: var(--padding);\n                border-radius: var(--slider-size);\n                transition: transform var(--duration);\n            }\n            .on .slider {\n                transform: translateX(calc(var(--width) - (var(--padding) * 2) - var(--slider-size)));\n                background-color: ${sliderYesTextColor};\n            }\n            .option {\n                position: absolute;                \n                top: 50%;\n                transform: translateY(-8rem);\n                font-size: 11rem;\n                font-weight: 600;\n                transition: opacity var(--duration);\n            }\n            .option.left {\n                opacity: 0;\n                left: calc(var(--padding) + 5rem);\n                color: ${sliderYesTextColor};\n            }\n            .option.right {\n                opacity: 1;\n                right: calc(var(--padding) + 6rem);\n                color: ${sliderNoTextColor};\n            }\n\n            .on .option.left {\n                opacity: 1;\n            }\n            .on .option.right {\n                opacity: 0;\n            }\n            `}</style>\n        </>\n    );\n}\n\nfunction QuantityOption({quantity,quantityOn}:QuantityOptionProps)\n{    \n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const { productOptions: { lightTextColor } } = prebuildData.getActiveTheme();\n\n    const cssStateManager = useCssStateManager([\"quantity-option\"]);\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                {quantity.caption} <YesNo quantityOn={quantityOn} />\n            </div>\n            <style jsx>{`\n            .quantity-option {\n                display: inline-block;\n                color: ${lightTextColor};\n                font-size: 17rem;\n                position: relative;\n                top: -2rem;                \n                left: 10rem;            \n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .quantity-option {\n                    left: 0rem;\n                    font-size: 16rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport default function OptionTitle({caption,subCaption,quantity,quantityOn,price,priceEnabled = false}:OptionTitleProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const cssStateManager = useCssStateManager([\"option-title\"]);\n    cssStateManager.useProperty(priceEnabled,\"price-enabled\");\n\n    const { productOptions: {\n        textColor,\n        lightTextColor,\n        addonsPriceSelectedTextColor,\n        addonsPriceUnselectedTextColor\n    } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                {caption} {subCaption?<span>{subCaption}</span>:\"\"} <br className=\"br\" />{(quantity && quantityOn)?<QuantityOption quantity={quantity} quantityOn={quantityOn} />:\"\"}\n                {(typeof price===\"number\")?(\n                    <div className=\"price\">\n                        <PriceDisplay price={price} size={18} plus />\n                    </div>\n                ):\"\"}\n            </div>\n            <style jsx>{`\n            .option-title {\n                font-size: 23rem;\n                font-weight: 600;\n                color: ${textColor};\n                margin-bottom: 20rem;\n                position: relative;\n            }\n            .option-title span {\n                color: ${lightTextColor};\n                font-size: 16rem;\n                position: relative;\n                top: -2rem;                \n                left: 3rem;            \n            }\n            .price {\n                position: absolute;\n                color: ${addonsPriceUnselectedTextColor};\n                top: -5rem;\n                right: 2rem;\n                transition: color 0.3s;\n            }\n            .price-enabled .price {\n                color: ${addonsPriceSelectedTextColor};\n            }\n            .br {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .br {\n                    display: inline;\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { SmartState, useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueVariantSelect } from \"../../../../lib/services/cart/types\";\nimport OptionTitle from \"./commons/title\";\n\nexport type SelectWithQuantityProps = {\n    title: string;\n    subTitle?: string;\n    unselectedCaption: string;\n    entries: SelectWithQuantityEntry[];\n    onValue?: (value: OptionValueVariantSelect | null) => void;\n    loadFromSavedValue?: OptionValueVariantSelect;\n    price?: number;\n};\n\nexport type SelectWithQuantityEntry = {\n    caption: string;\n    value: string;\n};\n\nexport type QuantityProps = {\n    excludeZero?: boolean;\n    value: SmartState<QuantityValue>;\n    bypassCustomFocus?: boolean;\n    onBypassCustomFocusDone?: () => void;\n    inBadge?: boolean;\n};\n\nexport type QuantityValue = {    \n    value: number;\n    valueDisplay: string;\n    custom: boolean;\n};\n\nexport function QuantitySelect({\n        value,\n        excludeZero = false,\n        bypassCustomFocus = false,\n        onBypassCustomFocusDone = () => {},\n        inBadge = false\n    }:QuantityProps) \n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(value.value.custom,\"editing\");\n    cssStateManager.useProperty(inBadge,\"in-badge\");\n\n    const changeHandler = (index: number) => {\n        value.value = {\n            custom: (index===11),\n            value: (index<11)?index:11,\n            valueDisplay: (index<11)?\"\":\"11\"\n        };\n    };\n\n    const textRef = useRef<HTMLInputElement>();\n\n    useEffect(() => {\n        if (value.value.custom) {\n            if (textRef.current) {\n                if (bypassCustomFocus) {\n                    return onBypassCustomFocusDone();\n                }\n                textRef.current.focus();\n                const val = textRef.current.value;\n                textRef.current.value = \"\";\n                textRef.current.value = val;\n            }\n        }\n    },[value.value.custom]);\n\n    const textChangeHandler = (textValue: string) => {\n        textValue = textValue.split(\"\").filter((ch) => /[0-9]/.test(ch)).join(\"\");\n        value.value = {\n            custom: true,\n            value: parseInt(textValue),\n            valueDisplay: textValue\n        };\n    };\n\n    const textBlurHandler = () => {\n        let { valueDisplay: textValue } = value.value;\n        const intValue = parseInt(textValue) || 0;\n        if (intValue<11) {\n            value.value = {\n                custom: false,\n                value: intValue,\n                valueDisplay: \"\"\n            };\n        }\n        else {\n            value.value = {\n                custom: true,\n                value: intValue,\n                valueDisplay: intValue.toString()\n            };\n        }\n    };\n\n    const { productOptions: { buttonSelectedTextColor,buttonBackgroundColor,buttonUnselectedTextColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <select className=\"select\" onChange={(e) => changeHandler(parseInt(e.target.value))} value={value.value.custom?\"11\":value.value.value.toString()}>\n                    {Array(12).fill(0).map((_,index) =>                         \n                        (!excludeZero || (index>0))?<option key={index} value={index.toString()}>{(index<11)?index.toString():\"10+\"}</option>:\"\"\n                    )}\n                </select>\n                <input ref={textRef} className=\"text\" value={value.value.valueDisplay} onBlur={textBlurHandler} onChange={(e) => textChangeHandler(e.target.value)} />\n                <div className=\"title\">\n                    Quantity\n                    <div className=\"cover\"></div>\n                </div>\n            </div>\n            <style jsx>{`\n                .container {\n                    width: 100%;\n                    position: relative;\n                }\n                .text {\n                    width: 100%;\n                    height: 45rem;\n                    outline: none;\n                    border: 1rem solid rgba(190, 190, 190);\n                    border-radius: 5rem;\n                    font-size: 16rem;\n                    font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                    padding-left: 13rem;\n                    color: ${buttonSelectedTextColor};\n                    background-color: ${buttonBackgroundColor};\n                    font-weight: 600;\n                    display: none;\n                }\n                .select {\n                    cursor: pointer;\n                    height: 45rem;\n                    outline: none;\n                    border: 1rem solid rgba(190, 190, 190);\n                    border-radius: 5rem;\n                    width: 100%;\n                    font-size: 16rem;\n                    font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                    padding: 0rem 9rem;\n                    color: ${buttonSelectedTextColor};\n                    background-color: ${buttonBackgroundColor};\n                    font-weight: 600;\n                }\n                .title {\n                    position: absolute;\n                    left: calc(50% - 5rem);\n                    top: -8rem;\n                    transform: translateX(-50%);\n                    font-size: 10rem;\n                    color: ${buttonUnselectedTextColor};                    \n                    background-color: var(--body-background-color);\n                    padding: 0rem 2rem;\n                }\n                .title .cover {\n                    display: none;\n                }\n                .editing .text {\n                    display: block;\n                }\n                .editing .select {\n                    display: none;\n                }\n\n                .select,.text {\n                    background-color: ${buttonBackgroundColor};\n                }\n\n                .title {\n                    background-color: transparent;\n                }\n\n                .title .cover {\n                    display: block;\n                    position: absolute;\n                    left: 0rem;\n                    right: 0rem;\n                    top: 8rem;\n                    bottom: 0rem;\n                    background-color: ${buttonBackgroundColor};\n                    z-index: -1;\n                }\n\n                @media screen and (max-width: ${mobileCutoff}px) {\n                }\n\n            `}</style>\n        </>\n    );\n}\n\nexport default function SelectWithQuantity({\n        title,\n        subTitle = \"\",\n        unselectedCaption,\n        entries,\n        onValue = () => {},\n        loadFromSavedValue,\n        price\n    }:SelectWithQuantityProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const unselectedValue = \"--unselected--\";\n    const removeCaption = \"-- Remove --\";\n    const removeValue = \"--remove--\";\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const selectValue = useSmartState(\"--unselected--\");\n    cssStateManager.useProperty(selectValue.value!==unselectedValue,\"selected\");\n    const initialQuantityValue = {custom: false,value: 1,valueDisplay: \"\"};\n    const quantityValue = useSmartState<QuantityValue>(initialQuantityValue,{\n        onSet: (value) => {\n            if ((!value.custom) && (value.value===0)) {\n                selectValue.value = unselectedValue;\n                quantityValue.value = {\n                    ...initialQuantityValue\n                };\n            }\n            else {\n                if (selectValue.value===unselectedValue) {\n                    onValue(null);\n                }\n                else {\n                    onValue({\n                        type: \"variant-select\",\n                        id: selectValue.value,\n                        quantity: value.value\n                    });\n                }\n            }                        \n        }\n    });\n\n    \n\n    const bypassCustomFocusRef = useRef(false);\n    const bypassCustomFocusDoneHandler = () => {\n        bypassCustomFocusRef.current = false;\n    };\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            bypassCustomFocusRef.current = true;\n            selectValue.value = loadFromSavedValue.id;\n            quantityValue.value = {\n                custom: (loadFromSavedValue.quantity!>10),\n                value: loadFromSavedValue.quantity!,\n                valueDisplay: loadFromSavedValue.quantity!.toString()\n            };\n        }\n    },[loadFromSavedValue]);\n\n    useEffect(() => {\n        if (selectValue.value===removeValue) {\n            selectValue.value = unselectedValue;\n            quantityValue.value = {\n                ...initialQuantityValue\n            };\n        }\n    },[selectValue.value]);\n\n    const { productOptions: { buttonSelectedTextColor,buttonBackgroundColor,buttonUnselectedTextColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <OptionTitle caption={title} subCaption={subTitle} price={price?price*quantityValue.value.value:undefined} priceEnabled={selectValue.value!==unselectedValue} />\n                <div className=\"controls\">\n                    <select className=\"select\" onChange={(e) => {\n                        selectValue.value = e.target.value;\n                        if (quantityValue.value.value!==1) {\n                            quantityValue.value = {...initialQuantityValue};\n                        }\n                        else {\n                            onValue({\n                                type: \"variant-select\",\n                                id: e.target.value,\n                                quantity: quantityValue.value.value\n                            });    \n                        }\n                    }} value={selectValue.value}>\n                        <option className=\"hidden-option\" value={unselectedValue}>{unselectedCaption}</option>\n                        <option className=\"remove-option\" value={removeValue}>{removeCaption}</option>                        \n                        {entries.map(({caption,value},index) => <option key={index} value={value}>{caption}</option>)}\n                    </select>\n                    <div className=\"quantity-wrapper\">\n                        <QuantitySelect \n                            value={quantityValue} \n                            bypassCustomFocus={bypassCustomFocusRef.current}\n                            onBypassCustomFocusDone={bypassCustomFocusDoneHandler}\n                        />\n                    </div>\n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n                padding-bottom: 16rem;\n            }\n            .controls {\n                display: flex;\n            }\n            .select {\n                cursor: pointer;\n                height: 45rem;\n                outline: none;\n                border: 1rem solid rgba(190, 190, 190);\n                border-radius: 5rem;\n                width: 100%;\n                font-size: 16rem;\n                font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                padding: 0rem 9rem;\n                color: ${buttonUnselectedTextColor};\n                background-color: ${buttonBackgroundColor};\n                font-weight: 600;            \n                flex: 1 1;\n            }\n            .select option {\n                color: ${buttonSelectedTextColor};\n            }\n            .selected .select {\n                color: ${buttonSelectedTextColor};\n            }\n\n            .remove-option {\n                display: none;   \n            }\n\n            .selected .remove-option {\n                display: block;\n            }\n\n            .hidden-option {\n                display: none;\n            }\n            .quantity-wrapper {\n                flex: 0 0 80rem;\n                padding-left: 8rem;\n                display: none;\n            }        \n            .selected .quantity-wrapper {\n                display: block;\n            }   \n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .select {\n                    background-color: var(--body-background-color);\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { useEffect } from \"react\";\n\nexport type PubSubRequestCallback = () => Promise<any>;\n\nconst cbs: {[channel: string]: PubSubRequestCallback} = {}\n\nexport const usePubSubRequest = (channel: string,cb: PubSubRequestCallback) => {\n    useEffect(() => {\n        cbs[channel] = cb;\n        return () => {\n            if (cbs[channel]===cb) delete cbs[channel];\n        };\n    },[]);\n};\n\nexport const pubSubRequest = async <T = any>(channel: string) => {\n    if (cbs[channel]) {\n        return (await cbs[channel]()) as T;\n    }\n    else {\n        return null;\n    }\n};","import { useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueCheckbox } from \"../../../../lib/services/cart/types\";\nimport { EventPane } from \"../../../core/event_pane\";\nimport SquareImage from \"../../../core/square_image\";\nimport OptionTitle from \"./commons/title\";\n\nexport type CheckboxOptionProps = {\n    title: string;\n    subTitle?: string;\n    productId: string;\n    description: string;\n    titleStyle?: \"external\" | \"internal\";\n    included?: boolean;\n    onValue?: (value: OptionValueCheckbox) => void;\n    loadFromSavedValue?: OptionValueCheckbox;\n    inBadge?: boolean;\n    price?: number;\n};\n\nexport default function CheckboxOption({\n        title,\n        productId,\n        description,\n        subTitle = \"\",\n        titleStyle = \"external\",\n        included = false,\n        onValue = () => {},\n        loadFromSavedValue,\n        inBadge = false,\n        price\n    }:CheckboxOptionProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const padding = 1;\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const selected = cssStateManager.useState(false,\"selected\");\n    cssStateManager.useProperty(titleStyle===\"internal\",\"internal\");\n    cssStateManager.useProperty(inBadge,\"in-badge\");    \n    cssStateManager.useProperty(included,\"included\");    \n    const thumbSrcRef = useRef(\"\");\n    if (thumbSrcRef.current===\"\") {\n        const product = prebuildData.getProductById(productId);\n        if (product) {\n            thumbSrcRef.current = prebuildData.bustCache(product.smallImages[0].src);            \n        }\n    }\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            handleClick();\n        }\n    },[loadFromSavedValue]);\n\n    const handleClick = () => {\n        const newValue = !selected.value;\n        selected.value = newValue;\n        if (newValue) {\n            onValue({\n                type: \"checkbox\",                \n            });\n        }\n        else {\n            onValue(null);\n        }\n    };\n\n    const { productOptions: { buttonSelectedBackgroundColor,buttonBackgroundColor,addonsDescriptionColor,addonsIncludedDescriptionColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                {(titleStyle===\"external\")?<OptionTitle caption={title} subCaption={subTitle} price={price} priceEnabled={selected.value} />:\"\"}\n                <div className=\"box\">\n                    <div className=\"outline\"></div>\n                    <div className=\"image\">\n                        {thumbSrcRef.current?<SquareImage src={thumbSrcRef.current} fadeIn />:\"\"}                        \n                    </div>                    \n                    <div className=\"description-frame\">\n                        <div className=\"internal-title\">{title}</div>\n                        <div className=\"description\">\n                            {description}\n                        </div>\n                    </div>\n                    {!included?<EventPane onClick={handleClick} />:\"\"}                    \n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n                --selected-color: ${buttonSelectedBackgroundColor};\n            }\n            .box {\n                position: relative;\n                width: 100%;\n                border: 1rem solid rgba(190,190,190);\n                border-radius: 5rem;\n                padding: 10rem;\n                display: flex;                \n                /* align-items: center; */\n                background-color: ${buttonBackgroundColor};\n                transition: background-color 0.3s;\n            }\n            .selected .box,.included .box {\n                background-color: var(--selected-color);\n            }\n            .outline {\n                position: absolute;\n                left: -${padding}rem;\n                top: -${padding}rem;\n                bottom: -${padding}rem;\n                right: -${padding}rem;\n                border: 2rem solid #9ba2fb;\n                border-radius: 5rem;\n                opacity: 0;\n                transition: opacity 0.3s;                \n            }\n            .selected .outline {\n                opacity: 1;\n            }\n            .image {\n                flex: 0 0 60rem;\n            }\n            .description-frame {\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                padding-left: 10rem;\n            }\n            .internal .description-frame {\n                justify-content: start;\n            }\n            .description {\n                font-size: 12rem;\n                color: ${addonsDescriptionColor};\n            }\n            .internal-title {\n                display: none;\n                font-size: 12rem;\n                font-weight: 600;\n                color: ${addonsIncludedDescriptionColor};\n                margin-bottom: 5rem;\n                padding-top: 3rem;\n            }\n            .internal .internal-title {\n                display: block;\n            }\n            .in-badge .box {\n                border: none;\n                background-color: transparent;\n            }\n            .in-badge {\n                text-align: left;\n            }\n            .in-badge .image {\n                flex: 0 0 54rem;\n                position: relative;\n                top: 1rem;\n            }\n            .in-badge .description {\n                font-size: 10rem;\n            }\n            .in-badge .internal-title {\n                font-size: 11rem;\n            }\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .box {\n                    --selected-color: ${buttonBackgroundColor};\n                    background-color: var(--body-background-color);\n                }\n\n                .outline {\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { MutableRefObject, useContext, useEffect, useRef } from \"react\";\nimport useAsyncEffect from \"use-async-effect\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { consumeReviewsHeader } from \"../../../hooks/use_reviews_header\";\nimport { SmartState, useSmartState } from \"../../../hooks/use_smart_state\";\nimport { apiReview } from \"../../../lib/api/review\";\nimport { OptionsOptionCheckbox } from \"../../../lib/shared/options/types\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\nimport { CartItem } from \"../../../lib/services/cart/types\";\nimport { AddToCartActions } from \"../../../pages/collections/[id]/products/[product_id]\";\nimport { ConfigProduct } from \"../../../scripts/pre-build/types\";\nimport PriceDisplay from \"../../common/price-display\";\nimport PriceDisplayWithDiscount from \"../../common/price-display-with-discount\";\nimport StarRating from \"../../common/star_rating\";\nimport { EventPane } from \"../../core/event_pane\";\nimport AddToCart from \"./add-to-cart\";\nimport CheckboxOption from \"./options/checkbox\";\nimport PriceUpdate from \"./price-update\";\n\nexport type TitlePriceBadgeProps = {\n    editCartItem?: CartItem;\n    product: ConfigProduct;\n    price: number;\n    onReadMoreReviewsClick?: () => void;\n    alreadyAddedToCart: boolean;\n    alreadyAlreadyAddedToCart: boolean;\n    enabled: boolean;\n    addToCartActionsRef: MutableRefObject<AddToCartActions>;\n    noticeText?: string;\n};\n\ntype ReviewHighlightProps = {\n    product: ConfigProduct;\n    onReadMoreReviewsClick?: () => void;\n    enabled: boolean;\n    hideReview: SmartState<boolean>;\n};\n\ntype PlaceholderBarProps = {\n    height?: number;\n    width?: number;\n    marginBottom?: number;\n    enabled: boolean;\n};\n\nfunction PlaceholderBar({height = 16,width = -1,marginBottom = 0,enabled}:PlaceholderBarProps) {\n    return (<>\n        <div className=\"bar\" style={{\n            height: `${height}rem`,\n            width: `${(width===-1)?\"100%\":`${width}rem`}`,\n            marginBottom: `${marginBottom}rem`,\n            backgroundColor: enabled?\"#e7e7e7\":\"#efefef\"\n        }}></div>\n        <style jsx>{`\n            .bar {\n                opacity: 1;\n            }\n        `}</style>\n    </>);\n}\n\nfunction ReviewHighlight({product,onReadMoreReviewsClick = () => {},enabled,hideReview}:ReviewHighlightProps) {\n    const cssStateManager = useCssStateManager([\"review-highlight\"]);    \n\n    const { scalePixelToRem } = useContext(LayoutStateContext);\n\n    const title = useSmartState(\"\");\n    const body = useSmartState(\"\");\n    const author = useSmartState(\"\");\n\n    const placeholderFlashOn = cssStateManager.useState(false,\"placeholder-flash\");\n    const reviewReady = cssStateManager.useState(false,\"review-ready\");\n\n    const containerHeight = useSmartState(-1);\n    const containerHeightDuration = useSmartState(0);\n\n    useEffect(() => {\n        placeholderFlashOn.value = true;\n    },[]);\n\n    const reviewRef = useRef<HTMLDivElement>();\n    const placeholderRef = useRef<HTMLDivElement>();\n\n    useAsyncEffect(async (isMounted) => {        \n        const review = await apiReview.getHighlight(product.id);\n        console.log(\"review\",review);\n        if (!isMounted()) return;\n        if (review) {\n            title.value = review.title;\n            body.value = review.body;\n            author.value = review.name;\n            reviewReady.value = true;\n            if ((placeholderRef.current) && (reviewRef.current)) {\n                const diff = Math.abs(placeholderRef.current.offsetHeight-reviewRef.current.offsetHeight);\n                const secondsPerRem = 0.008;\n                containerHeightDuration.value = secondsPerRem*scalePixelToRem(diff);\n                containerHeight.value = scalePixelToRem(placeholderRef.current.offsetHeight);\n                setTimeout(() => {\n                    if (reviewRef.current) {\n                        containerHeight.value = scalePixelToRem(reviewRef.current.offsetHeight);\n                    }                    \n                },50);\n            }\n        }\n        else {\n            hideReview.value = true;\n        }\n    },[]);\n\n    const placeholderTransitionEndHandler = (elem: HTMLDivElement,propertyName: string) => {\n        if ((elem===placeholderRef.current) && (propertyName===\"opacity\") && (!reviewReady.value)) {\n            placeholderFlashOn.value = !placeholderFlashOn.value;\n        }\n    };\n\n    const getContainerHeightValue = () => {\n        const { value } = containerHeight;\n        if (value===-1)\n        {\n            return \"auto\";\n        }\n        else {\n            return `${value}rem`;\n        }\n    };\n\n    const { productPriceTitleBadge: { reviewBodyTextColor,readMoreHoverTextColor,readMoreTextColor } } = prebuildData.getActiveTheme();\n\n    return (<>\n        <div className={cssStateManager.getClassNames()} style={{\n            height: getContainerHeightValue(),\n            transition: `height ${containerHeightDuration.value}s`\n        }}>\n            <div className=\"placeholder-frame\">\n                <div ref={placeholderRef} className=\"placeholder\" onTransitionEnd={(e) => placeholderTransitionEndHandler(e.target as HTMLDivElement,e.propertyName)}>\n                    <PlaceholderBar width={160} marginBottom={12} enabled={enabled} />\n                    <PlaceholderBar height={12} marginBottom={6} enabled={enabled} />\n                    <PlaceholderBar height={12} marginBottom={6} enabled={enabled} />\n                    <PlaceholderBar height={12} marginBottom={6} enabled={enabled} />\n                    <PlaceholderBar height={12} marginBottom={6} enabled={enabled} />\n                    <PlaceholderBar height={12} marginBottom={12} enabled={enabled} />\n                    <PlaceholderBar width={90} marginBottom={28} enabled={enabled} />\n                    <PlaceholderBar width={80} marginBottom={5} enabled={enabled} />\n                    <PlaceholderBar width={15} height={12} marginBottom={12} enabled={enabled} />\n                </div>\n            </div>\n            <div ref={reviewRef} className=\"review-frame\">\n                <div className=\"review\">\n                    <div className=\"review-title\">{title.value}</div>\n                    <div className=\"review-body\">\"{body.value}\"</div>\n                    <div className=\"review-author\">- {author.value}</div>\n                </div>\n                <div className=\"see-more-button\">\n                    <div className=\"see-more-button-text\">Read More</div>\n                    <div className=\"see-more-button-arrow\"><i className=\"icon-navbar-left-arrow\"></i></div>\n                    <EventPane onClick={onReadMoreReviewsClick} />\n                </div>\n            </div>\n        </div>\n        <style jsx>{`\n            .review-highlight {\n                position: relative;\n                --ready-duration: 0.5s;\n                overflow-y: hidden;\n            }\n            .placeholder {\n                padding-top: 2rem;\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                opacity: 1;\n                transition: opacity 0.6s;\n            }\n            .placeholder-flash .placeholder {\n                opacity: 0.5;\n            }\n            .placeholder-frame {\n                opacity: 1;\n                transition: opacity var(--ready-duration);\n            }\n            .review-ready .placeholder-frame {\n                opacity: 0;\n            }\n\n            .review-frame {\n                position: absolute;\n                top: 0rem;\n                left: 0rem;\n                right: 0rem;\n                opacity: 0;\n                transition: opacity var(--ready-duration);\n            }\n            .review-ready .review-frame {\n                opacity: 1;\n            } \n            .review {\n                font-size: 13rem;\n                margin-bottom: 6rem;\n            }\n            .review-title {\n                font-weight: 600;\n                margin-bottom: 8rem;\n            }\n            .review-body {\n                font-style: italic;\n                margin-bottom: 8rem;\n                color: ${reviewBodyTextColor};\n            }\n            .review-author {\n                font-weight: 600;\n            }\n            .see-more-button {\n                font-size: 14rem;\n                padding: 0rem 20rem;\n                padding-top: 20rem;\n                color: ${readMoreTextColor};\n                position: relative;\n                display: inline-block;                \n                transition: color 0.3s;\n            }\n            .see-more-button.hover {\n                color: ${readMoreHoverTextColor};\n            }\n            .see-more-button-text {\n                margin-bottom: 2rem;\n            }\n            .see-more-button-arrow {\n                transform: rotate(-90deg);\n                font-size: 12rem;\n            }\n        `}</style>\n    </>);\n}\n\nfunction Separator({enabled}: {enabled: boolean}) {\n    const cssStateManager = useCssStateManager([\"separator\"]);\n    cssStateManager.useProperty(!enabled,\"disabled\");\n\n    const { productPriceTitleBadge: { separatorLineColor } } = prebuildData.getActiveTheme();\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}><div></div></div>\n            <style jsx>{`\n            .separator {\n                display: inline-block;\n                width: 85%;\n                padding: 20rem 0rem;                \n            }\n            .separator div {\n                height: 1rem;\n                background-color: ${separatorLineColor};\n                transition: background-color var(--duration);\n            }\n            .disabled .separator div {\n                background-color: ${separatorLineColor};\n            }            \n            `}</style>\n        </>\n    );\n}\n\nexport type IncludesProps = {\n    product: ConfigProduct;\n    enabled: boolean;\n};\n\nexport function Includes({product,enabled}:IncludesProps)\n{\n    const optionsCompiler = prebuildData.getOptionsCompiler();\n    \n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const cssStateManager = useCssStateManager([\"includes\"]);\n    cssStateManager.useProperty(!enabled,\"disabled\");\n\n    const productOptions = optionsCompiler.getProductOptions(product.id);    \n    const includedOptions = productOptions.options.filter((option) => (option.type===\"checkbox\") && (option.included)) as OptionsOptionCheckbox[];\n\n    const checkboxProductFnCacheRef = useRef<{[id: string]: any}>({});\n    const { current: checkboxProductFnCache } = checkboxProductFnCacheRef;\n\n    if (includedOptions.length===0) return null;\n\n    const getCaption = () => {\n        const captions = {\n            \"bundle\": \"Included in bundle\",\n            \"pack\": \"Included in pack\",\n            \"other\": \"Included\"\n        };\n        const lowerCaseCaption = product.caption.toLowerCase();\n        return captions[(lowerCaseCaption.indexOf(\"bundle\")!==-1)?\"bundle\":((lowerCaseCaption.indexOf(\"pack\")!==-1)?\"pack\":\"other\")];\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"spacer\"></div>\n                \n                <div className=\"separator\">\n                    <Separator enabled={enabled} />                \n                </div>\n                \n                <div className=\"title\"><span>{getCaption()}</span></div>\n                {includedOptions.map(({caption,description,product,id},index) => {\n                    let productFn = () => ({id: \"\"});\n                    if (product) {                                \n                        productFn = (checkboxProductFnCache[id] = checkboxProductFnCache[id] || prebuildData.evalInContext(product));\n                    }\n                    const productId = productFn()?.id || \"\";\n\n                    return (\n                        <div key={productId} className={`included-checkbox-wrapper ${(index===includedOptions.length-1)?\"is-last\":\"\"}`}>\n                            <CheckboxOption\n                                title={caption}\n                                titleStyle={\"internal\"}\n                                productId={productId}\n                                description={description}\n                                included      \n                                inBadge\n                            />\n                        </div>\n                    );\n                })}\n            </div>\n            <style jsx>{`\n            .includes {                \n                margin-left: -12rem;\n            }\n\n            .spacer {\n                height: 10rem;\n            }\n\n            .title {                \n                font-size: 13rem;\n                padding-bottom:6px;\n                margin-top: -36rem;                \n                z-index: 1;\n                position: relative;                \n                text-align: center;                \n\n                /* font-size: 16rem;\n                font-weight: 600; */\n                /* margin-top: 0rem; */                \n                /* margin-top: 24rem; */\n                /* text-align: left;                */\n                /* color: #666; */\n\n                /* text-align: center; */\n            }\n\n            .title span {\n                color: #999;\n                background-color: #f7f7f7;\n                padding: 0rem 12rem;\n                transition: background-color var(--duration),color var(--duration);\n            }\n\n            .disabled .title span {\n                color: #aaa;\n                background-color: #fff;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .separator {\n                    display: none;\n                }\n\n                .includes {\n                    margin-top: 60rem;\n                    margin-bottom: 0rem;\n                }\n\n                .title span,.disabled .title span {\n                    background-color: transparent;\n                }\n\n                .title {\n                    text-align: left;\n                    font-size: 13rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type NoticeProps = {\n    text?: string;\n};\n\nexport function Notice({text}:NoticeProps)\n{\n    const cssStateManager = useCssStateManager([\"notice\"]);\n\n    if (!text) return null;\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"title\">NOTICE</div>\n                <span dangerouslySetInnerHTML={{__html: text}}></span>\n            </div>\n            <style jsx>{`\n            .notice {\n                border: 2rem solid #000;\n                text-align: center;\n                padding: 12rem 20rem;\n                font-size: 12rem;\n                color: #363636;\n                margin-top: 20rem;\n            }\n            .title {\n                font-size: 16rem;\n                font-weight: 600;\n                margin-bottom: 5rem;\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport default function TitlePriceBadge({editCartItem,product,addToCartActionsRef,price,onReadMoreReviewsClick = () => {},alreadyAddedToCart,alreadyAlreadyAddedToCart,enabled,noticeText}:TitlePriceBadgeProps)\n{\n    const cssStateManager = useCssStateManager([\"title-price-badge\"]);\n    cssStateManager.useProperty(!enabled,\"disabled\");\n    cssStateManager.useProperty(!!editCartItem,\"is-editing\");\n\n    const hideReview = useSmartState(false);\n\n    const { reviewsCount,starRating } = consumeReviewsHeader(product.id);\n    const discountedPrice = prebuildData.getProductPageDiscountedPrice(product.id,price).price;\n\n    const { productPriceTitleBadge: { backgroundColor,textColor,borderColor,optionsReadyBorderColor,priceTextColor,reviewCountColor } } = prebuildData.getActiveTheme();\n\n    const teaseCaption = ((product.visibility===\"tease\") && (product.teaseCaption))?product.teaseCaption:\"\";\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"outline\"></div>\n                <div className=\"price\">\n                    <div className=\"price-display\">\n                        <PriceDisplay price={discountedPrice} size={40} />\n                    </div>\n                    <div className=\"price-update\">\n                        <div className=\"price-update-inner\">\n                            <PriceUpdate price={discountedPrice} />\n                        </div>\n                    </div>\n                </div>\n                <div className=\"title\">\n                    {product.caption}\n                </div>                \n                {(reviewsCount!==-1)?(<>\n                    <div className=\"rating\">\n                        <StarRating rating={starRating} scale={1.3} />\n                    </div>\n                    <div className=\"review_count\">\n                        {reviewsCount>0?<>\n                            {reviewsCount} review{(reviewsCount===1)?\"\":\"s\"}\n                        </>:\"No reviews yet\"}                    \n                    </div>\n                </>):<div className=\"awaiting-review-header\">---</div>}\n                {((reviewsCount>0) && (!hideReview.value) && (!editCartItem))?(<>\n                    <Separator enabled={enabled} />\n                    <ReviewHighlight product={product} onReadMoreReviewsClick={onReadMoreReviewsClick} enabled={enabled} hideReview={hideReview} />\n                </>):\"\"}\n                <div className=\"edit-status-wrapper\">\n                    <Separator enabled={enabled} />\n                    <div className=\"edit-status\">EDITING</div>                    \n                </div>\n                <Separator enabled={enabled} />\n                <div className=\"add-to-cart\">\n                    <AddToCart \n                        editCartItem={editCartItem}\n                        inBadge={true}\n                        added={alreadyAddedToCart}\n                        already={alreadyAlreadyAddedToCart}\n                        onClick={addToCartActionsRef.current.onClick}\n                        onViewInCart={addToCartActionsRef.current.onViewInCart}\n                        onSaveClick={addToCartActionsRef.current.onSaveClick}\n                        teaseCaption={teaseCaption}\n                    />\n                    <div className=\"blocker\"></div>\n                </div>\n                <Includes \n                    product={product} \n                    enabled={enabled} \n                />                \n            </div>\n            <Notice text={noticeText} />\n\n            <style jsx>{`\n            .awaiting-review-header {\n\n            }\n\n            .edit-status-wrapper {\n                display: none;\n            }\n\n            .is-editing .edit-status-wrapper {\n                display: block;\n            }\n\n            .edit-status {\n                background-color: #888;\n                display: inline-block;\n                color: #eee;\n                padding: 10rem 30rem;\n                font-weight: 600;\n                margin-top: -5rem;\n            }\n\n            .title-price-badge {\n                --border-radius: 15rem; \n                position: relative;\n                width: 350rem;\n                border-radius: var(--border-radius);\n                border: 1rem solid ${borderColor};\n                padding: 30rem;\n                color: ${textColor};\n                text-align: center;\n                --duration: 0.6s;\n                background-color: ${backgroundColor};\n                transition: background-color var(--duration);\n            }\n            .outline {\n                --padding: -1rem;\n                position: absolute;\n                left: var(--padding);\n                top: var(--padding);\n                bottom: var(--padding);\n                right: var(--padding);\n                border: 1rem solid ${optionsReadyBorderColor};\n                border-radius: var(--border-radius);\n                opacity: 1;\n                transition: opacity var(--duration);\n            }\n            .disabled .outline {\n                opacity: 0;\n            }\n\n            .title {\n                font-size: 20rem;\n                margin-bottom: 10rem;\n            }\n            .price {\n                margin-bottom: 10rem;\n                color: ${priceTextColor};\n            }\n            .rating {\n                margin-bottom: 10rem;\n            }\n            .review_count{\n                color: ${reviewCountColor};\n            }\n            .price-display,.price-update {\n                display: inline-block;\n            }\n            .price-update {\n                position: relative;\n            }\n            .price-update-inner {\n                position: absolute;\n                top: -7rem;\n                left: 10rem;\n            }\n            .add-to-cart {\n                position: relative;\n                padding-top: 12rem;\n                padding-bottom: 14rem;\n                opacity: 1;\n                transition: opacity var(--duration);\n            }\n            .disabled .add-to-cart {\n                opacity: 0.32;\n            }\n\n            .disabled {\n                /* background-color: transparent; */\n                background-color: #fff;\n            }\n\n            .add-to-cart .blocker {\n                position: absolute;\n                left: 0rem;\n                right: 0rem;\n                top: 0rem;\n                bottom: 0rem;\n                display: none;\n            }\n\n            .disabled .add-to-cart .blocker {\n                display: block;\n            }\n            `}</style>\n        </>\n    );\n}","import { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { QuantitySelect,QuantityValue } from \"./options/select-with-quantity\";\nimport { useSmartState } from \"../../../hooks/use_smart_state\";\nimport { EventPane } from \"../../core/event_pane\";\nimport { MutableRefObject, useContext, useEffect, useRef } from \"react\";\nimport { usePubSubRequest } from \"../../../hooks/use_pub_sub_request\";\nimport { misc } from \"../../../lib/misc\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { StarRatingProps } from \"../../common/star_rating\";\nimport { Notice } from \"./title-price-badge\";\nimport { CartItem } from \"../../../lib/services/cart/types\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\n\nexport type AddToCartProps = {\n    editCartItem?: CartItem;\n    onClick?: (quantity: number) => void;\n    onSaveClick?: () => void;\n    onViewInCart?: () => void;\n    added?: boolean;\n    already?: boolean;\n    containerRef?: MutableRefObject<HTMLDivElement>;\n    inBadge?: boolean;\n    descriptionHasTabs?: boolean;\n    sliderIsOpen?: boolean;\n    noticeText?: string;\n    teaseCaption: string;\n};\n\nexport default function AddToCart({editCartItem,onClick = () => {},onSaveClick = () => {},onViewInCart = () => {},added = false,already = false,containerRef,inBadge,descriptionHasTabs = false,sliderIsOpen = false,noticeText,teaseCaption}:AddToCartProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(teaseCaption!==\"\",\"has-tease\");\n    cssStateManager.useProperty(descriptionHasTabs,\"description-has-tabs\");\n    cssStateManager.useProperty(sliderIsOpen,\"slider-is-open\");\n    cssStateManager.useProperty(added,\"added\");\n    cssStateManager.useProperty(inBadge,\"in-badge\");\n    cssStateManager.useProperty(!!editCartItem,\"is-editing\");\n\n    const initialQuantityValue = {\n        custom: false,\n        value: 1,\n        valueDisplay: \"\"\n    };\n    const quantityValue = useSmartState<QuantityValue>(initialQuantityValue);\n\n    const clickHandler = () => {\n        onClick(quantityValue.value.value);\n    };\n\n    useEffect(() => {\n        if (added) {\n            quantityValue.value = {...initialQuantityValue};\n        }\n    },[added]);\n\n    const ref = containerRef || useRef<HTMLDivElement>();\n\n    usePubSubRequest(\"add_to_cart_offset_top\",async () => {\n        if (ref.current) {\n            return misc.getOffsetRelativeToParent(ref.current,\".page\").top;\n        }\n        else {\n            return null;\n        }\n    });\n\n    const { productPriceTitleBadge: { buttonColor,buttonTextColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()} ref={ref}>\n                <div className=\"teasing\">\n                    <div className=\"tease-button\">{teaseCaption}</div>                    \n                </div>\n                <div className=\"editing\">\n                    <div className=\"button\">\n                        Save\n                        <EventPane onClick={onSaveClick} hoverOnTouchDown />\n                    </div>\n                </div>\n                <div className=\"controls\">\n                    <div className=\"quantity-wrapper\">\n                        <QuantitySelect value={quantityValue} excludeZero={true} inBadge={inBadge} />\n                    </div>                \n                    <div className=\"button\">\n                        Add To Cart\n                        <EventPane onClick={clickHandler} hoverOnTouchDown />\n                    </div>\n                </div>\n                <div className=\"added-to-cart\">\n                    <div className=\"tick\">✓</div>\n                    <div className=\"in-cart-notice\">\n                        {already?\"Already Added\":\"Added To Cart\"}                        \n                    </div>\n                    <div className=\"mobile-spacer\"></div>\n                    <div className=\"view-in-cart-button\">\n                        View in Cart <div className=\"arrow\"><span>→</span></div>\n                        <EventPane onClick={onViewInCart} hoverOnTouchDown />\n                    </div>\n                </div>\n                <Notice text={noticeText} />\n            </div>\n            <style jsx>{`\n            .container {     \n                --border-color: #ddd;           \n                margin-top: 55rem;\n                border-top: 1rem solid var(--border-color);\n                border-bottom: 1rem solid var(--border-color);\n                padding: 20rem 0rem;\n            }\n            .teasing {\n                display: none;\n                justify-content: center;\n            }\n\n            .has-tease .teasing {\n                display: flex;                \n            }\n\n            .tease-button {\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                font-size: 14rem;\n                background-color: #1d8dff;\n                /* background-color: #1776d5; */\n                color: ${buttonTextColor};\n                padding: 11rem 32rem;\n                border-radius: 25rem;\n                /* margin-left: 23rem; */\n                font-weight: 600;\n                position: relative;\n                top: 0rem;            \n                position: relative;\n                opacity: 0.5;\n                transition: opacity 0.3s;\n                white-space: nowrap;\n            }\n\n            .in-badge {\n                border-top: none;\n                border-bottom: none;\n                margin-top: 0rem;\n                padding: 0rem;\n            }\n            .controls {\n                display: flex;\n            }\n            .in-badge .controls {\n                justify-content: center;\n            }\n            .added .controls {\n                display: none;\n            }\n            .added-to-cart {\n                display: none;\n                color: #999999;\n                font-size: 20rem;\n                font-weight: 600;   \n                position: relative;\n                height: 45rem;\n                align-items: center;\n            }\n            .in-badge .added-to-cart {\n                font-size: 16rem;\n                justify-content: center;\n            }\n            .added .added-to-cart {\n                display: flex;\n            }\n\n            .added-to-cart .tick {\n                color: #00a300;\n                font-size: 28rem;\n                font-weight: 600;\n            }\n\n            .quantity-wrapper {\n                flex: 0 0 80rem;\n            }\n            .button {\n                position: relative;\n                height: 45rem;\n                background-color: ${buttonColor};\n                /* background-color: #1776d5; */\n                color: ${buttonTextColor};\n                border-radius: 5rem;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n                padding: 0rem 25rem;\n                margin-left: 15rem;\n                cursor: pointer;\n                opacity: 1;\n                transition: opacity 0.3s;                \n            }\n            .button.hover {\n                opacity: 0.9;\n            }\n            .in-cart-notice {\n                display: inline-block;\n                width: 198rem;\n                padding-left: 10rem;\n            }\n            .in-badge .in-cart-notice {\n                width: auto;\n                margin-right: 14rem;\n            }\n\n            .in-badge .added-to-cart .tick {\n                display: block;\n                font-size: 22rem;\n                margin-right: -4rem;\n            }\n\n            .view-in-cart-button {\n                display: flex;\n                align-items: center;\n                font-size: 14rem;\n                background-color: ${buttonColor};\n                /* background-color: #1776d5; */\n                color: ${buttonTextColor};\n                padding: 11rem 22rem;\n                padding-right: 32rem;\n                border-radius: 25rem;\n                /* margin-left: 23rem; */\n                font-weight: 600;\n                position: relative;\n                top: 0rem;            \n                position: relative;\n                opacity: 1;\n                transition: opacity 0.3s;\n                white-space: nowrap;\n            }\n            .view-in-cart-button.hover {\n                opacity: 0.9;\n            }\n\n            .editing {\n                padding: 0rem 60rem;\n                display: none;\n            }\n\n            .editing .button {\n                margin-left: 0rem;\n            }            \n\n            .arrow {\n                position: absolute;\n                right: 10rem;\n                top: calc(50% - 13rem);\n                font-size: 17rem;\n                overflow: hidden;\n            }\n            .arrow span {\n                position: relative;\n                left: -5rem;\n            }\n            .mobile-spacer {\n                display: none;\n            }\n\n            .is-editing .editing {\n                display: block;\n            }\n\n            .is-editing .controls,.is-editing .added-to-cart {\n                display: none;\n            }\n\n            .has-tease .controls,.has-tease .added-to-cart,.has-tease .editing {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .controls {\n                    justify-content: space-between;\n                    padding: 0rem 5rem;\n                }        \n\n                .added-to-cart {\n                    font-size: 16rem;\n                    padding: 0rem 5rem;\n                }\n\n                .in-cart-notice {\n                    width: auto;\n                }\n\n                .mobile-spacer {\n                    display: block;\n                    flex: 1 1;\n                    min-width: 15rem;\n                }\n\n                .container {\n                    margin-top: 5rem;\n                }\n\n                .description-has-tabs.container {\n                    padding-bottom: 50rem;\n                }\n\n                .slider-is-open.container {\n                    border-top: none;\n                }\n            }            \n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect, useRef, useState } from \"react\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { EventPane } from \"../../../core/event_pane\";\nimport OptionTitle from \"./commons/title\";\nimport { misc } from \"../../../../lib/misc\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueButton } from \"../../../../lib/services/cart/types\";\nimport { OptionsOptionButtonsQuantity } from \"../../../../lib/shared/options/types\";\nimport { QuantitySelect, QuantityValue } from \"./select-with-quantity\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\n\nexport type ButtonEntry = {\n    caption: string;\n    id: string;\n    custom?: boolean;\n    customRange?: ButtonCustomRange; \n    customDisplay?: string; \n    customPlaceholder?: string;\n    slideshowMatch?: string;\n};\n\nexport type ButtonsOptionProps = {\n    title: string;\n    subTitle?: string;\n    buttons: ButtonEntry[];\n    onSlideShowMatch?: (value: string,bypassSlideshowAnimation?: boolean) => void;\n    minWidth?: number;\n    onValue?: (value: OptionValueButton,auto?: boolean) => void;\n    loadFromSavedValue?: OptionValueButton;\n    quantity?: OptionsOptionButtonsQuantity;\n};\n\nexport type ButtonCustomRange = {\n    min: number;\n    max: number;\n    decimalUnit: number;\n};\n\ntype ButtonProps = {\n    id: string;\n    text: string;\n    subText?: string;\n    minWidth?: number;\n    selected: boolean;\n    unselected?: boolean;\n    onSelected?: (auto?: boolean) => void;\n    custom?: boolean;\n    customRange?: ButtonCustomRange;\n    customDisplay?: string;\n    loadFromSavedValue?: OptionValueButton;\n    canToggle?: boolean;\n    customPlaceholder?: string;\n    onCustomValue?: (value: number,auto?: boolean) => void;\n};\n\nexport function Button({\n        id,\n        text,\n        minWidth,\n        selected,\n        unselected,\n        onSelected = () => {},\n        custom = false,\n        loadFromSavedValue,\n        canToggle = false,\n        customRange = {min: 0,max: 50,decimalUnit: 5},\n        subText = \"\",\n        customDisplay = \"({value}) => value;\",\n        customPlaceholder,\n        onCustomValue = () => {}\n    }: ButtonProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const customSubText = `${customRange.min} - ${customRange.max}`;\n    const customSubCaptionExtra = (customRange.decimalUnit>0)?`±0.${customRange.decimalUnit}`:\"\";\n    const hasDecimal = (customRange.decimalUnit>0);\n    const padding = 1;\n\n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(selected,\"selected\");\n    cssStateManager.useProperty(unselected,\"unselected\");\n    cssStateManager.useProperty(custom,\"custom\");\n    cssStateManager.useProperty(!!customSubText,\"with-custom-subtext\");\n    cssStateManager.useProperty(hasDecimal,\"has-decimal\");\n    cssStateManager.useProperty(!!subText,\"with-sub-text\");\n    const editing = cssStateManager.useState(true,\"editing\");\n    const showCustomValue = useSmartState(false);\n    const disableTransition = cssStateManager.useState(true,\"disable-transition\");\n    const customValue = useSmartState(\"\");\n\n    const customIntLength = Math.floor(customRange.max).toString().length;\n    const customPlaceholderText = customPlaceholder || (hasDecimal?\"0\".repeat(customIntLength)+\".0\":\"\");\n\n    const inputRefDesktop = useRef<HTMLInputElement>();\n    const inputRefMobile = useRef<HTMLInputElement>();\n\n    const { isSmallDesktopScreen: isMobileActive,smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n    const inputRefFn = () => isMobileActive.current?inputRefMobile:inputRefDesktop;\n\n    const customDisplayFnRef = useRef<any>();    \n\n    const bypassSelectionRef = useRef(false);\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            if (loadFromSavedValue.id===id) {\n                if ((custom) && (loadFromSavedValue.hasOwnProperty(\"value\"))) {\n                    bypassSelectionRef.current = true;\n                    onSelected(true);\n                    updateValue(loadFromSavedValue.value.toString(),true);\n                }\n                else {\n                    onSelected(true);\n                }                \n            }\n        }\n    },[loadFromSavedValue]);    \n\n    useEffect(() => {\n        if (selected) {\n            if (custom) {\n                if (bypassSelectionRef.current) {\n                    bypassSelectionRef.current = false;\n                    return;\n                }\n                editing.value = true;\n                const inputRef = inputRefFn();\n                setTimeout(() => {\n                    inputRef.current?.focus();    \n                    const val = inputRef.current.value;\n                    inputRef.current.value = \"\";\n                    inputRef.current.value = val;\n                },50);\n                // inputRef.current?.focus();\n            }                                    \n        }\n        else {\n            if (custom) {\n                showCustomValue.value = false;\n            }\n        }\n    },[selected]);\n\n    const inputValue = useSmartState(\"\");\n    const inputLeftShift = useSmartState(0);\n\n    const inputOffsets = {\n        beforeDot: 0,\n        // afterDot: -4.664,\n        afterDot: -4.4,\n        afterAll: -13.297\n    };\n\n    const updateValue = (newValue: string,auto?: boolean) => {\n        disableTransition.value = true;\n        customValue.value = newValue;\n        inputValue.value = newValue;\n        editing.value = false;\n        showCustomValue.value = true;\n        onCustomValue(parseFloat(newValue),auto);\n    };\n\n    const inputSet = () => {\n        if ((!custom) || (!editing.value)) return;\n        let { value } = inputValue;\n        if (value.endsWith(\".\")) value+= \"0\";\n        let value10 = Math.round((parseFloat(value) || 0)*10);\n        const min10 = customRange.min*10;\n        const max10 = customRange.max*10;\n        value10 = Math.max(min10,Math.min(max10,value10));\n        let decimal = value10%10;\n        const int = Math.round((value10-decimal)/10);\n        if (hasDecimal) {\n            decimal = Math.floor(decimal/customRange.decimalUnit)*customRange.decimalUnit;\n        }\n        const newValue = (decimal>0)?`${int}.${decimal}`:int.toString();\n        updateValue(newValue);\n    };\n\n    const inputChangeHandler = (value: string) => {        \n        let dotFound = false;\n        value = value.split(\"\").filter((ch) => {\n            if (ch===\".\") {\n                if (!hasDecimal) return false;\n                if (dotFound) return false;\n                dotFound = true;\n                return true;\n            }\n            else {\n                return /[0-9]/.test(ch);\n            }\n        }).join(\"\");\n        const maxLength = customIntLength+(hasDecimal?1:0);\n        const maxLengthWithoutDecimal = customIntLength;\n        const processDotLess = (value: string) => {\n            value = value.substring(0,maxLength);\n            if (value.length<=maxLengthWithoutDecimal) {\n                inputValue.value = value;\n            }\n            else {\n                value = value.substring(0,maxLength-1)+\".\"+value.substring(maxLength-1);\n                inputValue.value = value;\n            }\n        };\n        if (dotFound) {\n            if (value.charAt(0)===\".\") value = \"0\"+value;\n            let [before,after] = value.split(\".\");\n            if (before.length>maxLengthWithoutDecimal) {\n                processDotLess(before);\n            }\n            else {\n                after = after.substring(0,1);\n                value = before+\".\"+after;\n                inputValue.value = value;\n            }\n        }\n        else {\n            processDotLess(value);\n        }\n    };\n\n    useEffect(() => {\n        if (disableTransition.value) {\n            setTimeout(() => {\n                disableTransition.value = false;\n            },300);\n        }\n    },[disableTransition.value]);\n\n    const clickHandler = () => {\n        if (canToggle) return onSelected();\n        if (selected) {\n            if ((custom) && (!editing.value)) {\n                disableTransition.value = true;\n                editing.value = true;\n                const inputRef = inputRefFn();\n                if (inputRef.current) {\n                    inputRef.current.focus();\n                    const val = inputRef.current.value;\n                    inputRef.current.value = \"\";\n                    inputRef.current.value = val;\n                }\n            }            \n        }\n        else {\n            onSelected();\n        }     \n    };\n    const handleInputKeyUp = (code: string) => {\n        if ((code===\"Enter\") || (code===\"Escape\")) {\n            inputSet();\n        }        \n    };\n\n    const customValueDisplay = (value: string) => {\n        const fn = (customDisplayFnRef.current = customDisplayFnRef.current || prebuildData.evalInContext(customDisplay));        \n        return fn({value});\n    };\n    \n    const { productOptions: {\n        buttonSelectedBackgroundColor,\n        buttonBorderColor,\n        buttonSelectedTextColor,\n        buttonBackgroundColor,\n        buttonUnselectedTextColor,\n        sliderNoColor,\n        lightTextColor,\n        buttonSelectedBorderColor\n    } } = prebuildData.getActiveTheme();\n\n    return <>\n        <div className={cssStateManager.getClassNames()} style={{...(((typeof minWidth===\"number\") && (minWidth>0))?{minWidth: `${minWidth}rem`}:{})}}>\n            <div className=\"decimal-placeholder centered\" style={{display: (inputValue.value!==\"\")?\"none\":\"block\"}}>{customPlaceholderText}</div>            \n            <div className=\"center-text\">\n                {(customValue.value && selected)?((showCustomValue.value)?customValueDisplay(customValue.value):<div dangerouslySetInnerHTML={{ __html: \"&nbsp;\" }} />):text}\n                <div className=\"sub-text\">{subText}</div>\n            </div>\n            <div className=\"outline\"></div>\n            <div className=\"custom-title\">\n                <div className=\"cover\"></div>\n                <div>{text}</div>\n            </div>\n            <div className=\"custom-sub-title\">\n                <div>{customSubText}{customSubCaptionExtra?<span>&nbsp;({customSubCaptionExtra})</span>:\"\"}</div>\n            </div>\n            <input \n                onKeyUp={(e) => handleInputKeyUp(e.code)} \n                onBlur={inputSet} \n                onChange={(e) => inputChangeHandler(e.target.value)} \n                value={inputValue.value} \n                ref={inputRefDesktop} \n                className=\"decimal-input decimal-input-desktop\" \n                type=\"text\"\n            />\n            <input \n                onKeyUp={(e) => handleInputKeyUp(e.code)} \n                onBlur={inputSet} \n                onChange={(e) => inputChangeHandler(e.target.value)} \n                value={inputValue.value} \n                ref={inputRefMobile}\n                className=\"decimal-input decimal-input-mobile\" \n                type=\"number\"\n            />\n            <div className=\"event-pane\">\n                <EventPane onClick={clickHandler} />\n            </div>\n        </div>\n        <style jsx>{`            \n        .container {\n            --selected-color: ${buttonSelectedBackgroundColor};\n            position: relative;\n            display: inline-block;\n            padding: 12rem 0rem;\n            border: 1rem solid ${buttonBorderColor};\n            margin-right: 15rem;\n            margin-bottom: 16rem;\n            min-width: 95rem;\n            text-align: center;\n            border-radius: 5rem;\n            color: ${buttonSelectedTextColor};\n            font-weight: 600;\n            background-color: ${buttonBackgroundColor};\n            transition: background-color 0.3s;\n        }\n        .selected.custom.editing .event-pane {\n            display: none;\n        }\n        .decimal-input {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%,-50%);\n            width: 100%;\n            background-color: transparent;\n            text-align: center;\n            border: none;\n            outline: none;\n            font-size: 16rem;\n            font-weight: 600;\n            color: ${buttonSelectedTextColor};\n            padding-top: 1rem;\n            opacity: 0;\n            /* transition: opacity 0.3s; */\n            font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n        }\n        .decimal-input-desktop {\n            display: block;\n        }\n        .decimal-input-mobile {\n            display: none;\n        }\n        .disable-transition .decimal-input {\n            transition-duration: 0s;\n        }\n        .selected.custom.editing .decimal-input {\n            opacity: 1;\n        }\n        .decimal-placeholder {\n            color: ${buttonBorderColor};\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        .selected.custom.has-decimal.editing .decimal-placeholder {\n            opacity: 1;\n        }\n        .show-on-custom-selected {\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        .selected.custom .show-on-custom-selected {\n            opacity: 1;\n        }\n        .centered {\n            position: absolute;\n            left: 50%;\n            top: 50%;\n            transform: translate(-50%,-50%);\n        }\n        .center-text {\n            opacity: 1;\n            transition: opacity 0.3s;\n            padding: 0rem 15rem;\n        }\n        \n        .unselected .center-text {\n            color: ${buttonUnselectedTextColor};\n        }\n        .disable-transition .center-text {\n            transition-duration: 0s;\n        }\n        .selected.custom.editing .center-text {\n            opacity: 0;\n        }\n        .custom-title,.custom-sub-title {\n            position: absolute;\n            font-size: 13rem;\n            font-weight: 400;\n            left: 50%;\n            transform: translateX(-50%);\n            opacity: 0;\n            transition: opacity 0.3s;\n            padding: 0rem 4rem;\n            white-space: nowrap;\n        }\n        .custom-sub-title span {\n            color: ${sliderNoColor};\n        }\n        .custom-title {\n            top: -10rem;\n        }\n        .custom-title .cover {\n            position: absolute;            \n            left: 0rem;\n            right: 0rem;\n            height: 9rem;\n            background-color: var(--selected-color);\n            z-index: -1;\n        }\n        .custom-title .cover {\n            bottom: 0rem;\n        }\n        .custom-sub-title {\n            bottom: -18rem;\n            font-size: 11rem;\n        }\n        .sub-text {\n            color: ${lightTextColor};\n            font-size: 11rem;\n            font-weight: 400;\n            padding-top: 2rem;\n            display: none;\n        }\n        .with-sub-text .sub-text {\n            display: block;\n        }\n        .selected.custom .custom-title,.selected.editing.custom.with-custom-subtext .custom-sub-title {\n            opacity: 1;\n        }\n        .container.selected {\n            background-color: var(--selected-color);\n        }\n        .container.hover {\n            border: 1rem solid #888;\n        }\n        .outline {\n            position: absolute;\n            left: -${padding}rem;\n            top: -${padding}rem;\n            bottom: -${padding}rem;\n            right: -${padding}rem;\n            border: 2rem solid ${buttonSelectedBorderColor};\n            border-radius: 5rem;\n            opacity: 0;\n            transition: opacity 0.3s;\n        }\n        .selected .outline {\n            opacity: 1;\n        }\n\n        @media screen and (max-width: ${mobileCutoff}px) {\n            .container {\n                --selected-color: ${buttonBackgroundColor};\n                background-color: var(--body-background-color);\n            }\n            .decimal-input-desktop {\n                display: none;\n            }\n            .decimal-input-mobile {\n                display: block;\n            }\n        }\n        `}</style>\n    </>;\n}\n\n\nexport default function ButtonsOption({buttons,minWidth,onSlideShowMatch = () => {},title,subTitle = \"\",onValue = () => {},loadFromSavedValue,quantity}:ButtonsOptionProps)\n{\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const { scalePixelToRem } = useContext(LayoutStateContext);\n\n    const selectedIndex = useSmartState(-1);\n    const initialQuantityValue = {custom: false,value: 1,valueDisplay: \"\"};\n    const quantityValueToLoadRef = useRef<QuantityValue>();\n    const quantityOn = quantity?useSmartState(false,{onSet: (value) => {\n        if (value) {\n            quantityValue.value = quantityValueToLoadRef.current || {...initialQuantityValue};\n            quantityValueToLoadRef.current = undefined;\n        }\n        else {\n            if (selectedIndex.value!==-1) {\n                onValue({\n                    type: \"buttons\",\n                    id: buttons[selectedIndex.value].id\n                });\n            }    \n        }\n    }}):undefined;    \n    const quantityValue = quantity?useSmartState<QuantityValue>(initialQuantityValue,{onSet: (value) => {\n        if (selectedIndex.value!==-1) {\n            onValue({\n                type: \"buttons\",\n                id: buttons[selectedIndex.value].id,\n                quantity: value.value\n            });\n        }\n    }}):undefined;\n    const quantityWrapperRef = quantity?useRef<HTMLDivElement>():undefined;\n    if (quantityOn) {\n        cssStateManager.useProperty(quantityOn.value,\"quantity-on\");        \n    }\n\n    const quantityWrapperHeight = Math.ceil(scalePixelToRem(quantityWrapperRef?.current?.offsetHeight)) || 0;\n    // if (quantityOn) {\n    //     console.log(\"loadFromSavedValue\",loadFromSavedValue);\n    // }\n\n    if (quantity) {\n        useEffect(() => {\n            if ((loadFromSavedValue) && ((typeof loadFromSavedValue.quantity===\"number\") && (loadFromSavedValue.quantity>1))) {\n                quantityValueToLoadRef.current = {\n                    custom: (loadFromSavedValue.quantity>10),\n                    value: loadFromSavedValue.quantity,\n                    valueDisplay: (loadFromSavedValue.quantity>10)?loadFromSavedValue.quantity.toString():\"\"\n                };\n                quantityOn.value = true;\n            }\n        },[loadFromSavedValue]);        \n    }\n    \n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <OptionTitle caption={title} subCaption={subTitle} quantity={quantity} quantityOn={quantityOn} />\n                <div className=\"buttons\">\n                    {buttons.map(({caption,custom,customRange,customDisplay,customPlaceholder,id,slideshowMatch},index) => \n                        <Button \n                            key={index} \n                            id={id}\n                            text={caption} \n                            custom={custom}\n                            minWidth={minWidth}\n                            selected={selectedIndex.value===index} \n                            unselected={(selectedIndex.value!==-1) && (selectedIndex.value!==index)}\n                            onSelected={(auto?: boolean) => {\n                                selectedIndex.value = index;\n                                if (slideshowMatch) {\n                                    onSlideShowMatch(slideshowMatch,auto);\n                                }\n                                if (!custom) {\n                                    onValue({\n                                        type: \"buttons\",\n                                        id,\n                                        ...((quantity && quantityOn.value)?{quantity: quantityValue.value.value}:{})\n                                    },auto);\n                                }\n                            }}\n                            onCustomValue={(value: number,auto?: boolean) => {\n                                onValue({\n                                    type: \"buttons\",\n                                    id,\n                                    value\n                                },auto);\n                            }}\n                            customRange={customRange}\n                            customDisplay={customDisplay}\n                            customPlaceholder={customPlaceholder}\n                            loadFromSavedValue={loadFromSavedValue}\n                        />\n                    )}\n                </div>\n                {quantity?(\n                    <div className=\"quantity\" style={{\n                        height: quantityOn.value?`${quantityWrapperHeight}rem`:\"0rem\"\n                    }}>\n                        <div ref={quantityWrapperRef} className=\"quantity-wrapper\">\n                            <QuantitySelect \n                                excludeZero\n                                value={quantityValue}\n                            />\n                        </div>\n                    </div>\n                ):\"\"}                \n            </div>\n            <style jsx>{`\n            .container {\n            }\n            .buttons {}\n            .quantity {\n                --duration: 0.3s;                \n                overflow-y: hidden;\n                transition: height var(--duration);\n            }\n            .quantity-wrapper {\n                width: 80rem;\n                padding-top: 10rem;\n                opacity: 0;\n                transition: opacity 0.8s;\n            }\n            .quantity-on .quantity-wrapper {\n                opacity: 1;\n            }\n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { OptionValueButton, OptionValueCheckboxGroup } from \"../../../../lib/services/cart/types\";\nimport { Button } from \"./buttons\";\nimport OptionTitle from \"./commons/title\";\n\nexport type CheckboxGroupOptionProps = {\n    title: string;\n    subTitle?: string;\n    entries: CheckboxGroupEntry[];\n    onValue?: (value: OptionValueCheckboxGroup | null) => void;\n    loadFromSavedValue?: OptionValueCheckboxGroup;\n};\n\nexport type CheckboxGroupEntry = {\n    caption: string;\n    value: string;\n    subCaption?: string;    \n};\n\nexport default function CheckboxGroupOption({\n        title,\n        entries,\n        subTitle = \"\",\n        onValue = () => {},\n        loadFromSavedValue\n    }:CheckboxGroupOptionProps)\n{\n    const cssStateManager = useCssStateManager([\"container\"]);\n\n    const selected = useSmartState(Array(entries.length).fill(false));\n    const toggleSelected = (index: number) => {\n        const newValue = [...selected.value];\n        newValue[index] = !newValue[index];\n        selected.value = newValue;\n        const ids = entries.map(({value},index) => value).filter((_,index) => newValue[index]);\n        onValue((ids.length>0)?{\n            type: \"checkbox-group\",\n            ids\n        }:null);\n    };\n\n    const loadFromSavedValueRef = useRef<{[id: string]: OptionValueButton}>({});    \n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>                \n                <OptionTitle caption={title} subCaption={subTitle} />\n                <div className=\"buttons\">\n                    {entries.map(({caption,subCaption,value},index) => \n                        <Button \n                            id={value}\n                            key={index} \n                            text={caption} \n                            subText={subCaption}\n                            selected={selected.value[index]}\n                            onSelected={() => toggleSelected(index)}\n                            canToggle={true}                            \n                            loadFromSavedValue={(loadFromSavedValueRef.current[value] = loadFromSavedValueRef.current[value] || (loadFromSavedValue?((loadFromSavedValue.ids.indexOf(value)!==-1)?{type: \"buttons\",id: value}:undefined):undefined))}\n                        />\n                    )}\n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n            }\n            .buttons {}\n            `}</style>\n        </>\n    );\n}","import { useEffect, useRef } from \"react\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueButton } from \"../../../../lib/services/cart/types\";\nimport { EventPane } from \"../../../core/event_pane\";\nimport OptionTitle from \"./commons/title\";\n\nexport type ColorEntry = {\n    color: string;\n    id: string;\n    caption: string;\n    slideshowMatch?: string;\n};\n\nexport type ColorPickerOptionsProps = {\n    title: string;\n    subTitle?: string;\n    colors: ColorEntry[];\n    onSlideShowMatch?: (value: string,bypassSlideshowAnimation?: boolean) => void;\n    size?: number;\n    initialSelectedItemIndex: number;\n    onValue?: (value: OptionValueButton,auto?: boolean) => void;\n    loadFromSavedValue?: OptionValueButton;\n    price?: number;\n};\n\ntype ColorProps = {\n    id: string;\n    color: string;\n    selected: boolean;\n    onSelect?: (auto?: boolean) => void;\n    onStartHover?: () => void;\n    onEndHover?: () => void;\n    size?: number;\n    loadFromSavedValue?: OptionValueButton;\n};\n\nfunction Color({\n        id,\n        color,\n        selected,\n        onSelect = () => {},\n        onStartHover = () => {},\n        onEndHover = () => {},\n        size = 35,\n        loadFromSavedValue\n    }:ColorProps) {\n    const padding = 5;    \n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(selected,\"show\");\n    cssStateManager.useProperty(color===\"none\",\"slashed\");\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            if (loadFromSavedValue.id===id) {\n                onSelect(true);\n            }\n        }\n    },[loadFromSavedValue]);    \n\n    return (<>\n        <div className={cssStateManager.getClassNames()} style={{backgroundColor: (color===\"none\")?\"#fff\":color}}>\n            <div className=\"outline\"></div>\n            <div className=\"slash\"></div>\n            <EventPane onClick={onSelect} onStartHover={onStartHover} onEndHover={onEndHover} overlapHori={7} />\n        </div>\n        <style jsx>{`\n            .container {\n                display: inline-block;\n                --size: ${size}rem;\n                width: var(--size);\n                height: var(--size);\n                border-radius: var(--size);\n                box-shadow: inset 0rem 3rem 12rem -5rem rgb(0 0 0 / 51%);\n                margin-right: 14rem;\n                margin-bottom: 6rem;\n                position: relative;\n            }\n            .outline {\n                position: absolute;\n                --padding: -${padding}rem;\n                left: var(--padding);\n                top: var(--padding);\n                right: var(--padding);\n                bottom: var(--padding);\n                border-radius: ${size}rem;                \n                opacity: 0;\n                transition: opacity 0.3s;\n            }\n            .slash {\n                --height: 5rem;\n                position: absolute;\n                left: 0rem;\n                right: 0rem;\n                top: calc(50% - (var(--height) / 2));\n                height: var(--height);\n                background-color: rgba(0,0,0,0.06);\n                border-radius: 3rem;\n                transform: rotate(-45deg);\n                display: none;\n            }\n            .slashed .slash {\n                display: block;\n            }\n            .hover .outline {\n                opacity: 1;\n                border: 1rem solid #0000002a;\n            } \n            .show .outline {\n                opacity: 1;\n                border: 2rem solid #9ba2fb;\n            }\n        `}</style>\n    </>);\n}\n\nexport default function ColorPickerOption({\n        colors,\n        title,\n        subTitle = \"\",\n        onSlideShowMatch = () => {},\n        size,\n        initialSelectedItemIndex,\n        onValue = () => {},\n        loadFromSavedValue,\n        price\n    }:ColorPickerOptionsProps)\n{\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const selectedIndex = useSmartState(initialSelectedItemIndex);\n\n    const permanentFooterText = (selectedIndex.value!==-1)?colors[selectedIndex.value].caption:\"\";\n    const hoverFooterText = useSmartState(\"\");\n\n    const footerText = hoverFooterText.value || permanentFooterText;\n\n    const { productOptions: { colorPickerChoiceTextColor,colorPickerHoverTextColor } } = prebuildData.getActiveTheme();    \n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <OptionTitle caption={title} subCaption={subTitle} price={price} priceEnabled={colors[selectedIndex.value]?.id!==\"none\"} />\n                <div className=\"colors\">\n                    {colors.map(({color,id},index) => <Color \n                            key={index} \n                            id={id}\n                            color={color} \n                            size={size} \n                            selected={selectedIndex.value===index} \n                            onSelect={(auto = false) => {\n                                selectedIndex.value = index;\n                                if (colors[index].slideshowMatch) {\n                                    onSlideShowMatch(colors[index].slideshowMatch,!!auto);\n                                }\n                                onValue({\n                                    type: \"buttons\",\n                                    id\n                                },auto);                        \n                            }}  \n                            onStartHover={() => {\n                                hoverFooterText.value = colors[index].caption;\n                            }}\n                            onEndHover={() => {\n                                hoverFooterText.value = \"\";\n                            }}\n                            loadFromSavedValue={loadFromSavedValue}\n                        />)}\n                </div>\n                <div className={`footer ${((hoverFooterText.value!==\"\") && (hoverFooterText.value!==permanentFooterText))?\"hovering\":\"\"}`}>{footerText}</div>\n            </div>\n            <style jsx>{`\n            .container {\n                padding-bottom: 0rem;\n            }\n            .footer {\n                height: 24rem;\n                font-size: 15rem;\n                margin-top: 5rem;\n                color: ${colorPickerChoiceTextColor};            \n            }\n            .hovering {\n                color: ${colorPickerHoverTextColor};\n            }\n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueProductSelect } from \"../../../../lib/services/cart/types\";\nimport OptionTitle from \"./commons/title\";\n\nexport type MultiSelectOptionProps = {\n    title: string;\n    subTitle?: string;\n    input: MultiSelectInput;\n    onValue?: (value: OptionValueProductSelect,auto?: boolean) => void;\n    loadFromSavedValue?: OptionValueProductSelect;\n};\n\nexport type MultiSelectEntry = {\n    caption: string;\n    value: string;\n};\n\nexport type MultiSelectInput = {\n    min: number;\n    max: number;\n    showAll: boolean;\n    captions: string[];\n    entries: MultiSelectEntry[];\n};\n\ntype SingleSelectProps = {\n    value: string;\n    onChange?: (value: string) => void;\n    caption: string;\n    entries: MultiSelectEntry[];\n    required: boolean;\n    show: boolean;\n    fadeDuration: number;\n};\n\nconst unselectedValue = \"--unselected--\";\nconst removeValue = \"--remove--\";\n\nfunction SingleSelect({\n        caption,\n        entries,\n        required,\n        value,\n        onChange = () => {},\n        show,\n        fadeDuration,\n    }: SingleSelectProps) \n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n    \n    const cssStateManager = useCssStateManager([\"container\"]);\n    const unselected = value===unselectedValue;\n    cssStateManager.useProperty(unselected,\"unselected\");\n    cssStateManager.useProperty(show,\"show\");\n\n    const { productOptions: { buttonUnselectedTextColor,buttonSelectedTextColor,buttonBackgroundColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <select className=\"select\" onChange={(e) => onChange(e.target.value)} value={value}>\n                    <option className=\"unselected-option\" value={unselectedValue}>{caption}{required?\"\":\" (optional)\"}</option>\n                    {(!required && !unselected)?<option className=\"remove-option\" value={removeValue}>-- Remove ---</option>:\"\"}                    \n                    {entries.map(({caption,value},index) => <option key={index} value={value}>{caption}</option>)}\n                </select>\n            </div>\n            <style jsx>{`\n            .container {\n                margin-bottom: 20rem;\n                opacity: 0;\n                background-color: ${buttonBackgroundColor};\n                transition: opacity ${fadeDuration}s;\n            }\n            .container.show {\n                opacity: 1;\n            }\n            .select {\n                cursor: pointer;\n                height: 45rem;\n                outline: none;\n                border: 1rem solid rgba(190, 190, 190);\n                border-radius: 5rem;\n                width: 100%;\n                font-size: 16rem;\n                font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                padding: 0rem 9rem;\n                color: ${buttonSelectedTextColor};\n                background-color: transparent;\n                font-weight: 600;                            \n            }\n            .unselected .select {\n                color: ${buttonUnselectedTextColor};\n            }\n            .select option {\n                color: ${buttonSelectedTextColor};\n            }\n            .unselected-option {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .select {\n                    background-color: var(--body-background-color);\n                }\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport default function MultiSelectOption({\n        title,\n        input,\n        subTitle = \"\",\n        onValue = () => {},\n        loadFromSavedValue\n    }:MultiSelectOptionProps)\n{    \n    const cssStateManager = useCssStateManager([\"container\"]);\n    const values = useSmartState<string[]>([]);\n    const selectHeight = 45;\n    const spacing = 20;\n    const fadeDuration = 0.3;\n\n    const selectsCount = input.showAll?input.max:Math.max(input.min,Math.min(input.max,values.value.length+1));\n    const selectsHeight = selectHeight+(selectHeight+spacing)*(selectsCount-1);\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            updateValue(loadFromSavedValue.ids,true);\n        }\n    },[loadFromSavedValue]);\n\n    const updateValue = (ids: string[],auto?: boolean) => {\n        const newValue = [...ids];\n        values.value = newValue;\n        onValue({\n            type: \"product-select\",\n            ids: newValue\n        },auto);\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <OptionTitle caption={title} subCaption={subTitle} />\n                <div className=\"selects\" style={{height: `${selectsHeight}rem`}}>\n                    {Array(input.max).fill(0).map((_,index) => {\n                        return <SingleSelect \n                            key={index} \n                            caption={input.captions[index]} \n                            entries={input.entries} \n                            required={index<input.min}\n                            value={(index<values.value.length)?values.value[index]:unselectedValue}\n                            onChange={(value) => {\n                                if (value===removeValue) {\n                                    values.value.splice(index,1);\n                                }\n                                else {\n                                    if (index<values.value.length) {\n                                        values.value[index] = value;\n                                    }\n                                    else {\n                                        values.value.push(value);\n                                    }                                \n                                }\n                                updateValue(values.value);\n                            }}\n                            show={index<selectsCount}\n                            fadeDuration={fadeDuration}\n                        />;\n                    })}\n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n                padding-bottom: 16rem;\n            }\n            .select {\n                cursor: pointer;\n                height: ${selectHeight}rem;\n                outline: none;\n                border: 1rem solid rgba(190, 190, 190);\n                border-radius: 5rem;\n                width: 100%;\n                font-size: 16rem;\n                font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                padding: 0rem 9rem;\n                color: #6c6c6c;\n                background-color: transparent;\n                font-weight: 600;            \n                margin-bottom: ${spacing}rem;\n            }\n            .selects {\n                overflow-y: hidden;\n                transition: height ${fadeDuration}s;\n            }\n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport { OptionValueSelect, OptionValueVariantSelect } from \"../../../../lib/services/cart/types\";\nimport OptionTitle from \"./commons/title\";\n\nexport type SelectEntry = {\n    caption: string;    \n    value: string;\n};\n\nexport type SelectComponentProps = {\n    title: string;\n    subTitle?: string;\n    unselectedCaption?: string;\n    removable?: boolean;\n    entries: SelectEntry[];\n    description?: string;\n    onValue?: (value: OptionValueSelect | OptionValueVariantSelect ) => void;\n    valueType?: \"select\" | \"variant-select\";\n    loadFromSavedValue?: OptionValueSelect | OptionValueVariantSelect;\n    price?: number;\n};\n\nexport default function SelectComponent({\n        title,\n        subTitle = \"\",\n        entries,\n        unselectedCaption = \"\",\n        removable = false,\n        description = \"\",\n        valueType = \"select\",\n        onValue = () => {},\n        loadFromSavedValue,\n        price\n    }:SelectComponentProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const unselectedValue = \"--unselected--\";    \n    const removeValue = \"--remove--\";\n    const selectedValue = useSmartState(((unselectedCaption!==\"\")?unselectedValue:null) || entries?.[0].value || \"\");\n\n    const cssStateManager = useCssStateManager([\"container\"]);    \n    const unselected = (unselectedCaption!==\"\") && (selectedValue.value===unselectedValue);\n    cssStateManager.useProperty(unselected,\"unselected\");\n\n    const selectChangeHandler = (value: string) => {        \n        const newValue = (value===removeValue)?(((unselectedCaption!==\"\")?unselectedValue:null) || entries?.[0].value || \"\"):value;\n        selectedValue.value = newValue;\n        if (valueType===\"select\") {            \n            onValue((newValue===unselectedValue)?null:{\n                type: \"select\",\n                id: newValue\n            });\n        }\n        else if (valueType===\"variant-select\") {\n            onValue((newValue===unselectedValue)?null:{\n                type: \"variant-select\",\n                id: newValue\n            });\n        }\n    };\n\n    useEffect(() => {\n        if (loadFromSavedValue) {\n            selectChangeHandler(loadFromSavedValue.id);\n        }\n    },[loadFromSavedValue]);\n\n    const { productOptions: { buttonSelectedTextColor,buttonBackgroundColor,lightTextColor,buttonUnselectedTextColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <OptionTitle caption={title} subCaption={subTitle} price={price} priceEnabled={selectedValue.value!==unselectedValue} />\n                <select className=\"select\" value={selectedValue.value} onChange={(e) => selectChangeHandler(e.target.value)}>\n                    {(unselectedCaption!==\"\")?<option className=\"hidden-option\" value={unselectedValue}>{unselectedCaption}</option>:\"\"}\n                    {(removable && !unselected)?<option value={removeValue}>-- Remove ---</option>:\"\"}\n                    {entries.map(({caption,value},index) => <option key={index} value={value}>{caption}</option>)}\n                </select>\n                {(description!==\"\")?(\n                    <div className=\"description\">\n                        {description}\n                    </div>\n                ):\"\"}\n            </div>\n            <style jsx>{`\n            .container {\n                padding-bottom: 16rem;\n            }\n            .select {\n                cursor: pointer;\n                height: 45rem;\n                outline: none;\n                border: 1rem solid rgba(190, 190, 190);\n                border-radius: 5rem;\n                width: 100%;\n                font-size: 16rem;\n                font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                padding: 0rem 9rem;\n                color: ${buttonSelectedTextColor};\n                /* background-color: transparent; */\n                background-color: ${buttonBackgroundColor};\n                font-weight: 600;                            \n            }\n\n            .description {\n                color: ${lightTextColor};\n                font-size: 12rem;\n                margin-top: 15rem;                \n            }\n\n            .unselected .select {\n                color: ${buttonUnselectedTextColor};\n            }\n\n            .select option {\n                color: ${buttonSelectedTextColor};\n            }\n\n            .hidden-option {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .select {\n                    background-color: var(--body-background-color);\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { MutableRefObject, useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { usePubSubReceiver, usePubSubSender } from \"../../../hooks/use_pub_sub\";\nimport { useSmartState } from \"../../../hooks/use_smart_state\";\nimport { misc } from \"../../../lib/misc\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\nimport PriceDisplay from \"../../common/price-display\";\nimport PriceDisplayWithDiscount from \"../../common/price-display-with-discount\";\nimport StarRating from \"../../common/star_rating\";\nimport PriceUpdate, { PriceUpdateRefInterface } from \"./price-update\";\nimport { consumeReviewsHeader } from \"../../../hooks/use_reviews_header\";\n\nexport type PriceTopSliderProps = {\n    productId: string;\n    title: string;\n    price: number;\n    topSectionRef: MutableRefObject<HTMLDivElement>;\n    titleBadgeRef: MutableRefObject<HTMLDivElement>;\n};\n\nexport default function PriceTopSlider({productId,title,price,topSectionRef,titleBadgeRef}:PriceTopSliderProps)\n{\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const miniNavbarDown = usePubSubReceiver<boolean>(\"mini-navbar-down\",false);\n    const passedScroll = useSmartState(false);\n    const priceTopSliderOpen = miniNavbarDown.value && passedScroll.value;\n    cssStateManager.useProperty(priceTopSliderOpen,\"open\");    \n\n    const { send: sendPriceTopSliderOpen } = usePubSubSender<boolean>(\"price-top-slider-open\");    \n\n    useEffect(() => {\n        sendPriceTopSliderOpen(priceTopSliderOpen);\n    },[priceTopSliderOpen]);\n\n    const layout = useContext(LayoutStateContext);\n    const { page,scaleRemToPixel,mobileDetect } = layout;\n    let { reviewsCount,starRating } = consumeReviewsHeader(productId,layout);\n    starRating = Math.min(Math.max(Math.round(starRating*2)/2,0),5);\n\n    cssStateManager.useProperty(reviewsCount===0,\"no-reviews\");\n\n    const { isSmallDesktopScreen: isMobileActive,smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n    const { dollar,cents } = misc.splitPriceForDisplay(price);\n    const discountedPrice = prebuildData.getProductPageDiscountedPrice(productId,price).price;\n\n    const reload = useSmartState(false);\n\n    useEffect(() => \n    {\n        return page.addScrollEventListener(({top}) => \n        {\n            const getDesktopCutoff = () => {\n                const gap = (topSectionRef.current?.offsetHeight-titleBadgeRef.current?.offsetHeight) || 0;\n                return gap+scaleRemToPixel(230);\n            };\n            passedScroll.value = top>(isMobileActive.current?scaleRemToPixel(195):getDesktopCutoff());            \n        });\n        reload.value = true;\n    },[]);\n\n    const { productTitlePriceTopSlider: { backdropFilter,borderBottomColor,mobileborderBottomColor,textColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"slider\">\n                    <div className=\"title\">\n                        {title}\n                        <div className=\"mobile-stars\">\n                            <StarRating rating={starRating} scale={0.6} />\n                        </div>\n                    </div>\n                    <div className=\"stars\">\n                        <StarRating rating={starRating} scale={0.8} />\n                    </div>\n                    <div className=\"spacer\"></div>\n                    <div className=\"price-update\"><PriceUpdate price={discountedPrice} /></div>\n                    <div className=\"price\"><PriceDisplay price={discountedPrice} size={isMobileActive.current?20:23} /></div>\n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n                --duration: 0.3s;\n                position: fixed;\n                top: 48rem;\n                left: 0rem;\n                width: 100%;\n                height: 52rem;\n                overflow: hidden;\n                font-size: 16rem;\n                color: ${textColor};\n                visibility: hidden;\n                transition: visibility var(--duration);\n                z-index: 1;\n            }\n            .no-reviews .mobile-stars,.no-reviews .stars {\n                display: none;\n            }\n            .open.container {\n                visibility: visible;\n            }\n            .slider {\n                position: absolute;\n                top: 0rem;\n                left: 0rem;\n                width: 100%;\n                height: 100%;\n                background-color: var(--body-background-color);\n                opacity: 0.97;\n                backdrop-filter: ${backdropFilter};\n                border-bottom: 1rem solid ${borderBottomColor};\n                display: flex;\n                align-items: center;\n                transform: translateY(-100%);\n                transition: transform var(--duration);\n            }\n            .open .slider {\n                transform: translateY(0rem);\n            }\n            .stars {\n                padding-left: 10rem;\n                padding-bottom: 3rem;\n            }\n            .title {\n                padding-left: 12rem;                \n                font-weight: 600;                \n            }\n            .spacer {\n                flex: 1 1;\n            }\n            .price {\n                padding-right: 10rem;\n                padding-bottom: 3.5rem;\n                /*\n                font-weight: 600;\n                font-size: 20rem;\n                */\n            }\n            .price-update {\n                margin-right: 8rem;\n            }\n\n            .sup {\n                font-size: 13rem;\n                position: relative;\n                top: -6rem;            \n            }\n            .sup.cents {\n                left: 1rem;\n            }\n            .mobile-stars {\n                display: none;\n            }\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .container {\n                    height: 46rem;\n                    font-size: 14rem;\n                }\n                .slider {\n                    border-bottom: 1rem solid ${mobileborderBottomColor};\n                }\n                .stars {\n                    display: none;\n                }               \n                .mobile-stars {\n                    display: block;\n                    margin-top: -1rem;\n                }\n                .title {\n                    font-size: 13rem;\n                }\n                .price {\n                    padding-bottom: 2.5rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { consumeReviewsHeader } from \"../../../hooks/use_reviews_header\";\nimport { SmartState } from \"../../../hooks/use_smart_state\";\nimport { misc } from \"../../../lib/misc\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\nimport { ConfigProduct } from \"../../../scripts/pre-build/types\";\nimport StarRating from \"../../common/star_rating\";\nimport PriceUpdate from \"./price-update\";\n\nexport type ProductHeaderProps = {\n    product: ConfigProduct;\n    currentPrice: SmartState<number>;\n};\n\nexport default function ProductHeader({product,currentPrice}:ProductHeaderProps)\n{\n    const cssStateManager = useCssStateManager([\"container\"]);\n    const discountedPrice = prebuildData.getProductPageDiscountedPrice(product.id,currentPrice.value).price;\n    const { dollar,cents } = misc.splitPriceForDisplay(discountedPrice);\n\n    let { starRating,reviewsCount } = consumeReviewsHeader(product.id);\n    starRating = Math.min(Math.max(Math.round(starRating*2)/2,0),5);\n    cssStateManager.useProperty(reviewsCount===0,\"no-reviews\");\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"review-stars\">       \n                    <StarRating rating={starRating} scale={1.5} />\n                </div>\n                <div className=\"title\"> \n                    {product.caption}\n                </div>      \n                <div className=\"price\">\n                    <span className=\"sup\">$</span>{dollar}<span className=\"sup cents\">{cents}</span>\n                    <div className=\"price-update\"><PriceUpdate price={discountedPrice} /></div>\n                </div>\n            </div>\n            <style jsx>{`\n            .container {\n            }                        \n\n            .no-reviews .review-stars {\n                display: none;\n            }\n\n            .title {\n                font-size: 24rem;\n                margin-top: 6rem;\n                letter-spacing: 1rem;            \n            }\n            \n            .price {\n                margin-top: 6rem;\n                font-size: 27rem;\n                font-weight: 600;                \n            }\n\n            .sup {\n                font-size: 14rem;\n                position: relative;\n                top: -9rem;            \n            }\n\n            .sup.cents {\n                left:1.5rem;\n            }\n\n            .price-update {\n                display: inline-block;\n                position: relative;\n                top: -5rem;\n                margin-left: 12rem;\n            }\n            `}</style>\n        </>\n    );\n}","import { MutableRefObject, useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { SmartState, useSmartState } from \"../../../hooks/use_smart_state\";\nimport { lstore } from \"../../../lib/localstorage\";\nimport { misc } from \"../../../lib/misc\";\nimport { isSimpleObject } from \"../../../lib/shared/options/snapshot/misc\";\nimport { OptionsOptionCheckbox } from \"../../../lib/shared/options/types\";\nimport { prebuildData, VariantStub } from \"../../../lib/prebuild-data\";\nimport { cart, dollarPriceToCentPrice, generateCartItemInitialOptionValues, generateCartItemPriceProperties, getSimpleOptionPrice } from \"../../../lib/services/cart/cart\";\nimport { CartItem, CartItemOptionValues, OptionValue, OptionValueButton, OptionValueCheckbox, OptionValueCheckboxGroup, OptionValueProductSelect, OptionValueSelect, OptionValueVariantSelect } from \"../../../lib/services/cart/types\";\nimport { ConfigProduct } from \"../../../scripts/pre-build/types\";\nimport StarRating from \"../../common/star_rating\";\nimport AddToCart from \"./add-to-cart\";\nimport ButtonsOption from \"./options/buttons\";\nimport CheckboxOption from \"./options/checkbox\";\nimport CheckboxGroupOption from \"./options/checkbox-group\";\nimport ColorPickerOption from \"./options/color-picker\";\nimport OptionTitle from \"./options/commons/title\";\nimport MultiSelectOption from \"./options/multi-select\";\nimport SelectComponent from \"./options/select\";\nimport SelectWithQuantity from \"./options/select-with-quantity\";\nimport PriceTopSlider from \"./price-top-slider\";\nimport PriceUpdate from \"./price-update\";\nimport ProductHeader from \"../../../components/pages/product/header\";\nimport { WindowSizeContext } from \"../../../contexts/window_size\";\nimport { pubSubRequest } from \"../../../hooks/use_pub_sub_request\";\nimport { AddToCartActions, OptionsHaveAddons } from \"../../../pages/collections/[id]/products/[product_id]\";\n\nexport type OptionsProps = {\n    editCartItem: SmartState<CartItem>;\n    product: ConfigProduct;\n    galleryHeight: number;\n    onSlideShowMatch?: (value: string,bypassSlideshowAnimation?: boolean) => void;\n    currentPrice: SmartState<number>;\n    addToCartRef?: MutableRefObject<HTMLDivElement>;\n    alreadyAddedToCart: SmartState<boolean>;\n    alreadyAlreadyAddedToCart: SmartState<boolean>;\n    addToCartEnabled: SmartState<boolean>;\n    addToCartActionsRef: MutableRefObject<AddToCartActions>;\n    topSectionRef: MutableRefObject<HTMLDivElement>;\n    titleBadgeRef: MutableRefObject<HTMLDivElement>;\n    innerWrapperRef: MutableRefObject<HTMLDivElement>;\n    hasAddOns: SmartState<OptionsHaveAddons>;\n    descriptionHasTabs: boolean;\n};\n\nexport default function Options({\n        editCartItem,\n        product,\n        addToCartActionsRef,\n        addToCartEnabled,\n        galleryHeight,\n        onSlideShowMatch = () => {},\n        currentPrice,\n        addToCartRef,\n        alreadyAddedToCart,\n        alreadyAlreadyAddedToCart,\n        topSectionRef,\n        titleBadgeRef,\n        innerWrapperRef,\n        hasAddOns,\n        descriptionHasTabs\n    }:OptionsProps)\n{\n    const optionsCompiler = prebuildData.getOptionsCompiler();\n    \n    const { sideCart,page,scalePixelToRem,mobileDetect,mobileDetectUseEffect,pageRef,productPageLoadCounter } = useContext(LayoutStateContext);\n\n    const originalProductId = product.id.toString();\n    \n    const productOptions = optionsCompiler.getProductOptions(product.id);    \n    const { options } = productOptions;\n\n    if (product.visibility===\"tease\") options.length = 0;\n\n    const includedCheckboxOptions = options.filter((option) => ((option.type===\"checkbox\") && (option.included))) as OptionsOptionCheckbox[];\n    const nonIncludedCheckboxOptions = options.filter((option) => ((option.type===\"checkbox\") && (!option.included))) as OptionsOptionCheckbox[];\n    const hasIncluded = (includedCheckboxOptions.length>0);\n    const hasNonIncluded = (nonIncludedCheckboxOptions.length>0);\n\n    let firstNonIncludedCheckboxIndex = -1;\n    let lastNonIncludedCheckboxIndex = -1;\n\n    options.forEach((option,index) => {\n        if ((option.type===\"checkbox\") && (!option.included)) {\n            if (firstNonIncludedCheckboxIndex===-1) firstNonIncludedCheckboxIndex = index;\n            lastNonIncludedCheckboxIndex = index;   \n        }\n    });\n\n    useEffect(() => {\n        hasAddOns.value = (firstNonIncludedCheckboxIndex!==-1)?\"yes\":\"no\";\n    },[]);\n\n    const { isSmallDesktopScreen: isMobileActive,smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const sliderState = useSmartState(0);\n    const sliderHeightTransitionDuration = useSmartState(0);\n    const addToCartDisabledBypass = useSmartState(false);\n\n    const cssStateManager = useCssStateManager([\"container\"]);\n    cssStateManager.useProperty(sliderState.value===0,\"slide-height-zero\");\n    cssStateManager.useProperty(sliderState.value===-1,\"slide-height-auto\");    \n\n    const show = cssStateManager.useState(false,\"show\");\n    cssStateManager.useProperty(addToCartDisabledBypass.value && (sliderState.value===0),\"add-to-cart-disabled-bypass\");    \n\n    const lsDigestKey = `pd_${product.id}`;\n\n    const loadFromSavedOptionValues = useSmartState<CartItemOptionValues>({});\n\n    const productSelectProductListCacheRef = useRef<{[id: string]: ConfigProduct[]}>({});\n    const { current: productSelectProductListCache } = productSelectProductListCacheRef;\n    const productSelectItemCaptionFnCacheRef = useRef<{[id: string]: any}>({});\n    const { current: productSelectItemCaptionFnCache } = productSelectItemCaptionFnCacheRef;\n    const variantSelectItemsFnCacheRef = useRef<{[id: string]: any}>({});\n    const { current: variantSelectItemsFnCache } = variantSelectItemsFnCacheRef;\n    const variantSelectItemCaptionFnCacheRef = useRef<{[id: string]: any}>({});\n    const { current: variantSelectItemCaptionFnCache } = variantSelectItemCaptionFnCacheRef;\n    const checkboxProductFnCacheRef = useRef<{[id: string]: any}>({});\n    const { current: checkboxProductFnCache } = checkboxProductFnCacheRef;\n\n    // const enabledCount = useSmartState(1);\n    const enabledCount = useSmartState(100);    \n    const isFirstRef = useRef(0);\n\n    const cartItemRef = useRef<CartItem>();\n    const optionIdListRef = useRef<string[]>();\n    const requiredOptionsHashRef = useRef<{[id: string]: true}>();\n    const digestLoadedRef = useRef(false);\n\n    let enabledOptionsHashInit: {[id: string]: boolean} = {};\n\n    const isOpenRef = useRef(false);\n\n    const genEnabledOptionsHash = () => {\n        const ret: {[id: string]: boolean} = {};\n        const { current: optionIdList } = optionIdListRef;\n        const { current: requiredOptionsHash } = requiredOptionsHashRef;\n\n        let enabledValue = true;\n        let isOpen = true;\n\n        optionIdList.forEach((optionId) => {\n            ret[optionId] = enabledValue;\n            isOpen = isOpen && enabledValue;\n            if (requiredOptionsHash[optionId]) {\n                enabledValue = false;\n            }\n        });\n\n        isOpenRef.current = isOpen;\n\n        return ret;\n    };\n\n    const includedId = \"--included--\";\n    const addToCartId = \"--add-to-cart--\";    \n\n    // const alreadyAddedToCart = useSmartState(false);\n    // const alreadyAlreadyAddedToCart = useSmartState(true);\n    const currentCartItemDigestRef = useRef(\"\");\n\n    useEffect(() => {\n        cart.deletionSubscribe((digest) => {\n            if (currentCartItemDigestRef.current===digest) {\n                alreadyAlreadyAddedToCart.value = false;\n                alreadyAddedToCart.value = false;\n            }\n        });\n    },[]);    \n\n    const updateAlreadyAddedToCart = (cartItem: CartItem,cb: (alreadyAddedToCartValue: boolean) => void = () => {}) => {\n        cart.runWhenLoaded(() => {\n            const {uuid: cartItemId,digest} = cart.getItemIdByDigest(cartItem);\n            currentCartItemDigestRef.current = digest;\n            alreadyAlreadyAddedToCart.value = true;\n            const alreadyAddedToCartValue = (cartItemId!==\"\");\n            alreadyAddedToCart.value = alreadyAddedToCartValue;  \n            cb(alreadyAddedToCartValue);  \n        });\n    };\n\n    const saveItemCartToLocalStorage = () => {        \n        if (cart.editOrder) return;\n        if (!digestLoadedRef.current) return;\n        const savedOptionValues: CartItemOptionValues = {};\n        const acceptedKeys: {[key: string]: true} = {};\n        options.forEach((option,index) => {\n            const { id } = option;\n            if (!(((option.type===\"buttons\") || (option.type===\"checkbox\") || (option.type===\"variant-select\")) && (option.cartLink))) {\n                acceptedKeys[id] = true;\n            }\n            // if (firstNonIncludedCheckboxIndex!==-1) {\n            //     if (index<firstNonIncludedCheckboxIndex) {\n            //         acceptedKeys[id] = true;    \n            //     }\n            // }\n            // else {\n            //     acceptedKeys[id] = true;\n            // }\n        });\n        \n        Object.keys(cartItem.optionValues)\n            .filter((key) => acceptedKeys[key] && !cartItem.optionValues[key].defaultSet)\n            .forEach((key) => savedOptionValues[key] = cartItem.optionValues[key]);           \n        lstore.set(lsDigestKey,savedOptionValues);\n        // console.log(\"im here sure111\",lsDigestKey,savedOptionValues,lstore.get(lsDigestKey));\n    };\n\n    if (!cartItemRef.current) {\n\n        const productId = product.id.toString();         \n        const cartItem: CartItem = {\n            activatedOptionsMap: {},\n            optionValues: generateCartItemInitialOptionValues(productId),\n            productId: productId,\n            quantity: 1,\n            quantityDisplay: \"1\",\n            uuid: misc.genUUID(),\n            version: 1\n        };\n        cartItemRef.current = cartItem;\n\n        //---\n\n        const optionIdList: string[] = [];\n        const requiredOptionsHash: {[id: string]: true} = {};\n        const { options } = optionsCompiler.getProductOptions(product.id);\n        options.forEach((option) => {\n            if (option.type===\"buttons\") {\n                if (option.items.filter((item) => item.selected).length===0) {\n                    requiredOptionsHash[option.id] = true;\n                }                \n            }\n            else if ((option.type===\"product-select\") && (option.multiSelect)) {\n                requiredOptionsHash[option.id] = true;\n            }\n            if ((option.type!==\"checkbox\") || (!option.included)) {\n                optionIdList.push(option.id);\n            }\n        });\n        optionIdList.push(includedId,addToCartId);\n\n        optionIdListRef.current = optionIdList;\n        requiredOptionsHashRef.current = requiredOptionsHash;\n\n        enabledOptionsHashInit = genEnabledOptionsHash();\n    }\n\n    const processLoadedDigestForMobileSliderHeightState = (digest: CartItemOptionValues) => {\n        const { options } = optionsCompiler.getProductOptions(product.id);\n        let isOpen = true;\n        options.forEach((option) => {\n            if (!isOpen) return;\n\n            if (option.type===\"buttons\") {\n                if (option.items.filter((item) => item.selected).length===0) {\n                    if (!digest[option.id]) {\n                        return (isOpen = false);\n                    }\n                }                \n            }\n            else if ((option.type===\"product-select\") && (option.multiSelect)) {\n                const digestValue = digest[option.id];\n                if ((!digestValue) || ((digestValue.type===\"product-select\") && (digestValue.ids.length<option.multiSelect.min))) {\n                    return (isOpen = false);\n                }\n            }\n        });\n        if (isOpen) {\n            const tmpCartItem: CartItem = {\n                productId: product.id.toString(),\n                quantity: 1,\n                quantityDisplay: \"1\",\n                uuid: \"\",\n                version: 0,\n                activatedOptionsMap: {},\n                optionValues: {...digest}\n            };\n            cart.runWhenLoaded(() => {                \n                const {uuid: cartItemId} = cart.getItemIdByDigest(tmpCartItem);\n                if (cartItemId!==\"\") {\n                    if (options.length>0) {\n                        sliderState.value = -1;\n                    }                    \n                }\n            });\n        }\n        else {\n            addToCartDisabledBypass.value = true;\n        }\n    };\n\n    const currentlyEditingUuid = useRef(cart.editCartItem?cart.editCartItem.uuid:\"\");\n\n    mobileDetectUseEffect(() => {        \n        const removeDeadVariants = (digest: CartItemOptionValues) => {\n            Object.keys(digest).forEach((key) => {\n                const optionValue = digest[key];\n                if (optionValue.type===\"variant-select\") {\n                    if (!prebuildData.getVariantStub(optionValue.id)) {\n                        delete digest[key];\n                    }                    \n                }\n            });\n            return digest;\n        };\n\n        let digest = cart.editOrder?null:lstore.get<CartItemOptionValues>(lsDigestKey);\n        digestLoadedRef.current = true;\n        if ((cart.editCartItem) && (cart.editCartItem.productId===product.id.toString())) {            \n            digest = cart.editCartItem.optionValues;\n            editCartItem.value = cart.editCartItem;\n            cart.editCartItem = null;            \n        }\n        if ((digest) && (Object.keys(digest).length>0)) {\n            if (isMobileActive.current) processLoadedDigestForMobileSliderHeightState(digest);\n            loadFromSavedOptionValues.value = removeDeadVariants(digest);\n        }\n        else {            \n            if (isOpenRef.current) {\n                // updateAlreadyAddedToCart(cartItem,(alreadyAddedToCartValue) => {\n                //     if ((isMobileActive.current) && (alreadyAddedToCartValue)) {\n                //         if (options.length>0) {\n                //             sliderState.value = -1;\n                //         }                    \n                //     }\n                // });\n            }    \n            else if (isMobileActive.current) {\n                addToCartDisabledBypass.value = true;\n            }\n        }\n        show.value = true;\n    },[],\"small_desktop\");\n\n\n    const enabledOptionsHash = useSmartState(enabledOptionsHashInit);\n\n    const { current: cartItem } = cartItemRef;\n    const { current: requiredOptionsHash } = requiredOptionsHashRef;\n\n    const scrollToOption = (optionId: string) => {\n        if (optionsSliderRef.current) {\n            const optionElem = optionsSliderRef.current.querySelector(`.opt_${optionId}`) as HTMLDivElement;\n            if (optionElem) {\n                if (pageRef.current) {\n                    const pageElem = pageRef.current;\n                    const offsetTop = optionElem.offsetTop+(optionElem.offsetParent as HTMLDivElement).offsetTop;\n                    const midpointOffsetTop = offsetTop+(optionElem.offsetHeight/2);\n                    const midpointOffsetTopFromScreen = midpointOffsetTop-pageElem.scrollTop;\n                    const target = window.innerHeight/2;\n                    const delta = target-midpointOffsetTopFromScreen;\n                    const startScrollTop = pageElem.scrollTop;\n                    const durationPer100 = 375;                \n                    const duration = (Math.abs(scalePixelToRem(delta))/100)*durationPer100;\n                    let lastSetScroll = -1;\n                    setTimeout(() => {\n                        const timestamp = (new Date()).getTime();\n                        // pageElem.scrollTo({top: pageElem.scrollTop-delta,behavior: \"smooth\"});                \n                        // const easeFunc = (t: number) => 1 - Math.cos((t * Math.PI) / 2);\n                        const easeFunc = (x: number) => 1 - Math.pow(1 - x, 3);\n                        const next = () => {\n                            const timespan = Math.min((new Date()).getTime()-timestamp,duration);                 \n                            if ((lastSetScroll!==-1) && (Math.abs(pageElem.scrollTop-lastSetScroll)>=1)) return;\n                            lastSetScroll = pageElem.scrollTop = startScrollTop-((easeFunc(timespan/duration))*delta);\n                            if (timespan<duration) requestAnimationFrame(next);\n                        };\n                        requestAnimationFrame(next);    \n                    },450);    \n                }\n            }\n        }\n    };\n\n    const refreshPrice = (incVersion = false) => {\n        if (incVersion) cartItem.version++;\n        const { price } = generateCartItemPriceProperties(cartItem,{enforceLimitOnePerOrder: true,ignoreUuid: currentlyEditingUuid.current});\n        currentPrice.value = price;\n    };\n\n    const updateItemCartOptionValue = (id: string,value: OptionValue | null,auto?: boolean) => {\n        if (value!==null) {\n            cartItem.optionValues[id] = value;\n            if (requiredOptionsHash[id]) {\n                const { options } = optionsCompiler.getProductOptions(product.id);\n                const option = options.filter((option) => option.id===id)[0];\n                if (option) {\n                    let found = false;\n                    if (option.type===\"buttons\") {\n                        found = true;\n                    }\n                    else if ((option.type===\"product-select\") && (option.multiSelect) && (value.type===\"product-select\") && (value.ids.length>=option.multiSelect.min)) {\n                        found = true;\n                    }\n                    if (found) {\n                        const beforeEnabledHash = genEnabledOptionsHash();\n                        delete requiredOptionsHash[id];\n                        const afterEnabledHash = genEnabledOptionsHash();\n                        let newlyEnabledOptionId = \"\";\n                        if ((isMobileActive.current) && (!auto)) {\n                            Object.keys(afterEnabledHash).forEach((optionId) => {\n                                if ((newlyEnabledOptionId!==\"\") || (optionId===includedId)) return;\n                                if ((afterEnabledHash[optionId]) && (!beforeEnabledHash[optionId])) {\n                                    newlyEnabledOptionId = optionId;\n                                }\n                            });\n                            if (newlyEnabledOptionId) {\n                                scrollToOption(newlyEnabledOptionId);\n                            }\n                        }\n                        enabledOptionsHash.value = afterEnabledHash;        \n                    }\n                }\n            }\n        }\n        else {\n            delete cartItem.optionValues[id];\n        }        \n\n        refreshPrice(true);\n\n        saveItemCartToLocalStorage();\n\n        if (isOpenRef.current) {\n            // updateAlreadyAddedToCart(cartItem);\n        }\n    };\n\n    useEffect(() => {\n        refreshPrice();\n    },[]);\n\n    const slideFrameRef = useRef<HTMLDivElement>();\n\n    const { dollar,cents } = misc.splitPriceForDisplay(currentPrice.value);    \n\n    const calculateSliderHeightTransitionDuration = () => {\n        if (slideFrameRef.current) {\n            const durationPer100 = 0.165;\n            const targetHeight = scalePixelToRem(slideFrameRef.current.offsetHeight)-20;\n            return (targetHeight/100)*durationPer100;\n        }\n        else {\n            return 0;\n        }\n    };\n\n    const optionsSliderRef = useRef<HTMLDivElement>();\n\n    const optionsSliderTransitionEndHandler = (target: HTMLDivElement,propertyName: string) => {\n        if ((target===optionsSliderRef.current) && (propertyName===\"height\") && (sliderState.value>0)) {\n            sliderState.value = -1;\n            if (tempDisableAddToCartRef.current) {\n                tempDisableAddToCartRef.current = false;\n            }\n        }\n    };\n\n    const tempDisableAddToCartRef = useRef(false);\n\n    // useEffect(() => {\n    //     if ((alreadyAddedToCart.value) && (tempDisableAddToCartRef.current)) {\n    //         tempDisableAddToCartRef.current = false;\n    //     }\n    // },[alreadyAddedToCart.value]);\n\n    useEffect(() => {\n        if (tempDisableAddToCartRef.current) {\n            tempDisableAddToCartRef.current = false;\n        }\n    },[tempDisableAddToCartRef.current]);\n\n    // console.log(\"product.id\",product.id);\n\n    useEffect(() => {\n        addToCartEnabled.value = !!enabledOptionsHash.value[addToCartId];\n    },[!!enabledOptionsHash.value[addToCartId]])\n\n    const addToCartClickHandler = (quantity: number) => {\n        if (tempDisableAddToCartRef.current) return;\n        if ((isMobileActive.current) && (sliderState.value===0) && (options.length>0)) {\n            if (slideFrameRef.current) {\n                tempDisableAddToCartRef.current = true;\n                sliderHeightTransitionDuration.value = calculateSliderHeightTransitionDuration();                \n                sliderState.value = scalePixelToRem(slideFrameRef.current.offsetHeight)-20;\n                const firstOptionId = options?.[0]?.id;\n                if (firstOptionId) {\n                    scrollToOption(firstOptionId);\n                }\n            }\n        }\n        else {\n            tempDisableAddToCartRef.current = true;\n            const { highlightIds,flashIds } = cart.addItem({...cartItem,quantity,quantityDisplay: quantity.toString()});\n            sideCart.open({highlightIds,flashIds});\n            refreshPrice(true);\n\n            // const setAlreadyAdded = () => {\n            //     alreadyAddedToCart.value = true;\n            //     alreadyAlreadyAddedToCart.value = false;    \n            // };\n\n            // if (isMobileActive.current) {\n            //     setTimeout(setAlreadyAdded,300);\n            // }\n            // else {\n            //     setAlreadyAdded();\n            // }\n        }\n    };\n\n    const addToCartViewInCartHandler = () => {\n        sideCart.open({flashIds: [cart.getItemIdByDigest(cartItem).uuid]});\n    };\n\n    const addToCartSaveClickHandler = () => {\n        if (tempDisableAddToCartRef.current) return;\n        if (!editCartItem.value) return;\n        const id = editCartItem.value.uuid;\n        cart.updateCartItem(id,cartItem);        \n        editCartItem.value = null;\n        currentlyEditingUuid.current = \"\";\n        sideCart.open({flashIds: [id]});\n        refreshPrice(true);\n\n        productPageLoadCounter.value++;\n\n\n        // const setAlreadyAdded = () => {\n        //     alreadyAddedToCart.value = true;\n        //     alreadyAlreadyAddedToCart.value = false;    \n        // };\n\n        // if (isMobileActive.current) {\n        //     setTimeout(setAlreadyAdded,300);\n        // }\n        // else {\n        //     setAlreadyAdded();\n        // }\n    };\n\n    addToCartActionsRef.current.onClick = addToCartClickHandler;\n    addToCartActionsRef.current.onViewInCart = addToCartViewInCartHandler;\n    addToCartActionsRef.current.onSaveClick = addToCartSaveClickHandler;\n    \n\n    let addedOptionCount = 0;\n\n    const teaseCaption = ((product.visibility===\"tease\") && (product.teaseCaption))?product.teaseCaption:\"\";\n    let foundFirstCartLink = false;\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"inner-wrapper\" ref={innerWrapperRef}>\n                    <div className=\"desktop-header\">\n                        <ProductHeader product={product} currentPrice={currentPrice} />\n                    </div>\n                    <div \n                        className=\"options-slider\" \n                        style={{\n                            ...((sliderState.value>0)?{height: `${sliderState.value}rem`}:{}),\n                            ...((sliderState.value>0)?{transition: `height ${sliderHeightTransitionDuration.value}s`}:{})\n                        }}\n                        onTransitionEnd={(e) => optionsSliderTransitionEndHandler(e.target as HTMLDivElement,e.propertyName)}\n                        ref={optionsSliderRef}\n                    >\n                        <div className=\"options-slider-frame\" ref={slideFrameRef}>\n                    {options.map((option,index) => {\n                        const isFirstCartLink = (() => {\n                            if (((option.type===\"buttons\") || (option.type===\"checkbox\") || (option.type===\"variant-select\")) && (option.cartLink)) {\n                                if (!foundFirstCartLink) {\n                                    foundFirstCartLink = true;\n                                    return true;\n                                }\n                            }\n                            return false;\n                        })();\n\n                        const enabledIndex = index;\n                        //\"Choose your color\"\n                        if (option.type===\"buttons\") {\n                            const { caption,component,items,minWidth,colorPickerSize,quantity,cartLink } = option;\n                            if (component===\"color-picker\") {\n                                let initialSelectedItemIndex = -1;\n                                for(let i=0;i<items.length;i++) {\n                                    if (items[i].selected) {\n                                        initialSelectedItemIndex = i;\n                                        break;\n                                    }\n                                }\n                                addedOptionCount++;\n\n                                const loadFromSavedValue = (() => {\n                                    if (items.length===1) {\n                                        return {\n                                            type: \"buttons\",\n                                            id: items[0].id\n                                        };\n                                    }\n                                    return loadFromSavedOptionValues.value[option.id];\n                                })();\n\n                                return (\n                                    <div key={index} className={`option opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <ColorPickerOption\n                                            onSlideShowMatch={onSlideShowMatch}\n                                            title={caption}\n                                            colors={items.map(({id,color,caption,slideshowMatch}) => ({\n                                                    id,\n                                                    color: color || \"#000000\",\n                                                    caption,\n                                                    slideshowMatch\n                                                }))}\n                                            size={colorPickerSize}\n                                            initialSelectedItemIndex={initialSelectedItemIndex}                                        \n                                            onValue={(value,auto = false) => {                                                \n                                                updateItemCartOptionValue(option.id,value,auto);\n                                            }}\n                                            loadFromSavedValue={loadFromSavedValue as OptionValueButton}\n                                            {...(cartLink?{price: getSimpleOptionPrice(originalProductId,option.id)}:{})}\n                                        />                                  \n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );\n                            }\n                            else {\n                                addedOptionCount++;\n\n                                const loadFromSavedValue = (() => {\n                                    if (items.length===1) {\n                                        return {\n                                            type: \"buttons\",\n                                            id: items[0].id\n                                        };\n                                    }\n                                    return loadFromSavedOptionValues.value[option.id];\n                                })();\n                                \n                                return (\n                                    <div key={index} className={`option opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <ButtonsOption\n                                            onSlideShowMatch={onSlideShowMatch} \n                                            title={caption}\n                                            minWidth={minWidth}\n                                            buttons={items.map(({caption,value,id,slideshowMatch}) => ({\n                                                caption,\n                                                id,\n                                                slideshowMatch,\n                                                ...(isSimpleObject(value)?{\n                                                    custom: true,\n                                                    customRange: {\n                                                        min: value.range?.from,\n                                                        max: value.range?.to,\n                                                        decimalUnit: (value.type===\"number\")?Math.round(value.unit*10):0\n                                                    },\n                                                    customDisplay: value.display,\n                                                    customPlaceholder: value.placeholder\n                                                }:{})\n                                            }))}\n                                            onValue={(value,auto = false) => {\n                                                updateItemCartOptionValue(option.id,value,auto);\n                                            }}\n                                            loadFromSavedValue={loadFromSavedValue as OptionValueButton}\n                                            quantity={quantity}\n                                        />\n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );\n                            }                        \n                        }\n                        else if (option.type===\"product-select\") {\n                            const { caption,subCaption,multiSelect,filters,sort,id,itemCaption } = option;                        \n                            const products = (productSelectProductListCache[id] = productSelectProductListCache[id] || prebuildData.getFilteredProductList(filters,sort));\n                            \n                            const itemCaptionFn = productSelectItemCaptionFnCache[id] = productSelectItemCaptionFnCache[id] || prebuildData.evalInContext(itemCaption);\n                            \n                            if (multiSelect) {\n                                addedOptionCount++;\n                                return (\n                                    <div key={index} className={`option opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <MultiSelectOption\n                                            title={caption}\n                                            subTitle={subCaption || \"\"}\n                                            input={{\n                                                captions: multiSelect.captions,\n                                                min: multiSelect.min,\n                                                max: multiSelect.max,\n                                                entries: products.map(({id}) => {\n                                                    const caption = itemCaptionFn({product: prebuildData.getProductStub(id.toString())});                                                \n                                                    return {\n                                                        caption,\n                                                        value: id.toString()\n                                                    };\n                                                }),\n                                                showAll: multiSelect.showAll\n                                            }}\n                                            onValue={(value,auto = false) => {\n                                                updateItemCartOptionValue(option.id,value,auto);\n                                            }}\n                                            loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueProductSelect}                                        \n                                        />\n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );    \n                            }\n                            else {\n                                return \"\";\n                            }\n                        }\n                        else if (option.type===\"variant-select\") {\n                            const { caption,multiple,unselectedCaption,items,itemCaption,id,description,limitOnePerOrder } = option;\n                            if (limitOnePerOrder) {                            \n                                if (cart.hasDealAlready(product.id.toString(),id,currentlyEditingUuid.current)) {\n                                    delete cartItem.optionValues[option.id];\n                                    return \"\";\n                                }                            \n                            }                                                        \n                            const itemsFn = (variantSelectItemsFnCache[id] = variantSelectItemsFnCache[id] || prebuildData.evalInContext(items.split('.deal[\"No Deal\"]').join('.deal?.[\"No Deal\"]')));\n                            // console.log(\"itemsFn\",itemsFn.toString());\n                            const variants = (itemsFn() as VariantStub[]).filter(({custom}) => !custom);\n\n                            const price = (() => {\n                                console.log(\"option.cartLink\",option.cartLink);\n                                if ((option.cartLink) && (variants.length>0)) {                                    \n                                    if (option.cartLink.type===\"normal\") {\n                                        const ret = prebuildData.getVariantHash()[variants[0].id]?.variant?.price;                                    \n                                        return (typeof ret===\"number\")?dollarPriceToCentPrice(ret):undefined;    \n                                    }\n                                    else /* if (option.cartLink.type===\"deal\") */ {\n                                        const ret = prebuildData.evalInContext(option.cartLink.price)();\n                                        return (typeof ret===\"number\")?dollarPriceToCentPrice(ret):undefined;    \n                                    }\n                                }\n                            })();\n\n                            console.log(\"im here price\",price);\n\n                            const classNameAddons: string[] = [];\n                            if (isFirstCartLink) classNameAddons.push(\"first-cartlink\");\n                            \n                            const itemCaptionFn = (variantSelectItemCaptionFnCache[id] = variantSelectItemCaptionFnCache[id] || prebuildData.evalInContext(itemCaption));\n\n                            if (multiple) {\n                                addedOptionCount++;\n                                return (\n                                    <div key={index} className={`option ${classNameAddons.join(\" \")} option_variant_select opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <SelectWithQuantity \n                                            title={caption}\n                                            unselectedCaption={unselectedCaption?unselectedCaption:\"\"}\n                                            entries={variants.map(({id: variantId}) => {\n                                                const stubs = prebuildData.getVariantAndProductStub(variantId);\n                                                return {\n                                                    caption: stubs?itemCaptionFn(stubs):\"\",\n                                                    value: variantId\n                                                };\n                                            })}\n                                            onValue={(value) => {\n                                                updateItemCartOptionValue(option.id,value);\n                                            }}\n                                            loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueVariantSelect}\n                                            price={price}\n                                        />\n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );\n                            }\n                            else {        \n                                addedOptionCount++;               \n                                return (\n                                    <div key={index} className={`option ${classNameAddons.join(\" \")} option_variant_select opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <SelectComponent\n                                            title={caption}\n                                            unselectedCaption={unselectedCaption?unselectedCaption:\"\"}\n                                            removable={!!unselectedCaption}\n                                            description={description}\n                                            entries={variants.map(({id: variantId}) => {\n                                                const stubs = prebuildData.getVariantAndProductStub(variantId);\n                                                return {\n                                                    caption: stubs?itemCaptionFn(stubs):\"\",\n                                                    value: variantId\n                                                };\n                                            })}\n                                            valueType=\"variant-select\"\n                                            onValue={(value) => {\n                                                updateItemCartOptionValue(option.id,value);\n                                            }}\n                                            price={price}\n                                            loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueVariantSelect}\n                                        />\n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );\n                            }\n                        }\n                        else if (option.type===\"checkbox\") {\n                            const { included,caption,product,description,id,cartLink } = option;\n                            \n                            if (!included) {\n                                let productFn = () => ({id: \"\"});\n                                if (product) {                                \n                                    productFn = (checkboxProductFnCache[id] = checkboxProductFnCache[id] || prebuildData.evalInContext(product));\n                                }\n                                const productId = productFn()?.id || \"\";\n                                const classNameAddons: string[] = [];\n                                // if ((firstNonIncludedCheckboxIndex===index) && (addedOptionCount>0)) classNameAddons.push(\"first-cartlink\");\n                                // if (lastNonIncludedCheckboxIndex===index) classNameAddons.push(\"last-checkbox\");\n                                if (isFirstCartLink) classNameAddons.push(\"first-cartlink\");\n                                addedOptionCount++;\n                                return (\n\n                                    <div key={index} className={`option ${classNameAddons.join(\" \")} option_checkbox opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                        <CheckboxOption \n                                            title={caption}\n                                            productId={productId}\n                                            description={description}\n                                            onValue={(value) => {\n                                                updateItemCartOptionValue(option.id,value);\n                                            }}\n                                            loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueCheckbox}\n                                            {...(cartLink?{price: getSimpleOptionPrice(originalProductId,id)}:{})}\n                                        />\n                                        <div className=\"blocker\"></div>\n                                    </div>\n                                );    \n                            }\n                            else {\n                                return \"\";\n                            }\n                        }\n                        else if (option.type===\"select\") {\n                            const { caption,items } = option;\n                            addedOptionCount++;\n                            return (\n                                <div key={index} className={`option opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                    <SelectComponent \n                                        title={caption}\n                                        entries={items.map(({caption,id}) => ({caption,value: id}))}\n                                        valueType=\"select\"\n                                        onValue={(value) => {\n                                            updateItemCartOptionValue(option.id,value);\n                                        }}\n                                        loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueSelect}\n                                    />        \n                                    <div className=\"blocker\"></div>\n                                </div>\n                            );\n                        }\n                        else if (option.type===\"checkbox-group\") {\n                            const { caption,items } = option;\n                            addedOptionCount++;\n                            return (\n                                <div key={index} className={`option opt_${option.id} ${(!enabledOptionsHash.value[option.id])?\"disabled\":\"\"}`}>\n                                    <CheckboxGroupOption \n                                        title={caption}\n                                        entries={items.map(({caption,id}) => {\n                                            const res = /^([\\s\\S]*)\\(([\\s\\S]*)\\)\\s*$/.exec(caption);                                        \n                                            if (res) {                                            \n                                                const caption = res[1].trim();\n                                                const subCaption = res[2].trim();\n                                                return {\n                                                    caption,\n                                                    subCaption,\n                                                    value: id\n                                                };\n                                            }\n                                            else {\n                                                return {caption,value: id};\n                                            }                                        \n                                        })}\n                                        onValue={(value) => {\n                                            updateItemCartOptionValue(option.id,value);\n                                        }}\n                                        loadFromSavedValue={loadFromSavedOptionValues.value[option.id] as OptionValueCheckboxGroup}\n                                    />\n                                    <div className=\"blocker\"></div>\n                                </div>\n                            );\n                        }\n                        else {\n                            return \"\";\n                        }\n                    })}\n                    {(() => {                    \n                        if (hasIncluded) {\n                            return \"\";\n                            \n                            return (\n                                <div className={`option ${(!enabledOptionsHash.value[includedId])?\"disabled\":\"\"}`}>\n                                    <OptionTitle caption=\"Included\" />\n                                    {includedCheckboxOptions.map(({caption,description,product,id},index) => {\n                                        let productFn = () => ({id: \"\"});\n                                        if (product) {                                \n                                            productFn = (checkboxProductFnCache[id] = checkboxProductFnCache[id] || prebuildData.evalInContext(product));\n                                        }\n                                        const productId = productFn()?.id || \"\";\n            \n                                        return (\n                                            <div key={index} className={`included-checkbox-wrapper ${(index===includedCheckboxOptions.length-1)?\"is-last\":\"\"}`}>\n                                                <CheckboxOption                                                 \n                                                    title={caption}\n                                                    titleStyle={\"internal\"}\n                                                    productId={productId}\n                                                    description={description}\n                                                    included      \n                                                />\n                                            </div>\n                                    )})}\n                                </div>        \n                            );\n                        }\n                        if (hasNonIncluded) {\n\n                        }\n                    })()}\n                        </div>\n                    </div>                \n                    <div className={`option  opt_${addToCartId} ${(!addToCartEnabled.value)?\"disabled\":\"\"}`}>\n                        <AddToCart onClick={addToCartClickHandler} \n                            onViewInCart={addToCartViewInCartHandler}\n                            added={alreadyAddedToCart.value}\n                            already={alreadyAlreadyAddedToCart.value}\n                            containerRef={addToCartRef}\n                            descriptionHasTabs={descriptionHasTabs}\n                            sliderIsOpen={sliderState.value===-1}\n                            noticeText={productOptions.vars[\"notice\"]}\n                            teaseCaption={teaseCaption}\n                        />\n                        <div className=\"blocker\"></div>\n                    </div>     \n                </div>                                     \n            </div>\n            <PriceTopSlider \n                productId={product.id.toString()}\n                title={product.caption} \n                price={currentPrice.value} \n                topSectionRef={topSectionRef}\n                titleBadgeRef={titleBadgeRef}\n            />\n            <style jsx>{`\n            .container {\n                position: relative;\n                padding-top: 52rem;\n                opacity: 0;\n                transition: opacity 1.3s;\n            }\n            /*\n            .option_checkbox {\n                --outer: 32rem;\n                background-color: #f5f5f5;\n                margin-left: calc(var(--outer) * -1);\n                margin-right: calc(var(--outer) * -1);\n                padding-left: var(--outer);\n                padding-right: var(--outer);\n            } \n            */           \n            .container.show {\n                opacity: 1;\n            }\n            .option-page {\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n            }\n            .option {\n                padding-top: 30rem;\n                position: relative;\n                opacity: 1;\n                transition: opacity 0.3s;\n            }\n            .option_checkbox.first-cartlink,.option_variant_select.first-cartlink {\n                padding-top: 30rem;\n                margin-top: 30rem;\n                border-top: 1rem solid #ddd;\n            }\n\n            /*\n            .option_checkbox.first-cartlink {\n                padding-top: 20rem;\n                margin-top: 20rem;\n            }\n            .option_checkbox.last-checkbox {\n                padding-bottom: 40rem;\n            }\n            */\n            .option .blocker {\n                position: absolute;\n                left: 0rem;\n                right: 0rem;\n                top: 0rem;\n                bottom: 0rem;\n                display: none;\n            }\n            .option.disabled .blocker {\n                display: block;\n            }\n            .option.disabled {\n                opacity: 0.32;\n            }\n            .top-section {\n                /*\n                position: absolute;                \n                top: 0rem;\n                */\n            }\n            .top-option-frame {\n            }\n            .title {\n                font-size: 24rem;\n                margin-top: 6rem;\n                letter-spacing: 1rem;            \n            }                        \n            .price {\n                margin-top: 6rem;\n                font-size: 27rem;\n                font-weight: 600;                \n            }\n            .sup {\n                font-size: 14rem;\n                position: relative;\n                top: -9rem;            \n            }\n            .sup.cents {\n                left:1.5rem;\n            }\n            .included-checkbox-wrapper {\n                margin-bottom: 15rem;\n            }\n            .included-checkbox-wrapper.is-last {\n                margin-bottom: 0rem;\n            }\n            .price-update {\n                display: inline-block;\n                position: relative;\n                top: -5rem;\n                margin-left: 12rem;\n            }\n\n            .desktop-header {\n                display: none;\n            }\n\n            .options-slider {\n                margin-top: -52rem;\n            }\n\n            .option.opt_--add-to-cart-- {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .option.opt_--add-to-cart-- {\n                    display: block;\n                }\n\n                .desktop-header {\n                    display: none;\n                }\n\n                .container {\n                    padding-top: 0rem;\n                }\n\n                .options-slider {\n                    overflow: hidden;                    \n                    --padding-hori: 30rem;\n                    margin-left: calc(var(--padding-hori) * -1);\n                    margin-right: calc(var(--padding-hori) * -1);\n                    margin-bottom: -35rem;\n                    margin-top: 20rem;\n                }\n\n                .options-slider-frame {\n                    /* background-color: #f7f7f7; */\n                    background-color: #f3f3f3;\n                    padding: 13rem var(--padding-hori);\n                    padding-bottom: 37rem;\n                    margin-top: -20rem;\n                }\n\n                .slide-height-zero .options-slider {\n                    height: 0rem;\n                }\n\n                .slide-height-auto .options-slider {\n                    height: auto;\n                }\n                .add-to-cart-disabled-bypass .option.opt_--add-to-cart--.disabled .blocker {\n                    display: none;\n                }\n\n                .add-to-cart-disabled-bypass .option.opt_--add-to-cart--.disabled {\n                    opacity: 1;\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { Fragment, useEffect, useRef } from \"react\";\nimport { useCssStateManager } from \"../../hooks/use_css_state_manager\";\nimport { useResizeObserver } from \"../../hooks/use_resize_observer\";\nimport { useSmartState } from \"../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../lib/prebuild-data\";\nimport SvgButton from \"../core/svg_button\";\n\nexport type VerticalSliderProps = {\n    children: React.ReactNode[];\n};\n\nexport default function VerticalSlider({children}:VerticalSliderProps)\n{\n    if (!Array.isArray(children)) children = [children];\n    const cssStateManager = useCssStateManager([\"vertical-slider\"]);\n\n    // const itemWidth = useSmartState(200);\n    const targetItemWidth = 163;\n    const itemWidth = useSmartState(targetItemWidth);\n    const spacer = useSmartState(0);\n    const minimumSpacer = 40;\n\n    const viewIndexRef = useRef(0);\n    const itemsPerPageRef = useRef(0);\n    const isTransitioningRef = useRef(false);\n    const scrollLeft = useSmartState(0);\n    const scrollTransitionDuration = useSmartState(0);\n\n    const refOnResize = useResizeObserver(({width}) => {\n        // const itemsPerPage = 6;\n        let remainder = width%targetItemWidth;\n        let times = Math.round((width-remainder)/targetItemWidth);\n        if (remainder===0) {\n            times--;\n            remainder = targetItemWidth;\n        }\n        let potSpacer = 0;\n        if (times>1) {\n            potSpacer = remainder/(times-1);\n            while((times>1) && (potSpacer<minimumSpacer))\n            {\n                times--;\n                remainder = width-times*targetItemWidth;\n                potSpacer = (times>1)?(remainder/(times-1)):0;\n            }\n        }\n        if (times===1) {\n            itemWidth.value = width;\n            spacer.value = 0;\n        }\n        else {\n            itemWidth.value = targetItemWidth;\n            spacer.value = potSpacer;\n        }\n        itemsPerPageRef.current = times;\n\n        const maxIndex = children.length-itemsPerPageRef.current;\n        let targetIndex = Math.min(viewIndexRef.current,maxIndex);\n        const newScrollLeft = getScrollLeftFromIndex(targetIndex);\n        if (newScrollLeft!==scrollLeft.value) {\n            scrollLeft.value = newScrollLeft;\n            scrollTransitionDuration.value = 0;\n            isTransitioningRef.current = false;\n        }\n    });\n\n    const sliderButtonHeight = 34;\n    const sliderButtonPadding = 15;\n    const sliderButtonOpacity = 0.2;\n    const sliderButtonOpacityHoverFactor = 1.45;\n    const sliderButtonOuterShift = 60;\n\n    const transitionPixelsPerSecond = 813.6/0.8;    \n\n    const getScrollLeftFromIndex = (index: number) => (itemWidth.value+spacer.value)*index;\n    const getScrollDistanceBetweenIndexes = (index1: number,index2: number) => Math.abs(getScrollLeftFromIndex(index1)-getScrollLeftFromIndex(index2));\n\n    const slideToViewIndex = (index: number) => {\n        if (index===viewIndexRef.current) return;\n        const maxIndex = children.length-itemsPerPageRef.current;\n        if ((index<0) || (index>maxIndex)) return;\n        const toScrollLeft = getScrollLeftFromIndex(index);\n        const distance = getScrollDistanceBetweenIndexes(viewIndexRef.current,index);\n        isTransitioningRef.current = true;\n        viewIndexRef.current = index;\n        scrollLeft.value = toScrollLeft;        \n        scrollTransitionDuration.value = distance/transitionPixelsPerSecond;         \n    };\n\n    const slideToPrevious = () => {\n        if (isTransitioningRef.current) return;\n        const toIndex = Math.max(viewIndexRef.current-(itemsPerPageRef.current-1),0);\n        slideToViewIndex(toIndex);\n    };\n    const slideToNext = () => {\n        if (isTransitioningRef.current) return;\n        const maxIndex = children.length-itemsPerPageRef.current;\n        const toIndex = Math.min(viewIndexRef.current+itemsPerPageRef.current-1,maxIndex);        \n        slideToViewIndex(toIndex);\n    };\n\n    const maxIndex = children.length-itemsPerPageRef.current;\n\n    cssStateManager.useProperty(viewIndexRef.current===0,\"hide-slider-left-button\");\n    cssStateManager.useProperty(viewIndexRef.current===maxIndex,\"hide-slider-right-button\");\n\n    const sliderRef = useRef<HTMLDivElement>();\n\n    const transitionEndHandler = (elem: HTMLDivElement,propertyName: string) => {\n        if ((elem===sliderRef.current) && (propertyName===\"transform\")) {\n            isTransitioningRef.current = false;\n        }\n    };\n\n    return (\n        <>\n            <div ref={refOnResize} className={cssStateManager.getClassNames()}>\n                <div className=\"overflow-hidden-wrapper\">\n                    <div\n                        ref={sliderRef}\n                        className=\"slider\"\n                        style={{\n                            transform: `translateX(-${scrollLeft.value}rem)`,\n                            transition: `transform ${scrollTransitionDuration.value}s`\n                        }}\n                        onTransitionEnd={(e) => transitionEndHandler(e.target as HTMLDivElement,e.propertyName)}\n                    >\n                        {children.map((element,index) => (\n                            <div \n                                className={`item ${(index===children.length-1)?\"last\":\"\"}`} \n                                key={index}\n                                style={{\n                                    flex: `0 0 ${itemWidth.value}rem`,\n                                    marginRight: `${(index<children.length-1)?spacer.value:0}rem`\n                                }}\n                            >\n                                {element}\n                            </div>\n                        ))}\n                    </div>\n                </div>\n                <div className=\"slider-button slider-button-left\">\n                    <SvgButton \n                        src={prebuildData.bustCache(\"/images/product/gallery/left-arrow.svg\")} \n                        aspectRatio={{width: 120,height: 188}} \n                        height={sliderButtonHeight}\n                        paddingHori={sliderButtonPadding}\n                        paddingVert={sliderButtonPadding}\n                        opacity={sliderButtonOpacity}\n                        opacityHover={sliderButtonOpacity*sliderButtonOpacityHoverFactor}\n                        onClick={slideToPrevious}\n                    />\n                </div>\n                <div className=\"slider-button slider-button-right\">\n                    <SvgButton \n                        src={prebuildData.bustCache(\"/images/product/gallery/right-arrow.svg\")} \n                        aspectRatio={{width: 120,height: 188}} \n                        height={sliderButtonHeight}\n                        paddingHori={sliderButtonPadding}\n                        paddingVert={sliderButtonPadding}\n                        opacity={sliderButtonOpacity}\n                        opacityHover={sliderButtonOpacity*sliderButtonOpacityHoverFactor}\n                        onClick={slideToNext}\n                    />\n                </div>\n            </div>\n            <style jsx>{`\n            .vertical-slider {                \n                position: relative;\n            }\n\n            .overflow-hidden-wrapper {\n                overflow-x: hidden;\n                width: 100%;\n                height: 100%;\n            }\n\n            .slider {\n                display: flex;\n            }\n\n            .item {\n            }\n            .item.last {\n            }\n\n            .slider-button {                \n                position: absolute;\n                top: calc(32.5% - ${(sliderButtonHeight+sliderButtonPadding*2)/2}rem);                \n            }\n            .slider-button-left {\n                left: -${sliderButtonOuterShift}rem;\n            }\n            .slider-button-right {\n                right: -${sliderButtonOuterShift}rem;\n            }\n\n            .hide-slider-left-button .slider-button-left,.hide-slider-right-button .slider-button-right {\n                display: none;\n            }\n\n            `}</style>\n        </>\n    );\n}","import { useContext, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { useCachedValue } from \"../../../hooks/use_cached_value\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { useCustomRouter } from \"../../../hooks/use_custom_router\";\nimport { useDesktopScrollbar } from \"../../../hooks/use_desktop_scrollbar\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\nimport VerticalSlider from \"../../common/vertical-slider\";\nimport GridItem, { GridItemData } from \"../../side_cart/also_bought/grid_item\";\n\nexport type FrequentlyBoughtWithProps = {\n    productIds: string[];\n};\n\ntype ProductItemProps = { id: string };\n\nfunction ProductItem({id}: ProductItemProps) {\n    const router = useCustomRouter();\n\n    const dataRef = useRef<GridItemData>();\n    if (!dataRef.current) {\n        const product = prebuildData.getProductById(id);\n        if (product) {\n            const {caption,smallImages,id} = product;\n            dataRef.current = {\n                imageSrc: prebuildData.bustCache(smallImages[0].src),\n                imageHoverSrc: (smallImages.length>1)?prebuildData.bustCache(smallImages[1].src):\"\",\n                title: caption,\n                productId: id.toString()\n            };\n        }\n    }\n\n    const productPageRoute = useCachedValue(() => prebuildData.getProductPageRoute(id),id);\n\n    const clickHandler = () => {\n        router.push(productPageRoute);\n    };\n\n    if (dataRef.current) {\n        return <GridItem data={dataRef.current} clickHandler={clickHandler} />;\n    }\n    else {\n        return null;\n    }\n}\n\nexport default function FrequentlyBoughtWith({productIds}:FrequentlyBoughtWithProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff,isSmallDesktopScreen: isMobile } = mobileDetect;\n\n    let { ref: sliderRef,styles: sliderStyles,className: sliderClassName,injectedStyles: sliderInjectedStyles } = useDesktopScrollbar();\n\n    const cssStateManager = useCssStateManager([\"frequently-bought-with\"]);\n\n    const { alsoBoughtWith: { titleColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"title\">Frequently Bought With</div>\n                {isMobile.current?(\n                    <div ref={sliderRef} className={[\"mobile-slider\",sliderClassName].join(\" \")} style={sliderStyles}>\n                        <div className=\"inner\">\n                            {productIds.map((id,index) => <div key={id} className={`product-item ${(index===0)?\"first\":\"\"}`}><ProductItem id={id} /></div>)}\n                        </div>\n                    </div>\n                ):(\n                    <div className=\"vertical-slider\">\n                        <VerticalSlider>\n                            {productIds.map((id) => <ProductItem key={id} id={id} />)}\n                        </VerticalSlider>\n                    </div>\n                )}\n            </div>\n            <style jsx>{sliderInjectedStyles}</style>\n            <style jsx>{`\n            .frequently-bought-with {\n                padding-top: 20rem;\n                margin-bottom: -20rem;\n            }\n            .title {\n                text-align: center;\n                font-size: 17rem;\n                font-weight: 600;\n                color: ${titleColor};\n                padding-bottom: 40rem;\n            }\n            .grid-item {\n                width: 150rem;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .frequently-bought-with {\n                    width: 100%;\n                }\n                .mobile-slider {\n                    overflow-x: auto;\n                    width: 100%;\n                    padding-bottom: 20rem;\n                    margin-bottom: -20rem;\n                }\n\n                .mobile-slider .inner {\n                    display: flex;\n                    flex-direction: row;\n                }\n\n                .product-item {\n                    flex: 0 0 150rem;\n                    margin-left: 20rem;\n                    margin-bottom: 10rem;\n                }\n                .product-item.first {\n                    margin-left: 0rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../hooks/use_css_state_manager\";\nimport { ProductReview, ProductReviewSummary, useProductReviewSummary } from \"../../../hooks/use_product_reviews_summary\";\nimport { consumeReviewsHeader } from \"../../../hooks/use_reviews_header\";\nimport { SmartState, useSmartState } from \"../../../hooks/use_smart_state\";\nimport { apiReview, ReviewsOrder } from \"../../../lib/api/review\";\nimport { misc } from \"../../../lib/misc\";\nimport { prebuildData } from \"../../../lib/prebuild-data\";\nimport { ConfigProduct } from \"../../../scripts/pre-build/types\";\nimport CenteredSpinner from \"../../common/centered-spinner\";\nimport StarRating from \"../../common/star_rating\";\nimport { EventPane } from \"../../core/event_pane\";\nimport { Icon } from \"../../core/icon\";\nimport Layout from \"../../layout\";\n\nexport type ReviewBarProps = {\n    starCount: number;\n    percentage: number;\n    reviewCount: number;\n    reviewCountTextWidth: number;\n    selected?: boolean;\n    notSelected?: boolean;\n    onClick?: () => void;\n};\n\nconst reviewBarFontSize = 14;\n\nfunction ReviewBar({starCount,percentage,reviewCount,reviewCountTextWidth,selected,notSelected,onClick = () => {}}:ReviewBarProps)\n{\n    const cssStateManager = useCssStateManager([\"review-bar\"]);    \n    cssStateManager.useProperty(reviewCountTextWidth===-1,\"hidden\");\n    cssStateManager.useProperty(selected,\"selected\");    \n    cssStateManager.useProperty(notSelected,\"not-selected\");    \n\n    const overlapHori = 16;\n    const overlapVert = 5;\n\n    const { productReviews: { \n        reviewStarsBarHoverTextColor,\n        reviewStarsBarHighlighterColor,\n        reviewStarsBarBorderColor,\n        reviewStarsBarPercentageBarColor,\n        reviewStarsBarPercentageBarHoverColor,\n        reviewStarsBarPercentageBarBorderColor,\n        reviewStarsBarPercentageBarHoverBorderColor,\n        reviewStarsBarPercentageBarSelectedColor,\n        ratingFilterBadgeCrossColor,\n        lightTextColor\n    } } = prebuildData.getActiveTheme();    \n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"back-highlighter\"></div>\n                <div className=\"star-count\">{starCount} star</div>\n                <div className=\"percentage-bar\">\n                    <div className=\"percentage-bar-inner\" style={{width: `${percentage}%`}}></div>\n                </div>\n                <div className=\"stats-percentage\">{percentage}%</div>\n                <div className=\"stats-review-count\" style={{\n                    flex: `0 0 ${reviewCountTextWidth+14}rem`\n                }}>({reviewCount})</div>\n                <EventPane overlapHori={overlapHori} overlapVert={overlapVert} onClick={onClick} />\n            </div>\n            <style jsx>{`\n            .review-bar {\n                display: flex;\n                flex-direction: row;\n                font-size: ${reviewBarFontSize}rem;\n                margin-bottom: 8rem;   \n                position: relative;             \n                align-items: center;\n                opacity: 1;\n                transition: color var(--duration),opacity var(--duration);\n            }\n\n            .review-bar.not-selected {\n                opacity: 0.6;\n            }\n            .review-bar.selected,.review-bar.hover {\n                color: ${reviewStarsBarHoverTextColor}\n            }\n            .back-highlighter {\n                opacity: 0;                \n                position: absolute;\n                --padding-hori: ${overlapHori}rem;\n                --padding-vert: ${overlapVert}rem;\n                left: calc(var(--padding-hori) * -1);\n                right: calc(var(--padding-hori) * -1);\n                top: calc(var(--padding-vert) * -1);\n                bottom: calc(var(--padding-vert) * -1);\n                background-color: ${reviewStarsBarHighlighterColor};\n                z-index: -1;\n                border: 1rem solid ${reviewStarsBarBorderColor};\n                transition: opacity var(--duration);\n            }\n            .selected .back-highlighter {\n                opacity: 1;\n            }\n            .hidden {\n                visibility: hidden;\n            }\n\n            .star-count {\n                flex: 0 0 52rem;     \n                margin: 3rem 0rem;\n            }\n\n            .percentage-bar {\n                flex: 1 1;\n                border: 1rem solid ${reviewStarsBarPercentageBarBorderColor};\n                border-radius: 3rem;\n                height: 19rem;\n            }\n\n            .percentage-bar-inner {\n                background-color: ${reviewStarsBarPercentageBarColor};\n                height: 100%;\n                transition: background-color var(--duration);\n            }\n\n            .review-bar.hover .percentage-bar-inner {\n                background-color: ${reviewStarsBarPercentageBarHoverColor};\n            }\n\n            .review-bar.hover .percentage-bar {\n                border: 1rem solid ${reviewStarsBarPercentageBarHoverBorderColor};\n            }\n\n            .selected .percentage-bar-inner,.review-bar.hover .percentage-bar-inner {\n                background-color: ${reviewStarsBarPercentageBarSelectedColor};\n            }\n\n            .stats-percentage {\n                text-align: right;\n                flex: 0 0 43rem;\n            }\n\n            .stats-review-count {\n                text-align: right;\n                color: ${ratingFilterBadgeCrossColor};\n            }\n\n            .selected .stats-review-count,.review-bar.hover .stats-review-count {\n                color: ${lightTextColor};\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type ReviewItemProps = {\n    review: ProductReview;\n    first: boolean;\n};\n\nfunction ReviewItem({review: { title,body,name,rating,timestamp },first}:ReviewItemProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { isSmallDesktopScreen: isMobile } = mobileDetect;\n\n    const timestampToDateDisplay = (timestamp: number) => {\n        const date = new Date(timestamp);        \n        const desktopMonthTable = [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];\n        const mobileMonthTable = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\n        const monthTable = isMobile.current?mobileMonthTable:desktopMonthTable;\n        return `${monthTable[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;\n    };\n\n    const cssStateManager = useCssStateManager([\"review-item\"]);\n    cssStateManager.useProperty(first,\"first\");\n\n    const { productReviews: {\n        reviewItemTextColor,\n        reviewItemDateTextColor,\n        reviewItemAvatarBackgroundColor\n    } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"identity\">\n                    <div className=\"avatar\">{name.trim().charAt(0).toUpperCase()}</div>\n                    <div className=\"avatar-right\">\n                        <div className=\"rating\">\n                            <StarRating rating={rating} scale={0.9} />                            \n                            <span className=\"date\">{timestampToDateDisplay(timestamp)}</span>\n                        </div> \n                        <div className=\"name\">{name}</div>   \n                    </div>\n                </div>\n                <div className=\"title-body\">\n                    {title?(\n                        <div className=\"title\">{title}</div>\n                    ):\"\"}                    \n                    <div className=\"body\">{body}</div>\n                </div>\n            </div>\n            <style jsx>{`\n            .review-item {\n                margin-top: 40rem;\n                color: ${reviewItemTextColor};\n            }\n            .first {\n                margin-top: 0rem;\n            }\n            .title {\n                font-weight: 600;\n                margin-bottom: 12rem;\n            }\n            .title-body {\n                margin-top: 15rem;\n                font-size: 15rem;\n            }\n            .body {\n                line-height: 25rem;\n            }\n            .identity {\n                display: flex;\n                flex-direction: row;\n            }\n            .avatar {\n                --size: 50rem;\n                width: var(--size);\n                height: var(--size);\n                border-radius: var(--size);\n                background-color: ${reviewItemAvatarBackgroundColor};\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                font-size: 13rem;\n                font-weight: 600;\n            }\n            .avatar-right {\n                padding-left: 10rem;\n            }\n            .rating {}\n\n            .rating .date {\n                color: ${reviewItemDateTextColor};\n                font-size: 13rem;\n                position: relative;\n                left: 8rem;\n                top: -2rem;\n            }\n            .name {\n                font-weight: 600;\n                font-size: 15rem;\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type NoReviewsProps = {\n};\n\nfunction NoReviews({}:NoReviewsProps)\n{\n    const cssStateManager = useCssStateManager([\"no-reviews\"]);\n\n    const { productReviews: {\n        noReviewsTextColor,\n        noReviewsIconColor\n    } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"icon\">\n                    <i className=\"icon-general-not-found\"></i>\n                </div>\n                <div className=\"text\">No reviews found</div>\n            </div>\n            <style jsx>{`\n            .no-reviews {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                color: ${noReviewsTextColor};\n            }\n\n            .icon {\n                font-size: 50rem;\n                color: ${noReviewsIconColor};\n            }\n\n            .text {\n                margin-top: 5rem;\n                font-size: 15rem;\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type ReviewListProps = {\n    reviews: ProductReview[];\n};\n\nfunction ReviewList({reviews}:ReviewListProps)\n{\n    const cssStateManager = useCssStateManager([\"review-list\"]);\n\n    if (!reviews) return <CenteredSpinner />;\n\n    if (reviews.length===0) return <NoReviews />;\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                {reviews.map((review,index) => (\n                    <ReviewItem key={index} review={review} first={index===0} />\n                ))}\n            </div>\n            <style jsx>{`\n            .review-list {\n            }\n            `}</style>\n        </>\n    );\n}\n\ntype LoadMoreState = \"load-more\" | \"loading\" | \"no-more\";\n\nexport type LoadMoreSectionProps = {\n    initialShowState: LoadMoreState;\n    onLoadMore?: () => Promise<boolean>;\n    loadingMoreReviews: SmartState<boolean>;\n};\n\nfunction LoadMoreSection({initialShowState,onLoadMore = async () => true,loadingMoreReviews}:LoadMoreSectionProps) \n{\n    const cssStateManager = useCssStateManager([\"load-more-section\"]);\n    const showState = cssStateManager.useStringState<LoadMoreState>(initialShowState,[\"load-more\",\"loading\",\"no-more\"]);\n\n    const buttonClickHandler = () => {\n        showState.value = \"loading\";\n        loadingMoreReviews.value = true;\n        (async () => {                        \n            const hasMore = await onLoadMore();\n            console.log({hasMore});\n            showState.value = hasMore?\"load-more\":\"no-more\";\n            loadingMoreReviews.value = false;\n        })();\n    };\n\n    const {\n        productReviews: {\n            loadMoreButtonColor,\n            loadMoreButtonHoverColor,\n            loadMoreButtonTextColor\n        }\n    } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"load-more-frame frame\">\n                    <div className=\"button\">\n                        Load More\n                        <EventPane onClick={buttonClickHandler} hoverOnTouchDown />\n                    </div>\n                </div>\n                <div className=\"loading-frame frame\">\n                    <CenteredSpinner scale={0.8} />\n                </div>\n            </div>\n            <style jsx>{`\n            .load-more-section {\n                padding-top: 32rem;\n                height: 90rem;\n            }\n\n            .frame {\n                display: none;\n            }\n\n            .load-more .load-more-frame {\n                display: block;\n                text-align: center;\n            }\n\n            .loading .loading-frame {\n                display: block;\n            }\n\n            .button {\n                position: relative;\n                display: inline-block;\n                background-color: ${loadMoreButtonColor};\n                color: ${loadMoreButtonTextColor};\n                padding: 13rem 32rem;\n                border-radius: 50rem;\n                font-size: 15rem;\n            }\n\n            .button.hover {\n                opacity: 0.92;\n                color: ${loadMoreButtonHoverColor};\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type ReviewsProps = {\n    product: ConfigProduct;\n};\n\nexport default function Reviews({product}:ReviewsProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n    const { smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const byRating = useSmartState(0);\n\n    const cssStateManager = useCssStateManager([\"reviews\"]);\n    cssStateManager.useProperty(!!byRating.value,\"has-by-rating\");\n    const { scaleRemToPixel,scalePixelToRem } = useContext(LayoutStateContext);\n\n    const reviewCountTextWidth = useSmartState(-1);\n\n    const summary = useProductReviewSummary(product.id);\n\n    const header = consumeReviewsHeader(product.id);\n\n    cssStateManager.useProperty(header.reviewsCount===0,\"no-reviews\");\n\n    const reviewsState = useSmartState<ProductReview[]>(null);\n    const { value: reviews  } = reviewsState;\n\n    const lastSortKeyRef = useRef(\"\");    \n    const reviewsOrder = useSmartState<ReviewsOrder>(\"most-recent\");    \n\n    const firstPassRef = useRef(true);\n\n    const reviewListRef = useRef<HTMLDivElement>();\n\n    const loadMoreKey = useSmartState(0);\n    const loadMoreInitialStateRef = useRef<LoadMoreState>(\"load-more\");\n\n    const reviewsOrderChangedFirstRef = useRef(true);\n\n    const loadingNewOrder = useSmartState(false);\n    const loadingMoreReviews = useSmartState(false);\n    const reviewListRemHeight = useSmartState(-1);\n\n    cssStateManager.useProperty(loadingNewOrder.value,\"loading-new-order\");\n\n    const expectedPerPage = 5;\n\n    const lastRatingValueRef = useRef(0);\n\n    useEffect(() => {\n        if (!reviewsOrderChangedFirstRef.current) {\n            if (reviewListRef.current) {\n                reviewListRemHeight.value = scalePixelToRem(reviewListRef.current.offsetHeight);\n            }\n            reviewsState.value = null;\n            loadingNewOrder.value = true;\n            (async () => {\n                const res = await apiReview.getReviews(product.id,reviewsOrder.value,\"\",{ byRating: byRating.value });\n                if (res) {\n                    loadMoreInitialStateRef.current = (res.items.length===expectedPerPage)?\"load-more\":\"no-more\";\n                    loadMoreKey.value++;\n                    lastSortKeyRef.current = res.lastSortKey;\n                    reviewsState.value = [...res.items];\n                    loadingNewOrder.value = false;\n                    reviewListRemHeight.value = -1;\n                }\n            })();\n        }\n        reviewsOrderChangedFirstRef.current = false;\n    },[reviewsOrder.value,byRating.value]);\n\n    if ((!summary) || (header.reviewsCount===-1)) return <CenteredSpinner />;    \n\n    if (firstPassRef.current) {\n        firstPassRef.current = false;\n        let maxTextWidth = 0;\n        for(let i=1;i<=5;i++) {\n            maxTextWidth = Math.max(maxTextWidth,misc.getTextWidth(`(${summary.ratings[i]})`,`\"Open Sans\", \"Arial\", \"Helvetica\", sans-serif`,scaleRemToPixel(reviewBarFontSize)));\n        }\n        reviewCountTextWidth.value = maxTextWidth;\n\n        reviewsState.value = [...summary.reviews];\n        lastSortKeyRef.current = summary.lastSortKey || \"\";\n\n        loadMoreInitialStateRef.current = (summary.reviews.length===expectedPerPage)?\"load-more\":\"no-more\";\n    }\n\n    const ratingToSingleDecimal = (rating: number) => {\n        rating = Math.round(header.starRating*10);\n        const decimal = rating%10;\n        const whole = Math.round((rating-decimal)/10)\n        return `${whole}.${decimal}`;\n    };\n\n    let reviewTotal = 0;\n    Object.keys(summary.ratings).forEach((key) => reviewTotal+= summary.ratings[key]);\n\n    const ratingPercentages = {\n        \"1\": 0,\n        \"2\": 0,\n        \"3\": 0,\n        \"4\": 0,\n        \"5\": 0,\n    };\n\n    let percentageTotal = 0;\n    if (reviewTotal>0) {\n        for(let i=1;i<5;i++) {\n            ratingPercentages[i] = Math.round((summary.ratings[i]/reviewTotal)*100);\n            percentageTotal+= ratingPercentages[i];\n        }\n        ratingPercentages[5] = 100-percentageTotal;\n        let pnt = 4;\n        while (ratingPercentages[5]<0) {\n            if (ratingPercentages[pnt]>0) {\n                ratingPercentages[pnt]--;\n                ratingPercentages[5]++;\n            }\n            pnt--;\n            if (pnt===0) pnt = 4;\n        }\n    }    \n\n    const starCounts: number[] = [5,4,3,2,1];\n\n    const loadMoreHandler = async () => {\n        // await misc.sleep(3000);\n        const res = await apiReview.getReviews(product.id,reviewsOrder.value,lastSortKeyRef.current,{byRating: byRating.value});\n        if (res) {\n            reviewsState.value = [...reviews,...res.items];\n            lastSortKeyRef.current = res.lastSortKey;\n            return (res.items.length===expectedPerPage);\n        }\n        else {\n            return true;\n        }\n    };\n    \n\n    const cancelByRatingHandler = () => {\n        byRating.value = 0;\n    };\n\n    const { productReviews: { \n        textColor,\n        lightTextColor,\n        lighterTextColor,\n        ratingFilterBadgeColor,\n        ratingFilterBadgeHoverColor,\n        ratingFilterBadgeTextColor,\n        ratingFilterBadgeBorderColor,\n        ratingFilterBadgeCrossColor \n    } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"summary\">\n                    <div className=\"title\">Customer reviews</div>\n                    <div className=\"rating\">\n                        <StarRating rating={header.starRating} />\n                        <span className=\"text\">{ratingToSingleDecimal(header.starRating)}</span>\n                    </div>\n                    <div className=\"review_count\">\n                        {(header.reviewsCount>0)?`${header.reviewsCount} review${(header.reviewsCount>1)?\"s\":\"\"}`:\"No reviews yet\"}\n                    </div>\n                    <div className=\"rating-bars\">\n                        {starCounts.map((starCount) => (\n                            <ReviewBar \n                                key={starCount} \n                                reviewCount={summary.ratings[starCount]} \n                                percentage={ratingPercentages[starCount]} \n                                starCount={starCount} \n                                reviewCountTextWidth={reviewCountTextWidth.value}\n                                selected={byRating.value===starCount}\n                                notSelected={byRating.value && (byRating.value!==starCount)}\n                                onClick={() => {\n                                    byRating.value = starCount;\n                                    lastRatingValueRef.current = starCount;\n                                }}\n                            />\n                        ))}\n                    </div>\n                    <div className=\"control-area\">\n                        <div className=\"sorted-by\">\n                            <div className=\"text\">Sort by</div>\n                            <select disabled={loadingNewOrder.value || loadingMoreReviews.value} value={reviewsOrder.value} onChange={(e) => reviewsOrder.value = e.target.value as ReviewsOrder}>\n                                <option value=\"most_recent\">Most Recent</option>\n                                <option value=\"highest-rated\">Highest Rated</option>\n                                <option value=\"lowest-rated\">Lowest Rated</option>\n                            </select>\n                        </div>\n                        <div className=\"rating-filter-badge\">\n                            <span className=\"inner\">\n                                Showing {(byRating.value>0)?byRating.value:lastRatingValueRef.current} star reviews only\n                                <span className=\"cross-icon\">\n                                    <Icon name=\"navbar-cross\" size={9} />\n                                </span>\n                            </span>\n                            <EventPane onClick={cancelByRatingHandler} hoverOnTouchDown />\n                        </div>                        \n                    </div>\n                </div>\n                <div className=\"review-list\" ref={reviewListRef} style={{\n                        height: (reviewListRemHeight.value===-1)?\"auto\":`${reviewListRemHeight.value}rem`\n                    }}\n                >                    \n                    <ReviewList reviews={reviews} />\n                    <div className=\"load-more-section\">\n                        <LoadMoreSection \n                            key={loadMoreKey.value}\n                            initialShowState={loadMoreInitialStateRef.current}\n                            onLoadMore={loadMoreHandler}\n                            loadingMoreReviews={loadingMoreReviews}\n                        />\n                    </div>\n                </div>\n            </div>\n            <style jsx>{`\n            .reviews {\n                display: flex;\n                flex-direction: row;\n                color: ${textColor};\n                padding-bottom: 50rem;\n                --duration: 0.3s;\n            }\n\n            .control-area {\n                overflow-y: hidden;\n                height: 51rem;\n                position: relative;\n            }\n\n            .rating-filter-badge {\n                position: absolute;\n                left: 0rem;\n                right: 0rem;\n                top: 3rem;\n                text-align: right;\n                margin-top: 20rem;\n                position: relative;\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity var(--duration),visibility var(--duration);\n            }\n\n            .has-by-rating .rating-filter-badge {\n                opacity: 1;\n                visibility: visible;\n            }\n\n            .rating-filter-badge span.inner {\n                font-size: 12rem;\n                background-color: ${ratingFilterBadgeColor};\n                border: 1rem solid ${ratingFilterBadgeBorderColor};\n                padding: 5rem 10rem;\n                border-radius: 26rem;\n                color: ${ratingFilterBadgeTextColor};\n            }\n\n            .rating-filter-badge.hover span.inner {\n                background-color: ${ratingFilterBadgeHoverColor};\n            }\n\n\n            .rating-filter-badge .cross-icon {\n                padding-left: 8rem;                \n                padding-right: 2rem;                \n                color: ${ratingFilterBadgeCrossColor};\n                position: relative;\n                top: -1rem;\n            }\n\n            .summary {\n                flex: 0 0 315rem;                \n            }\n\n            .review-list {\n                flex: 1 1;\n                margin-left: 60rem;\n            }\n\n            .title {\n                font-weight: 600;\n                font-size: 18rem;\n            }\n\n            .rating {\n                margin-top: 8rem;\n            }\n\n            .no-reviews .rating {\n                display: none;\n            }\n\n            .rating .text {\n                position: relative;\n                left: 6rem;\n                font-weight: 600;\n                color: ${lightTextColor};\n            }\n\n            .review_count {\n                margin-top: 4rem;\n                font-size: 15rem;\n                color: ${lightTextColor};\n            }\n\n            .rating-bars {\n                margin-top: 25rem;\n            }\n\n            .sorted-by {\n                opacity: 1;\n                visibility: visible;\n                position: absolute;\n                left: 0rem;\n                right: 0rem;\n                top: 0rem;\n                display: flex;\n                justify-content: flex-end;\n                align-items: center;\n                padding-top: 22rem;\n                margin-top: 0rem;\n                transition: opacity var(--duration),visibility var(--duration);\n            }\n            .has-by-rating .sorted-by {\n                opacity: 0;\n                visibility: hidden;\n            }\n            .sorted-by .text {\n                padding-right: 8rem;\n                font-size: 13rem;\n                position: relative;\n                top: 0rem;\n                color: ${lighterTextColor};\n            }\n            .sorted-by select {\n                border-radius: 3rem;\n                padding: 4rem 5rem;\n                outline: none;\n                background-color: #fff;\n                border: 1rem solid #ccc;\n                color: ${textColor};\n            }\n            .loading-new-order .load-more-section {\n                display: none;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .reviews {\n                    flex-direction: column;\n                }\n\n                .summary {\n                    flex: 0 1 auto;\n                }\n\n                .review-list {\n                    flex: 0 1 auto;\n                    margin-left: 0rem;\n                    border-top: 1rem solid #eee;\n                    padding-top: 30rem;\n                    margin-top: 30rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}","import { useEffect } from \"react\";\nimport { useSmartState } from \"./use_smart_state\";\nimport serverRefs from \"../server-refs.json\";\nimport { isSimpleObject } from \"../lib/shared/options/snapshot/misc\";\nimport { infiniteFetch } from \"../lib/infinite-fetch\";\nimport { libMockReviews } from \"../lib/mock-reviews\";\n\nexport type ProductReview = {\n    body: string;\n    title: string;\n    rating: number;\n    name: string;\n    timestamp: number;\n};\n\nexport type ProductReviewSummary = {\n    ratings: {\n        \"1\": number;\n        \"2\": number;\n        \"3\": number;\n        \"4\": number;\n        \"5\": number;\n    };\n    reviews: ProductReview[];\n    lastSortKey: string;\n};\n\nconst generateEmptySummary = () => {\n    const ret: ProductReviewSummary = {\n        lastSortKey: \"\",\n        ratings: {\n            \"1\": 0,\n            \"2\": 0,\n            \"3\": 0,\n            \"4\": 0,\n            \"5\": 0\n        },\n        reviews: []\n    };\n    return ret;\n};\n\nexport const useProductReviewSummary = (productId: string | number) => {\n    const summary = useSmartState<ProductReviewSummary>(null);\n\n    useEffect(() => {\n        (async () => {\n            summary.value = await libMockReviews.getProductReviewSummary(productId);            \n            // const url = `${serverRefs.buckets.public}/reviewsummaries/${productId}.json`;\n            // const response = await infiniteFetch(url);\n            // const value: ProductReviewSummary = (response.status===200)?(await response.json()):generateEmptySummary();                    \n            // if ((isSimpleObject(value?.ratings)) && (Array.isArray(value?.reviews)) && (typeof value?.lastSortKey===\"string\")) {\n            //     summary.value = value;\n            // }    \n    })();\n    },[]);\n\n    return summary.value;\n};","import { CSSProperties, useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../contexts/layout_state\";\nimport { WindowSizeContext } from \"../../contexts/window_size\";\nimport { useCssStateManager } from \"../../hooks/use_css_state_manager\";\nimport { useSmartState } from \"../../hooks/use_smart_state\";\nimport { prebuildData } from \"../../lib/prebuild-data\";\nimport { EventPane } from \"../core/event_pane\";\n\n\nexport type NavigationArrowProps = {\n    side: \"left\" | \"right\";\n    size: number;\n    iconSize: number;\n    onClick?: () => void;\n};\n\nfunction NavigationArrow({side,size,iconSize,onClick}:NavigationArrowProps)\n{\n    const cssStateManager = useCssStateManager([\"navigation-arrow\"]);\n    cssStateManager.useProperty(side===\"right\",\"right\");\n\n    const styles: CSSProperties = {\n        height: `${size}rem`,\n        fontSize: `${iconSize}rem`\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()} style={styles}>\n                <div className=\"icon-box hori-verti-centered\">\n                    <i className={`icon icon-navbar-${side}-arrow`} />\n                </div>\n                <div className=\"fade-gradient\"></div>                \n                <EventPane onClick={onClick} zIndex={3} />\n            </div>\n            <style jsx>{`\n            .navigation-arrow {\n                --duration: 0.3s;\n                color: #aaa;\n                display: flex;\n                flex-direction: row;\n                position: relative;\n            }\n\n            .navigation-arrow.right {\n                flex-direction: row-reverse;\n            }\n\n            .icon-box {\n                position: relative;\n                height: 100%;\n                width: 24rem;\n                z-index: 2;\n            }\n\n            .icon {\n                position: relative;\n                z-index: 2;\n            }\n\n            .fade-gradient {\n                --shift: -24rem;\n                position: relative;\n                height: 100%;\n                width: 30rem;\n                background: linear-gradient(90deg, #fbfbfd 0%, rgba(0,0,0,0) 100%);\n                left: var(--shift);\n                z-index: 1;\n            }\n\n            .right .fade-gradient {\n                background: linear-gradient(90deg, rgba(0,0,0,0) 0%, #fbfbfd 100%);\n\n                left: calc(var(--shift) * -1);\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type TabsHeaderDisplayStyle = \"relaxed\" | \"tight\" | \"full\";\n\nexport type TabsHeaderProps = {\n    value: number;\n    onChange?: (newValue: number) => void;\n    captions: string[];\n    displayStyle: TabsHeaderDisplayStyle;\n};\n\nexport default function TabsHeader({value,onChange = () => {},captions,displayStyle}:TabsHeaderProps)\n{\n    const cssStateManager = useCssStateManager([\"tabs-header\"]);\n    cssStateManager.useProperty(displayStyle===\"relaxed\",\"relaxed\");    \n    cssStateManager.useProperty(displayStyle===\"full\",\"full\");\n    const hasScroll = cssStateManager.useState(false,\"has-scroll\");    \n    const { scalePixelToRem,scaleRemToPixel,mobileDetect: { isActive: isMobile } } = useContext(LayoutStateContext);\n    const windowSize = useContext(WindowSizeContext);\n\n    const headersRef = useRef<HTMLDivElement>();\n    const headerWidthsRef = useRef(captions.map((_,index) => 0));\n    const { current: headerWidths } = headerWidthsRef;\n\n    const showLeftNavigator = cssStateManager.useState(false,\"show-left-navigator\");\n    const showRightNavigator = cssStateManager.useState(false,\"show-right-navigator\");\n\n    const scrollerRef = useRef<HTMLDivElement>();    \n\n    const scrollHandler = (updateHasScroll = false) => {\n        if (scrollerRef.current) {\n            const { current: scrollerElem } = scrollerRef;\n            const availableScroll = scrollerElem.scrollWidth-scrollerElem.offsetWidth;\n            if (updateHasScroll) {\n                hasScroll.value = (availableScroll>0);\n            }\n            if ((availableScroll>0) && !isMobile.current) {\n                showLeftNavigator.value = (scrollerElem.scrollLeft>0);\n                showRightNavigator.value = (scrollerElem.scrollLeft<availableScroll);\n            }\n            else {\n                showLeftNavigator.value = showRightNavigator.value = false;\n            }    \n        };\n    };\n\n    const navigatorClickHandler = (side: \"left\" | \"right\") => {\n        if (scrollerRef.current) {\n            const { current: scrollerElem } = scrollerRef;\n            if (side===\"left\") {\n                scrollerElem.scrollTo({left: 0,behavior: \"smooth\"});\n            }\n            else {\n                const availableScroll = scrollerElem.scrollWidth-scrollerElem.offsetWidth;\n                scrollerElem.scrollTo({left: availableScroll,behavior: \"smooth\"});\n            }\n        }        \n    };\n\n    useEffect(() => {\n        scrollHandler(true);\n    },[windowSize.width]);    \n\n    const getHeaderOffsetLeft = (value: number) => headerWidths.filter((_,index) => (index<value)).reduce((acc,inc) => acc+inc,0);\n\n    useEffect(() => {\n        if (scrollerRef.current) {\n            const { current: scrollerElem } = scrollerRef;\n            const availableScroll = scrollerElem.scrollWidth-scrollerElem.offsetWidth;\n            const headerOffset = scaleRemToPixel(getHeaderOffsetLeft(value));\n            const centeredScrollLeft = headerOffset-((scrollerElem.offsetWidth-headerWidths[value])/2);\n            const targetScrollLeft = Math.min(availableScroll,Math.max(0,centeredScrollLeft));\n            if (scrollerElem.scrollLeft!==targetScrollLeft) {\n                scrollerElem.scrollTo({left: targetScrollLeft,behavior: \"smooth\"});\n            }\n        }        \n    },[value]);\n\n    useEffect(() => {\n        if (headersRef.current) {\n            const { current: headersElem } = headersRef;\n            headerWidthsRef.current = captions.map((_,index) => {\n                const headerElem = headersElem.querySelector(`.column${index}`) as HTMLDivElement;\n                return headerElem?scalePixelToRem(headerElem.offsetWidth):0;\n            });\n        }\n    },[]);\n\n    const selectorLineStyles: CSSProperties = {\n        width: `${headerWidths[value]}rem`,\n        transform: `translateX(${getHeaderOffsetLeft(value)}rem)`\n    };\n\n    const navigatorProps = {\n        size: 52,\n        iconSize: 20\n    };\n\n    const { productDescriptionTabs: { hoverTextColor,selectedColor,textColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"hider\">\n                    <div ref={scrollerRef} className=\"scroller\" onScroll={() => scrollHandler()}>\n                        <div className=\"scroller-inner\">\n                            <div ref={headersRef} className=\"headers\">\n                                {captions.map((caption,index) => (\n                                    <div key={index} className={`header column${index}${(index===value)?\" selected\":\"\"}`}>\n                                        <span dangerouslySetInnerHTML={{__html: caption.split(/(&[^;]+;)/).map((value) => /^&[^;]+;$/.test(value)?value:value.toUpperCase()).join(\"\")}}></span>\n                                        <EventPane onClick={() => { if (index!==value) onChange(index); }} hoverOnTouchDown />\n                                    </div>\n                                ))}                    \n                            </div>\n                            <div className=\"line\"></div>\n                            <div className=\"selector-line\" style={selectorLineStyles}></div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"navigator left\"><NavigationArrow side=\"left\" {...navigatorProps} onClick={() => navigatorClickHandler(\"left\")} /></div>\n                <div className=\"navigator right\"><NavigationArrow side=\"right\" {...navigatorProps} onClick={() => navigatorClickHandler(\"right\")} /></div>\n            </div>\n            <style jsx>{`\n            .tabs-header {\n                --duration: 0.4s;                                                \n                position: relative;\n            }\n\n            .hider {\n                overflow: hidden;\n                height: 54rem;\n            }\n\n            .has-scroll .scroller-inner {\n                display: inline-block;\n            }\n\n            .navigator {\n                --duration: 0.3s;\n                --hori: -17rem;\n                position: absolute;\n                top: -5rem;\n                visibility: hidden;\n                opacity: 0;\n                transition: visibility var(--duration),opacity var(--duration);\n            }\n\n            .navigator.left {\n                left: var(--hori);\n            }\n\n            .show-left-navigator .navigator.left {\n                visibility: visible;\n                opacity: 1;\n            }\n\n            .navigator.right {\n                right: var(--hori);\n            }\n\n            .show-right-navigator .navigator.right {\n                visibility: visible;\n                opacity: 1;\n            }\n\n            .scroller {\n                overflow-x: auto;\n                padding-bottom: 50rem;\n            }\n\n            .headers {\n                display: flex;\n            }\n\n            .header {\n                padding: 12rem 14rem;\n                font-size: 14rem;\n                font-weight: 600;\n                letter-spacing: 0.5rem;\n                color: ${textColor};\n                position: relative;\n                transition: color var(--duration);\n                white-space: nowrap;\n            }\n\n            .full .header {\n                flex: 1 0;\n                text-align: center;\n                padding: 12rem 12rem;\n            }\n\n            .header.hover {\n                color: ${hoverTextColor};\n            }\n\n            .relaxed .header {\n                padding: 12rem 12rem;\n            }\n\n            .header.selected {\n                color: ${selectedColor};\n            }\n\n            .line {\n                height: 1rem;\n                background-color: #ddd;\n                margin-top: 10rem;\n                width: 100%;\n            }\n\n            .selector-line {\n                height: 2rem;\n                background-color: ${selectedColor};\n                position: relative;\n                top: -3rem;\n                transition: transform var(--duration),width var(--duration);\n            }\n            `}</style>\n        </>\n    );\n}","import { useRouter } from \"next/router\";\nimport { CSSProperties, Fragment, MutableRefObject, useContext, useEffect, useRef } from \"react\";\nimport { LayoutStateContext } from \"../../../../contexts/layout_state\";\nimport { useCssStateManager } from \"../../../../hooks/use_css_state_manager\";\nimport { prebuildData } from \"../../../../lib/prebuild-data\";\nimport ProductGallery, { ProductGalleryRefInterface } from \"../../../../components/pages/product/gallery\";\nimport Options from \"../../../../components/pages/product/options\";\nimport { useResizeObserver } from \"../../../../hooks/use_resize_observer\";\nimport { SmartState, useSmartState } from \"../../../../hooks/use_smart_state\";\nimport { usePubSubReceiver } from \"../../../../hooks/use_pub_sub\";\nimport ProductHeader from \"../../../../components/pages/product/header\";\nimport CollectionNavBar from \"../../../../components/pages/collection/collection-nav-bar\";\nimport BackToTop from \"../../../../components/common/back_to_top\";\nimport { EventPane } from \"../../../../components/core/event_pane\";\nimport FrequentlyBoughtWith from \"../../../../components/pages/product/frequently-bought-with\";\nimport TitlePriceBadge, { Includes } from \"../../../../components/pages/product/title-price-badge\";\nimport AlsoBought from \"../../../../components/side_cart/also_bought/also_bought\";\nimport Reviews from \"../../../../components/pages/product/reviews\";\nimport { misc } from \"../../../../lib/misc\";\nimport { consumeBoughtTogetherClient } from \"../../../../hooks/use_bought_together_client\";\nimport CenteredSpinner from \"../../../../components/common/centered-spinner\";\nimport TabsHeader, { TabsHeaderDisplayStyle } from \"../../../../components/common/tabs_header\";\nimport { useCustomRouter } from \"../../../../hooks/use_custom_router\";\nimport { useCachedValue } from \"../../../../hooks/use_cached_value\";\nimport Head from \"next/head\";\nimport { getInjectableHeaderTags } from \"../../../../components/layout\";\nimport { CartItem } from \"../../../../lib/services/cart/types\";\n\nconst optionsWidths = {\n    large: 610,\n    medium: 500,\n    small: 390\n};\n\nconst optionsCutoffs = {\n    large: 1500,\n    medium: 1447\n}\n\nexport async function getStaticPaths() {    \n    prebuildData.loadSnapshot();\n\n    const productTable = prebuildData.getProductTable();\n    return {\n        paths: Object.keys(productTable).filter((productId) => !productTable[productId].hidden).map(prebuildData.getProductPageParams.bind(prebuildData)).map((params) => ({params})),\n        fallback: false\n    };\n}\n  \nexport async function getStaticProps(context) {\n    return {\n        props: {},\n    };\n}\n\nexport type ProductProps = {\n};\n\nconst useExpandable = (closedHeight: number,onBeforeShowLess = () => {}) => {\n    const innerOffsetHeight = useSmartState(0);\n    const innerRef = useResizeObserver(({}) => {\n        if (innerRef.current) {\n            innerOffsetHeight.value = scalePixelToRem(innerRef.current.offsetHeight);\n        }        \n    });\n    const initialHeightAssessedRef = useRef(false);\n    const transitionDurationRef = useRef(0);\n    const isOpen = useSmartState(false);\n    const isDisabled = useSmartState(false);\n    const { scalePixelToRem,scaleFactorDetectUseEffect } = useContext(LayoutStateContext);\n\n    const calculateTransitionDuration = () => {\n        const durationPer100 = 0.13;\n        return Math.min(((Math.abs(innerOffsetHeight.value-closedHeight)/100)*durationPer100),1);\n    };\n\n    const clickHandler = () => {\n        if (isOpen.value) {\n            onBeforeShowLess();\n            isOpen.value = false;\n        }\n        else {\n            if (innerRef.current) {\n                innerOffsetHeight.value = scalePixelToRem(innerRef.current.offsetHeight);\n                transitionDurationRef.current = calculateTransitionDuration();\n                isOpen.value = true;\n            }\n        }\n    };\n\n    const style: CSSProperties = {};\n    const controllerStyle: CSSProperties = {};\n    const fadeStyle: CSSProperties = {};\n    if (isDisabled.value) {\n        style.height = \"auto\";\n        style.transition = \"none\";\n    }\n    else {\n        if (initialHeightAssessedRef.current) {\n            style.height = `${isOpen.value?innerOffsetHeight.value:closedHeight}rem`;\n            style.transition = `height ${transitionDurationRef.current}s`;        \n        }\n        else {\n            style.height = \"0rem\";\n            style.transition = \"none\";\n        }\n    }\n    fadeStyle.opacity = isOpen.value?0:1;\n    fadeStyle.transition = `opacity ${transitionDurationRef.current}s`;\n    const caption = isOpen.value?\"Show Less\":\"Show More\";\n    const directionClassName = isOpen.value?\"up\":\"down\";\n\n    if (isDisabled.value) {\n        controllerStyle.display = \"none\";\n    }\n\n    scaleFactorDetectUseEffect((scalePixelToRem) => {\n        if (innerRef.current) {\n            if (scalePixelToRem(innerRef.current.offsetHeight)<=closedHeight*1.25) {\n                isDisabled.value = true;\n            }\n        }\n        initialHeightAssessedRef.current = true;\n    },[]);\n\n    return { innerRef,clickHandler,style,caption,directionClassName,fadeStyle,controllerStyle,disabled: isDisabled.value };\n};\n\nexport type AddToCartActions = {\n    onClick?: (quantity: number) => void;\n    onViewInCart?: () => void;\n    onSaveClick?: () => void;\n};\n\nexport type ProductDescriptionProps = {\n    productId: string | number;\n    descriptionRef?: MutableRefObject<HTMLDivElement>;\n    rawDescriptionHtml?: string;\n};\n\nexport function ProductDescription({productId,descriptionRef,rawDescriptionHtml}:ProductDescriptionProps)\n{\n    const cssStateManager = useCssStateManager([\"description\"]);\n    const router = useCustomRouter();\n\n    const descriptionHtml = rawDescriptionHtml?rawDescriptionHtml:prebuildData.getProductDescriptionHtml(productId.toString());\n\n    const decriptionRef = useRef<HTMLDivElement>();\n\n    useEffect(() => {\n        if (decriptionRef.current) {\n            const { current: decriptionElem } = decriptionRef;\n            decriptionElem.querySelectorAll(\"a\").forEach((anchorElem) => {\n                const href = anchorElem.getAttribute(\"href\");\n                if (typeof href===\"string\") {\n                    if (/^https?:\\/\\//.test(href)) {\n                        anchorElem.target = \"_blank\";\n                    }\n                    else if (href.startsWith(\"/\")) {\n                        anchorElem.onclick = (e: MouseEvent) => {\n                            e.preventDefault();\n                            router.push(href);\n                        };  \n                    }\n                }\n            });\n        }\n    },[]);\n\n    const { productDescription: { boldTextColor,linkTextColor,tableAltBackgroundColor,tableBackgroundColor,tableBorderColor,textColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <div \n                ref={decriptionRef} \n                className={cssStateManager.getClassNames()}\n                dangerouslySetInnerHTML={{__html: descriptionHtml/*.replaceAll(/<a (href=\"https?:)/g,\"<a target=\\\"_blank\\\" $1\")*/}}\n                {...(descriptionRef?{ref: descriptionRef}:{})}\n            >                \n            </div>\n            <style jsx>{`\n            .description {\n                --normal-color: ${textColor};\n                --bold-color: ${boldTextColor};\n                font-family: \"Open Sans\", \"Arial\", \"Helvetica\", sans-serif;\n                font-size: 16rem;\n                line-height: 27rem;\n                color: var(--normal-color);                \n            }\n\n            .description :global(li) {\n                margin-bottom: 10rem;\n            }\n\n            .description :global(h1),.description :global(h2),.description :global(h3),.description :global(strong) {\n                color: var(--bold-color);\n            }\n\n            .description :global(h1) {\n                font-size: 24rem;\n                padding: 16rem 0rem;                \n            }\n\n            .description :global(h2) {\n                font-size: 18rem;\n                padding: 12rem 0rem;\n            }\n\n            .description :global(h3) {\n                font-size: 16rem;\n                padding: 6rem 0rem;\n                font-weight: 600;\n            }\n\n            .description :global(h5) {\n                font-weight: 400;\n            }\n\n            .description :global(strong) {\n                font-weight: 600;\n            }\n\n            .description :global(a) {\n                text-decoration: none;\n                /* color: #4d7cff; */\n                color: ${linkTextColor};\n            }\n\n            .description :global(table) {\n                background: #fff;\n                border: solid 1rem ${tableBorderColor};\n                margin-bottom: 1.25rem;\n                table-layout: auto;            \n            }\n\n            .description :global(table) {\n                margin: 25rem 0rem;\n            }\n\n            .description :global(table) :global(thead) {\n                background: ${tableBackgroundColor};\n            }\n\n            .description :global(table) :global(thead) :global(th) {\n                padding: 4rem 20rem;\n            }\n\n            .description :global(table) :global(td) {\n                padding: 4rem 10rem;\n            }\n\n            .description :global(table) :global(tr:nth-of-type(even)) {\n                background: ${tableAltBackgroundColor};\n            }\n\n            .description :global(iframe) {\n                max-width: 100%;\n            }\n            `}</style>\n        </>\n    );\n}\n\ntype TabEntry = {caption: string; tabHtml: string};\n\nexport type DescriptionTabsProps = {\n    tabs: TabEntry[];\n    displayStyle: TabsHeaderDisplayStyle;\n};\n\nfunction DescriptionTabs({tabs,displayStyle}:DescriptionTabsProps)\n{\n    const { mobileDetect: { smallDesktopWidthCutoff: mobileCutoff } } = useContext(LayoutStateContext);\n\n    const cssStateManager = useCssStateManager([\"description-tabs\"]);\n    cssStateManager.useProperty(displayStyle===\"relaxed\",\"relaxed\");\n    cssStateManager.useProperty(displayStyle!==\"relaxed\",\"tight\");\n\n    const selectedHeaderIndex = useSmartState(0);\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <TabsHeader displayStyle={displayStyle} value={selectedHeaderIndex.value} captions={tabs.map(({caption}) => caption)} onChange={(newValue) => selectedHeaderIndex.value = newValue}/>\n                <div className=\"tabs\">\n                    {tabs.map(({tabHtml},index) => (\n                        <div key={index} className={`tab${(selectedHeaderIndex.value===index)?\" selected\":\"\"}`}>\n                            <ProductDescription productId={0} rawDescriptionHtml={tabHtml} />\n                        </div>\n                    ))}\n                </div>\n            </div>\n            <style jsx>{`\n            .description-tabs.tight {\n                max-width: ${optionsWidths.large}rem;\n            }\n\n            .description-tabs.relaxed {\n                border-bottom: 1rem solid #ddd;\n                padding-bottom: 35rem;\n                margin-bottom: -5rem;\n            }\n\n            .description-tabs.relaxed {\n                margin-top: -20rem;\n            }            \n\n            .tab {\n                display: none;\n            }\n\n            .tab.selected {\n                display: block;\n            }\n\n            .tabs {\n                margin-top: 30rem;\n            }\n\n            @media screen and (max-width: ${mobileCutoff}px) {\n                .description-tabs.relaxed {\n                    margin-top: 10rem;\n                }            \n            }            \n\n            @media screen and (max-width: ${optionsCutoffs.large}px) {\n                .description-tabs.tight {\n                    max-width: ${optionsWidths.medium}rem;\n                }\n            }\n\n            @media screen and (max-width: ${optionsCutoffs.medium}px) {\n                .description-tabs.tight {\n                    max-width: ${optionsWidths.small}rem;\n                }\n            }\n            `}</style>\n        </>\n    );\n}\n\nexport type ProductDescriptionExpandableProps = {\n    productId: string | number;\n    descriptionRef?: MutableRefObject<HTMLDivElement>;\n    hideBottomLine?: boolean;\n    onBeforeShowLess?: () => void;\n    displayStyle: TabsHeaderDisplayStyle;\n    descriptionHasTabs?: SmartState<boolean>;\n};\n\nexport function ProductDescriptionExpandable({\n    productId,\n    descriptionRef,\n    hideBottomLine = false,\n    onBeforeShowLess = () => {},\n    displayStyle,\n    descriptionHasTabs}:ProductDescriptionExpandableProps)\n{\n    const { mobileDetect } = useContext(LayoutStateContext);\n\n    const { isSmallDesktopScreen: isMobile,smallDesktopWidthCutoff: mobileCutoff } = mobileDetect;\n\n    const cssStateManager = useCssStateManager([\"description-expandable\"]);\n    cssStateManager.useProperty(hideBottomLine,\"hide-bottom-line\");\n\n    const hasTabsRef = useRef(-1);\n\n    let descriptionHtml = prebuildData.getProductDescriptionHtml(productId.toString());    \n    \n    const hasTabs = (hasTabsRef.current!==-1)?!!hasTabsRef.current:!!(hasTabsRef.current=((descriptionHtml.indexOf(\"<p>[TABS]</p>\")!==-1)?1:0));\n\n    useEffect(() => {\n        if (descriptionHasTabs) descriptionHasTabs.value = hasTabs;\n    },[hasTabs]);\n\n    const descriptionClosedHeightMobile = 280;\n    const descriptionClosedHeightDesktop = 750;\n    const descriptionClosedHeight = isMobile.current?descriptionClosedHeightMobile:descriptionClosedHeightDesktop;\n\n    const descriptionExpandable = useExpandable(descriptionClosedHeight,onBeforeShowLess);\n    cssStateManager.useProperty(descriptionExpandable.disabled,\"description-expandable-disabled\");        \n\n    if (hasTabs) {\n        const tabsCacheRef = useRef<TabEntry[]>();\n        const tabsProductIdCacheRef = useRef(\"\");\n\n        const tabs = (productId.toString()===tabsProductIdCacheRef.current)?tabsCacheRef.current:(() => {            \n            descriptionHtml = descriptionHtml.split(\"<p>[TABS]</p>\").join(\"\");\n            const tabs: TabEntry[] = [];\n\n            let lastPartCaption = \"\";\n            while(true) {\n                const res = /<h1 id=\"[^\"]*\">([^<]*)<\\/h1>/.exec(descriptionHtml);\n                if (res) {                \n                    if (lastPartCaption!==\"\") {\n                        const caption = lastPartCaption;\n                        const tabHtml = descriptionHtml.substring(0,res.index).trim();      \n                        tabs.push({caption,tabHtml});\n                    }\n                    lastPartCaption = res[1];\n                    descriptionHtml = descriptionHtml.substring(res.index+res[0].length).trim();\n                }\n                else {\n                    if (lastPartCaption!==\"\") {\n                        const caption = lastPartCaption;\n                        const tabHtml = descriptionHtml.trim();\n                        tabs.push({caption,tabHtml});\n                    }\n                    break;\n                }\n            }\n\n            tabsProductIdCacheRef.current = productId.toString();\n            return (tabsCacheRef.current = tabs);    \n        })();\n\n        return <DescriptionTabs displayStyle={displayStyle} tabs={tabs} />;\n    }\n    else {\n        return (\n            <>\n                <div className={cssStateManager.getClassNames()}>\n                    <div className=\"description-section\" style={descriptionExpandable.style}>\n                        <div ref={descriptionExpandable.innerRef} className=\"description-wrapper\">\n                            <ProductDescription productId={productId} descriptionRef={descriptionRef} />\n                        </div>\n                    </div>\n                    <div className=\"description-controller\" style={descriptionExpandable.controllerStyle}>                        \n                        <span className=\"text\">{descriptionExpandable.caption}</span>\n                        <div className={`arrow ${descriptionExpandable.directionClassName}`}>\n                            <i className=\"icon-navbar-left-arrow\"></i>\n                        </div>\n                        <div className=\"fade\" style={descriptionExpandable.fadeStyle}></div>  \n                        <EventPane onClick={descriptionExpandable.clickHandler} />\n                    </div>\n                </div>\n    \n                <style jsx>{`\n    \n                .description-expandable.description-expandable-disabled {\n                    border-bottom: 1rem solid #ddd;\n                }\n    \n                .description-expandable.hide-bottom-line {\n                    border-bottom: none;\n                }\n    \n                .description-section {\n                    width: 100%;\n                    overflow-y: hidden;\n                }\n    \n                .description-wrapper {\n                    padding-bottom: 50rem;\n                }\n    \n                .description-expandable-disabled.hide-bottom-line .description-wrapper {\n                    padding-bottom: 0rem;\n                    margin-bottom: -20rem;\n                }\n    \n                .description-controller {\n                    position: relative;\n                    display: block;\n                    text-align: center;                    \n                    border-top: 1rem solid var(--border-color);\n                    border-bottom: 1rem solid var(--border-color);\n                    padding: 14rem 0rem;\n                    color: #666;\n                    font-size: 15rem;\n                }\n    \n                .hide-bottom-line .description-controller {\n                    border-bottom: none;\n                }\n    \n                .description-controller .text {\n                    padding-right: 6rem;\n                }\n    \n                .description-controller .arrow {\n                    display: inline-block;\n                    color: #999;\n                    font-size: 13rem;\n                }\n    \n                .description-controller .arrow.up {\n                    transform: rotate(90deg);\n                }\n    \n                .description-controller .arrow.down {\n                    transform: rotate(-90deg);\n                }\n    \n                .description-controller .fade {\n                    --height: ${descriptionClosedHeightMobile}rem;\n                    position: absolute;\n                    left: 0rem;\n                    right: 0rem;\n                    top: calc((var(--height) + 1rem) * -1);\n                    height: var(--height);                    \n                    background: linear-gradient(0deg, var(--body-background-color) 0%, rgba(0,0,0,0) 100%);\n                }\n    \n    \n                @media screen and (max-width: ${mobileCutoff}px) {\n                    .description-section {                    \n                        margin-top: 20rem;\n                    }\n    \n                    .description-wrapper {\n                        padding-top: 0rem;\n                    }\n                }\n                `}</style>\n            </>\n        );        \n    }\n}\n\nexport type OptionsHaveAddons = \"unknown\" | \"yes\" | \"no\";\n\nexport default function Product({}:ProductProps) {\n    const reactRouter = useRouter();\n    const { page,mobileDetect: { isSmallDesktopScreen: isMobile },productPageLoadCounter } = useContext(LayoutStateContext);\n\n    const lastIsMobileRef = useRef(isMobile.current);\n\n    useEffect(() => {\n        if (isMobile.current!==lastIsMobileRef.current) {\n            lastIsMobileRef.current = isMobile.current;\n            page.scrollTo({top: 0,behavior: \"smooth\"});\n        }\n    },[isMobile.current]);\n\n    let { id: collectionHandle,product_id: productHandle } = reactRouter.query as {[key: string]: string};\n    productHandle = productHandle.split(\"?\")[0];\n\n    return <ProductContent key={`${collectionHandle}-${productHandle}-${isMobile.current?\"1\":\"0\"}-${productPageLoadCounter.value}`} collectionHandle={collectionHandle} productHandle={productHandle} />;\n}\n\ntype ProductContentProps = {\n    collectionHandle: string;\n    productHandle: string;\n};\n\ntype NoticeActionProps = {\n    action?: string;\n};\n\nfunction NoticeAction({action}:NoticeActionProps)\n{\n    const router = useCustomRouter();\n\n    const cssStateManager = useCssStateManager([\"notice-action\",\"hori-verti-centered\"]);\n\n    if (!action) return null;\n\n    const res = /^\\[([^\\]]+)\\](.*)$/.exec(action);\n    if (!res) return null;\n\n    const alias = res[1];\n    const caption = res[2];\n\n    const productStub = prebuildData.getProductAliasStub(alias);\n    if (!productStub) return null;\n    \n    const pageRoute = useCachedValue(() => prebuildData.getProductPageRoute(productStub.id),productStub.id);\n\n    const clickHandle = () => {\n        router.push(pageRoute);\n    };\n\n    return (\n        <>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"button\">\n                    {caption}\n                    <EventPane onClick={clickHandle} hoverOnTouchDown seoLinkUrl={pageRoute} />\n                </div>\n            </div>            \n            <style jsx>{`\n            .notice-action {\n                margin-top: 20rem;\n            }\n\n            .button {\n                position: relative;\n                color: #FFF;\n                background-color: #8787ff;\n                padding: 13rem 20rem;\n                font-size: 14rem;\n                border-radius: 4rem;\n                transition: background-color 0.3s;\n            }\n\n            .button.hover {\n                background-color: #6a6aeb;\n            }\n            `}</style>\n        </>\n    );\n}\n\nfunction ProductContent({collectionHandle,productHandle}:ProductContentProps)\n{\n    const optionsCompiler = prebuildData.getOptionsCompiler();\n\n    const { page,mobileDetect,scaleRemToPixel,scalePixelToRem,mobileDetectUseEffect } = useContext(LayoutStateContext);\n    const router = useCustomRouter();\n\n    const { isSmallDesktopScreen: isMobile,smallDesktopWidthCutoff: mobileCutoff,smallDesktopWidthCutoff,widthCutoff } = mobileDetect;\n\n    const addToCartActionsRef = useRef<AddToCartActions>({});\n\n    const galleryHeight = useSmartState(0);\n\n    const { collection,product } = prebuildData.getProductCollectionByHandles(collectionHandle,productHandle);\n    const collectionItems = prebuildData.getCollectionItems({omitSupport: true});\n\n    const productOptions = optionsCompiler.getProductOptions(product.id);        \n\n    const crumbHomeClickHandler = () => {\n        router.push(\"/\");\n    };\n\n    const collectionRoute = useCachedValue(() => collection.route.split(\"{handle}\").join(collectionHandle),collectionHandle);\n\n    const crumbCategoryClickHandler = () => {\n        router.push(collectionRoute);\n    };\n\n    const editCartItem = useSmartState<CartItem>(null);\n\n    const galleryRef = useRef<ProductGalleryRefInterface>();\n\n    const slideShowMatchHandler = (value: string,bypassSlideshowAnimation?: boolean) => {\n        for(let i=0;i<product.largeImages.length;i++) {\n            if (product.largeImages[i].src.indexOf(value)!==-1) {\n                galleryRef.current?.slideToIndex(i,bypassSlideshowAnimation);\n                return;\n            }\n        }         \n    };\n\n    const backToTopRef = useRef<HTMLDivElement>();\n    const addToCartRef = useRef<HTMLDivElement>();    \n\n    const showBackToTop = useSmartState(false);\n\n    const backToTopClickHandler = () => {\n        page.scrollTo({\n            top: 0,\n            behavior: \"smooth\"\n        });\n    };\n\n    const addToCartHeight = 370;\n\n    useEffect(() => {\n        return router.beforePushSubscribe((cb) => {\n            page.scrollToTopWithCallback(cb);\n            return true;\n        });\n    },[]);\n    \n    useEffect(() => {\n        return page.addScrollEventListener(({top}) => {\n            // const addToCartPos = windowSize.height-(addToCartOffsetTopRef.current-top);\n            // showBackToTop.value = (top>600) && ((addToCartPos<=10) || (addToCartPos>=160));                \n            const { current: backToTopElem } = backToTopRef;\n            const { current: addToCartElem } = addToCartRef;            \n            let blocked = false;\n            if ((backToTopElem) && (addToCartElem)) {\n                const { y: backToTopY } = backToTopElem.getBoundingClientRect();\n                const { y: addToCartY } = addToCartElem.getBoundingClientRect();                \n                const addToCartPos = backToTopY-addToCartY;\n                blocked = (addToCartPos>=-47.5) && (addToCartPos<=99.5);\n            }\n            showBackToTop.value = (top>600) && (!blocked);\n        });\n    },[]);\n    \n    const cssStateManager = useCssStateManager([\"container\"]);\n\n    const descriptionHasTabs = useSmartState(false);\n\n    const currentPrice = useSmartState(0);\n\n    const priceTopSliderOpen = usePubSubReceiver(\"price-top-slider-open\",false);\n    cssStateManager.useProperty(priceTopSliderOpen.value,\"price-top-slider-open\");\n\n\n    const bottomSectionClosedHeightMobile = 280;\n    const bottomSectionClosedHeightDesktop = 750;\n    const bottomSectionClosedHeight = isMobile.current?bottomSectionClosedHeightMobile:bottomSectionClosedHeightDesktop;\n\n    const bottomSectionExpandable = useExpandable(bottomSectionClosedHeight);\n\n    cssStateManager.useProperty(bottomSectionExpandable.disabled,\"description-expandable-disabled\");\n\n    const alreadyAddedToCart = useSmartState(false);\n    const alreadyAlreadyAddedToCart = useSmartState(true);\n    const addToCartEnabled = useSmartState(false);\n\n    const topSectionRef = useRef<HTMLDivElement>();\n    const titleBadgeRef = useRef<HTMLDivElement>();\n\n    const reviewSectionRef = useRef<HTMLDivElement>();    \n\n    const readMoreReviewsClickHandler = () => {\n        if (reviewSectionRef.current) {\n            const reviewSectionOffsetTop = misc.getOffsetRelativeToParent(reviewSectionRef.current,\".page\").top;\n            page.scrollTo({\n                top: reviewSectionOffsetTop-scaleRemToPixel(78),\n                behavior: \"smooth\"\n            });    \n        }        \n    };\n\n    const descriptionDecisionResizeCounter = useSmartState(0);\n\n    const optionsInnerWrapperResizeTimeoutHandle = useRef(0);\n\n    const optionsInnerWrapperRef = useResizeObserver(() => {\n        clearTimeout(optionsInnerWrapperResizeTimeoutHandle.current);\n        optionsInnerWrapperResizeTimeoutHandle.current = setTimeout(() => {\n            descriptionDecisionResizeCounter.value++;\n        },100) as unknown as number;      \n    });\n    \n    const optionDescriptionRef = useRef<HTMLDivElement>();\n    const identifierRef = useResizeObserver(() => {\n        descriptionDecisionResizeCounter.value++;\n    });\n\n    const hasOptions = cssStateManager.useState(false,\"has-options\");\n\n    type DescriptionPosition = \"Undecided\" | \"Options\" | \"Body\";\n    const descriptionPosition = useSmartState<DescriptionPosition>(\"Undecided\");\n\n    useEffect(() => {\n        if (optionsInnerWrapperRef.current) {\n            const { current: optionsInnerWrapperElem } = optionsInnerWrapperRef;\n            hasOptions.value = (optionsInnerWrapperElem.offsetHeight>0);\n        }\n    },[]);\n\n    mobileDetectUseEffect((isMobile) => {\n        if (isMobile) {\n            descriptionPosition.value = \"Body\";\n        }\n        else {\n            if ((optionsInnerWrapperRef.current) && (identifierRef.current)) {\n                const { current: optionsInnerWrapperElem } = optionsInnerWrapperRef;\n                const { current: identifierElem } = identifierRef;\n                const galleryElem = identifierElem.querySelector(\".gallery\") as HTMLDivElement;\n                const galleryAreaHeight = identifierElem.offsetHeight-(galleryElem?misc.getOffsetRelativeToParent(galleryElem,\".identifier\")?.top || 0:0);                \n                const optionsHeight = scalePixelToRem(optionsInnerWrapperElem.offsetHeight);\n                descriptionPosition.value = (optionsHeight<=galleryAreaHeight*1.15)?\"Options\":\"Body\";\n            }\n        }\n    },[descriptionDecisionResizeCounter.value],\"small_desktop\");\n\n    cssStateManager.useProperty(descriptionPosition.value===\"Undecided\",\"description-position-undecided\");\n\n    const optionsDescriptionBeforeShowLessHandler = () => {\n        page.scrollTo({\n            top: 0,\n            behavior: \"smooth\"\n        })\n    };\n\n    const bodyDescriptionRef = useRef<HTMLDivElement>();\n\n    const bodyDescriptionBeforeShowLessHandler = () => {\n        const { current: bodyDescriptionElem } = bodyDescriptionRef;\n        if (bodyDescriptionElem) {\n            page.scrollTo({\n                top: misc.getOffsetRelativeToParent(bodyDescriptionElem,\".page\").top-scaleRemToPixel(75),\n                behavior: \"smooth\"\n            })\n        }\n    };\n\n    const optionsHaveAddOns = useSmartState<OptionsHaveAddons>(\"unknown\");\n\n    cssStateManager.useProperty(optionsHaveAddOns.value===\"yes\",\"options-have-addons\");\n\n    const frequentlyBoughtTogetherProductIds = consumeBoughtTogetherClient([product.id]);\n\n    const lastProductIdRef = useRef(product.id);\n    const productChangeCounterRef = useRef(0);\n\n    if (product.id!==lastProductIdRef.current) {\n        lastProductIdRef.current = product.id;\n        productChangeCounterRef.current++;\n    }\n\n    const pageUrl = useCachedValue(() => prebuildData.getProductPageRoute(product.id.toString()),product.id);\n\n    const { productBreadcrumbs: { linkColor,linkHoverColor,textColor } } = prebuildData.getActiveTheme();\n\n    return (\n        <>\n            <Head>\n                {getInjectableHeaderTags(product.seo.title,product.seo.description,pageUrl)}\n            </Head>\n            <div className={cssStateManager.getClassNames()}>\n                <div className=\"frame\">\n                    <div className=\"mobile-product-top-bar\">\n                        <CollectionNavBar \n                            leftIconName=\"navbar-left-arrow\"\n                            leftIconClickHandler={crumbCategoryClickHandler}\n                            leftIconSeoLinkUrl={collectionRoute}\n                            collectionItem={collection}\n                            collectionItems={collectionItems}\n                        />\n                    </div> \n                    <div className=\"mobile-header\">\n                        <ProductHeader product={product} currentPrice={currentPrice} />\n                    </div>\n                    <div ref={topSectionRef} className=\"top-section\">\n                        <div className=\"identifier\" ref={identifierRef}>\n                            <div className=\"breadcrumbs\">\n                                <span className=\"crumb clickable\" onClick={crumbHomeClickHandler}><a href=\"/\" onClick={(e) => e.preventDefault()}>Home</a></span>\n                                <span className=\"separator\">&gt;</span>\n                                <span className=\"crumb clickable\" onClick={crumbCategoryClickHandler}><a href={collectionRoute} onClick={(e) => e.preventDefault()}>{collection.caption}</a></span>\n                                <span className=\"separator\">&gt;</span>\n                                <span className=\"crumb last-crumb\">{product.caption}</span>\n                            </div>\n                            <div className=\"gallery\">\n                                <ProductGallery ref={galleryRef} product={product} onFrameResize={(height) => galleryHeight.value = height} />\n                            </div>\n                            <div className=\"nicotine-warning\">\n                                <div className=\"outline\">\n                                    <div className=\"warning\">WARNING</div>\n                                    <div className=\"text-line\">This product contains nicotine. Nicotine is an addictive chemical</div>\n                                </div>\n                            </div>\n                            <NoticeAction action={productOptions.vars[\"action\"]} />\n                        </div>\n                        {isMobile.current?(\n                            <div className=\"includes\">\n                                <Includes product={product} enabled={false} />\n                            </div>\n                        ):\"\"}                        \n                        <div className=\"options\">                            \n                            <Options\n                                editCartItem={editCartItem}\n                                product={product} \n                                currentPrice={currentPrice} \n                                galleryHeight={galleryHeight.value} \n                                onSlideShowMatch={slideShowMatchHandler} \n                                addToCartRef={addToCartRef}\n                                alreadyAddedToCart={alreadyAddedToCart}\n                                alreadyAlreadyAddedToCart={alreadyAlreadyAddedToCart}\n                                addToCartEnabled={addToCartEnabled}\n                                addToCartActionsRef={addToCartActionsRef}\n                                topSectionRef={topSectionRef}\n                                titleBadgeRef={titleBadgeRef}\n                                innerWrapperRef={optionsInnerWrapperRef}\n                                hasAddOns={optionsHaveAddOns}\n                                descriptionHasTabs={descriptionHasTabs.value}\n                            />                    \n                            {((descriptionPosition.value===\"Undecided\") || (descriptionPosition.value===\"Options\"))?(\n                                <div className=\"options-description-wrapper\">\n                                    <div className=\"top-separator\">\n                                        <div className=\"above-separator-line\"></div>\n                                        <div className=\"below-separator-line\"></div>\n                                    </div>\n                                    <ProductDescriptionExpandable \n                                        productId={product.id} \n                                        descriptionRef={optionDescriptionRef} \n                                        hideBottomLine \n                                        onBeforeShowLess={optionsDescriptionBeforeShowLessHandler}\n                                        displayStyle=\"tight\"                                        \n                                    />\n                                </div>\n                            ):\"\"}                            \n                        </div>                        \n                        <div className=\"title-price-badge\" ref={titleBadgeRef}>\n                            <TitlePriceBadge       \n                                editCartItem={editCartItem.value}                      \n                                product={product}\n                                price={currentPrice.value}\n                                alreadyAddedToCart={alreadyAddedToCart.value}\n                                alreadyAlreadyAddedToCart={alreadyAlreadyAddedToCart.value}\n                                enabled={addToCartEnabled.value}\n                                addToCartActionsRef={addToCartActionsRef}\n                                onReadMoreReviewsClick={readMoreReviewsClickHandler}\n                                noticeText={productOptions.vars[\"notice\"]}\n                            />\n                        </div>\n                    </div>\n                    <div className=\"top-bottom-spacer-above-line\"></div>\n                    <div className=\"separator-line\"></div>\n                    <div className=\"top-bottom-spacer-below-line\"></div>\n                    <div className=\"bottom-section-flex-hori\">\n                        <div className=\"bottom-section-group\">                               \n                            {(descriptionPosition.value===\"Body\")?(\n                                <>\n                                    <ProductDescriptionExpandable \n                                        productId={product.id} \n                                        onBeforeShowLess={bodyDescriptionBeforeShowLessHandler} \n                                        descriptionRef={bodyDescriptionRef} \n                                        displayStyle=\"relaxed\"\n                                        descriptionHasTabs={descriptionHasTabs}\n                                    />\n                                </>\n                            ):(\n                                <div className=\"description-undecided-margin-adjuster\"></div>\n                            )}                                                                                   \n                            {isMobile.current?(\n                            <div className=\"frequently-bought-with\">\n                                {frequentlyBoughtTogetherProductIds?(\n                                    <FrequentlyBoughtWith productIds={frequentlyBoughtTogetherProductIds} />\n                                ):<div className=\"also-bought-together-spinner-container\"><CenteredSpinner /></div>}                                                                \n                            </div>\n                            ):\"\"}\n                            <div className=\"review-section\" ref={reviewSectionRef}>\n                                <Reviews product={product} />\n                            </div>\n                        </div>\n                        {!isMobile.current?(\n                            <div className=\"vertical-frequently-bought-with\">\n                                {frequentlyBoughtTogetherProductIds?(\n                                    <AlsoBought \n                                        closeSideCartHandler={() => {}} \n                                        itemCount={1} \n                                        show={true} \n                                        onHidden={() => {}} \n                                        productIds={frequentlyBoughtTogetherProductIds} \n                                        onProductPage\n                                    />\n                                ):<div className=\"also-bought-together-spinner-container\"><CenteredSpinner /></div>}                                \n                            </div>\n                        ):\"\"}                        \n                    </div>\n                </div>\n            </div>     \n            <div className=\"back-to-top\">\n                <BackToTop \n                    containerRef={backToTopRef}\n                    position=\"fixed\"\n                    show={showBackToTop.value}\n                    right={15}\n                    bottom={25}\n                    handleScrollToTop={backToTopClickHandler}\n                />   \n            </div>    \n            <style jsx>{`\n            .container {\n                --border-color: #ddd;\n                padding: 30rem 75rem;\n                display: flex;\n                justify-content: center;            \n            }\n            .description-undecided-margin-adjuster {\n                margin-top: -30rem;\n            }\n            .bottom-section-flex-hori {\n                display: flex;\n                flex-direction: row;                \n            }\n            .bottom-section-group {\n                flex: 1 1 auto;\n            }\n            .top-bottom-spacer-above-line {\n                height: 60rem;\n            }\n            .top-bottom-spacer-below-line {\n                height: 30rem;\n            }\n            .separator-line {\n                height: 1rem;\n                background-color: #ddd;\n            }\n            .vertical-frequently-bought-with {\n                flex: 0 0 470rem;\n                padding-left: 50rem;\n            }\n            .frame {\n                width: 100%;\n                max-width: 1600rem;                \n            }\n            .top-section {\n                width: 100%;\n                display: flex;            \n            }\n            .identifier {\n                flex: 50%;\n                position: sticky;\n                top: 60rem;\n                align-self: flex-start;\n            }\n            .identifier .crumb {}\n            .identifier .clickable {\n                cursor: pointer;\n                color: ${linkColor};\n                transition: color 0.3s;\n            }\n            .identifier .clickable:hover {                \n                color: ${linkHoverColor};\n            }\n            .identifier .separator {\n                padding: 0rem 9rem;                \n            }\n            .identifier .clickable a {\n                text-decoration: none;\n                color: inherit;\n            }\n            .gallery {}\n            .options {\n                flex: 0 0 ${optionsWidths.large}rem;\n            }\n            .breadcrumbs {\n                margin-bottom: 20rem;\n                opacity: 1;\n                transition: opacity 0.3s;\n                white-space: nowrap;                \n                overflow: hidden;                \n                text-overflow: ellipsis;\n                color: ${textColor};\n            }\n            .last-crumb {                \n            }\n            .price-top-slider-open .breadcrumbs {\n                opacity: 0;\n            }\n            .nicotine-warning {                                                \n                color: #363636;\n                text-align: center;\n                margin-top: 20rem;            \n                padding: 0rem 32rem;\n            }\n            .outline {                \n                border: 3rem solid #222222;\n                padding: 10rem;\n            }\n            .warning {\n                font-size: 19rem;\n                font-weight: 600;\n                padding-bottom: 2rem;            \n            }\n            .text-line {\n                font-size: 13rem;\n            }\n            .options {\n                padding-left: 70rem;\n            }\n            .mobile-header {\n                display: none;\n            }\n\n            .mobile-product-top-bar {\n                display: none;\n            }\n\n            .back-to-top {\n                display: none;\n            }\n\n            .description-wrapper {\n                padding-bottom: 50rem;\n            }\n\n            .description-position-undecided .options-description-wrapper {\n                overflow-y: hidden;\n                height: 0rem;\n            }\n\n            .options-description-wrapper .top-separator {\n                display: none;\n            }\n\n            .has-options .options-description-wrapper .top-separator {\n                display: block;\n            }\n\n            .options-description-wrapper {\n                --separator: 25rem;\n            }\n\n            .options-description-wrapper .above-separator-line {\n                height: var(--separator);\n            }\n            .options-have-addons .options-description-wrapper .above-separator-line {\n                height: calc(var(--separator) + 14rem);\n            }\n            .options-description-wrapper .below-separator-line {\n                border-top: 1rem solid var(--border-color);\n                height: calc(var(--separator) - 13rem);\n            }\n\n            .frequently-bought-with {\n                display: none;\n            }\n\n            .title-price-badge {\n                position: sticky;\n                top: 60rem;\n                padding-left: 50rem;\n                /* padding-left: 64rem; */\n                padding-top: 40rem;\n                flex: 1 1 auto;\n                align-self: flex-start;\n            }\n\n            .bottom-section-group {\n                --body-section-closed-height: ${bottomSectionClosedHeightDesktop}rem;                    \n            }                \n\n            .review-section {\n                padding-top: 60rem;\n            }\n\n            .also-bought-together-spinner-container {\n                padding-top: 30rem;\n            }\n             \n            @media screen and (max-width: ${mobileCutoff}px) {\n                .container {\n                    padding: 30rem 30rem;\n                }\n\n                .top-section {\n                    /* flex-direction: column; */\n                    display: block;\n                }\n\n                .identifier {\n                    position: static;\n                    top: auto;                   \n                }\n\n                .options {\n                    padding-left: 0rem;\n                    max-width: none;\n                }\n\n                .mobile-header {\n                    display: block;\n                    padding-bottom: 15rem;\n                }\n\n                .breadcrumbs {\n                    display: none;\n                }\n\n                .nicotine-warning {\n                    padding: 0rem 0rem;\n                }\n\n                .mobile-product-top-bar {\n                    display: block;                    \n                    margin-left: -10rem;\n                    margin-right: -5rem;\n                    margin-top: -10rem;\n                    /*\n                    padding-left: 20rem;\n                    padding-right: 25rem;                    \n                    padding-top: 20rem;\n                    */\n                    padding-bottom: 20rem;\n                }\n\n                .back-to-top {\n                    display: block;\n                }\n\n                .description-wrapper {\n                    padding-top: 0rem;\n                }\n\n                .bottom-section-group {\n                    --body-section-closed-height: ${bottomSectionClosedHeightMobile}rem;                    \n                    width: 100%;\n                    flex: 0 0 auto;\n                }                \n\n                .title-price-badge {\n                    display: none;\n                }\n\n                .vertical-frequently-bought-with {\n                    display: none;\n                }\n\n                .top-bottom-spacer-above-line {\n                    display: none;\n                }\n\n                .top-bottom-spacer-below-line {\n                    display: none;\n                }\n\n                .separator-line {\n                    display: none;\n                }\n\n                .frequently-bought-with {\n                    margin-top: 34rem;\n                    display: block;\n                    width: 100%;\n                    padding-bottom: 62rem;\n                    border-bottom: 1rem solid #ddd;\n                    margin-bottom: -12rem;\n                }\n            }\n\n            @media screen and (min-width: ${widthCutoff}px) and (max-width: ${smallDesktopWidthCutoff}px) {\n                .container {\n                    padding: 30rem 70rem;\n                }               \n            }\n\n            @media screen and (max-width: ${optionsCutoffs.large}px) {\n                .options {\n                    flex: 0 0 ${optionsWidths.medium}rem;\n                }               \n            }\n\n            @media screen and (max-width: ${optionsCutoffs.medium}px) {\n                .options {\n                    flex: 0 0 ${optionsWidths.small}rem;\n                }               \n            }\n\n            @media screen and (max-width: 1630px) {\n                .breadcrumbs {\n                    width: 450rem;\n                }\n            }\n\n            @media screen and (max-width: 1600px) {\n                .breadcrumbs {\n                    width: 400rem;\n                }    \n            }            \n\n            @media screen and (max-width: 1550px) {\n                .breadcrumbs {\n                    width: 350rem;\n                }    \n            }            \n\n            @media screen and (max-width: 1360px) {\n                .breadcrumbs {\n                    width: 300rem;\n                }    \n            }            \n\n            `}            \n            </style>\n        </>\n    );\n}","'use strict';\n\nvar React = require('react');\n\nfunction useAsyncEffect(effect, destroy, inputs) {\n  var hasDestroy = typeof destroy === 'function';\n\n  React.useEffect(function () {\n    var result;\n    var mounted = true;\n    var maybePromise = effect(function () {\n      return mounted;\n    });\n\n    Promise.resolve(maybePromise).then(function (value) {\n      result = value;\n    });\n\n    return function () {\n      mounted = false;\n\n      if (hasDestroy) {\n        destroy(result);\n      }\n    };\n  }, hasDestroy ? inputs : destroy);\n}\n\nmodule.exports = useAsyncEffect;\nmodule.exports.useAsyncEffect = useAsyncEffect;\n"],"names":["window","__NEXT_P","push","SvgButton","src","aspectRatio","height","padding","paddingVert","paddingHori","filter","filterHover","filterTouchdown","animationDuration","opacity","opacityHover","opacityTouchdown","onClick","imgSize","misc","width","div","style","Image","className","layout","EventPane","touchDownOnMouseDown","FillImage","cssStateManager","useCssStateManager","show","useState","getClassNames","onLoad","value","GradualFillImage","smallSrc","largeSrc","useContext","LayoutStateContext","scalePixelToRem","showLarge","loadLarge","useSmartState","ref","useRef","current","offsetHeight","SliderPane","visible","position","_ProductGallery","product","onFrameResize","mobileDetect","scaleRemToPixel","widthCutoff","largeImages","smallImages","rawIndexToRealIndex","images","length","i","rawIndexReserves","Object","keys","forEach","_rawIndex","rawIndex","parseInt","realIndex","containIndex","index","viewIndex","thumbViewIndexRef","jumpViewIndexRef","lineUp","map","shift","bypassAnimationRef","useProperty","slideToLeft","slideToRight","disableTransition","transitionEndCbRef","setSlidePosition","cb","sliderButtonHeight","sliderButtonPadding","sliderButtonOpacity","sliderButtonOuterShift","thumbSize","thumbSpacer","thumbsFrameRef","scrollThumbToCenter","thumbSizePixels","thumbSpacerPixels","frameWidth","thumbsFrameElem","offsetWidth","idealScrollLeft","scrollTo","left","behavior","slideToNext","newViewIndex","slideToPrevious","slideToIndex","bypassSlideshowAnimation","nextIndex","previousIndex","useImperativeHandle","useEffect","imageIndexes","frameRef","useResizeObserver","initialCall","touchPaneRef","sliderRef","sliderTransitionAdjustment","trackTouchMoveDelta","wx","transition","transform","onStart","onEnd","sliderWidth","deltaDirection","preventDefaultOnDelta","sliderTranslateXPercNormal","sliderTranslateXPerc","sliderTransitionDurationNormal","sliderTransitionDuration","mobileCutoff","onTransitionEnd","e","propertyName","saved","undefined","transitionHasEnded","prebuildData","thumbs","indexOf","forwardRef","YesNo","quantityOn","productOptions","sliderNoColor","sliderNoTextColor","sliderYesColor","sliderYesTextColor","QuantityOption","quantity","smallDesktopWidthCutoff","lightTextColor","caption","OptionTitle","subCaption","price","priceEnabled","textColor","addonsPriceSelectedTextColor","addonsPriceUnselectedTextColor","span","br","PriceDisplay","size","plus","QuantitySelect","excludeZero","bypassCustomFocus","onBypassCustomFocusDone","inBadge","custom","textRef","focus","val","buttonSelectedTextColor","buttonBackgroundColor","buttonUnselectedTextColor","select","onChange","target","valueDisplay","toString","Array","fill","_","option","input","onBlur","intValue","textValue","split","ch","test","join","SelectWithQuantity","title","subTitle","unselectedCaption","entries","onValue","loadFromSavedValue","unselectedValue","removeValue","selectValue","initialQuantityValue","quantityValue","onSet","type","id","bypassCustomFocusRef","cbs","channel","CheckboxOption","productId","description","titleStyle","included","selected","thumbSrcRef","handleClick","newValue","buttonSelectedBackgroundColor","addonsDescriptionColor","addonsIncludedDescriptionColor","SquareImage","fadeIn","PlaceholderBar","marginBottom","enabled","backgroundColor","ReviewHighlight","onReadMoreReviewsClick","hideReview","body","author","placeholderFlashOn","reviewReady","containerHeight","containerHeightDuration","reviewRef","placeholderRef","useAsyncEffect","isMounted","review","diff","apiReview","console","log","name","Math","abs","setTimeout","productPriceTitleBadge","reviewBodyTextColor","readMoreHoverTextColor","readMoreTextColor","getContainerHeightValue","elem","Separator","separatorLineColor","Includes","optionsCompiler","includedOptions","getProductOptions","options","lowerCaseCaption","toLowerCase","getCaption","productFn","checkboxProductFnCache","Notice","text","dangerouslySetInnerHTML","__html","TitlePriceBadge","editCartItem","addToCartActionsRef","alreadyAddedToCart","alreadyAlreadyAddedToCart","noticeText","consumeReviewsHeader","reviewsCount","starRating","discountedPrice","borderColor","optionsReadyBorderColor","priceTextColor","reviewCountColor","teaseCaption","visibility","PriceUpdate","StarRating","rating","scale","AddToCart","added","already","onViewInCart","onSaveClick","containerRef","descriptionHasTabs","sliderIsOpen","top","buttonColor","buttonTextColor","hoverOnTouchDown","Button","minWidth","unselected","onSelected","canToggle","customRange","min","max","decimalUnit","subText","customDisplay","customPlaceholder","onCustomValue","customSubText","customSubCaptionExtra","hasDecimal","editing","showCustomValue","customValue","customIntLength","floor","customPlaceholderText","repeat","inputRefDesktop","inputRefMobile","isSmallDesktopScreen","inputRefFn","isMobileActive","customDisplayFnRef","bypassSelectionRef","hasOwnProperty","updateValue","inputRef","inputValue","auto","parseFloat","inputSet","endsWith","value10","round","min10","max10","decimal","int","inputChangeHandler","dotFound","maxLength","maxLengthWithoutDecimal","processDotLess","substring","charAt","before","after","handleInputKeyUp","code","buttonBorderColor","buttonSelectedBorderColor","display","onKeyUp","ButtonsOption","quantityWrapperRef","buttons","onSlideShowMatch","selectedIndex","quantityValueToLoadRef","quantityWrapperHeight","ceil","slideshowMatch","CheckboxGroupOption","loadFromSavedValueRef","ids","toggleSelected","Color","color","onSelect","onStartHover","onEndHover","overlapHori","ColorPickerOption","colors","initialSelectedItemIndex","permanentFooterText","hoverFooterText","footerText","colorPickerChoiceTextColor","colorPickerHoverTextColor","SingleSelect","required","fadeDuration","MultiSelectOption","values","selectHeight","selectsCount","showAll","selectsHeight","captions","splice","spacing","SelectComponent","removable","valueType","selectedValue","selectChangeHandler","PriceTopSlider","topSectionRef","titleBadgeRef","miniNavbarDown","usePubSubReceiver","passedScroll","priceTopSliderOpen","send","usePubSubSender","sendPriceTopSliderOpen","page","dollar","cents","addScrollEventListener","getDesktopCutoff","productTitlePriceTopSlider","backdropFilter","borderBottomColor","mobileborderBottomColor","ProductHeader","currentPrice","Options","addToCartEnabled","galleryHeight","addToCartRef","innerWrapperRef","hasAddOns","sideCart","mobileDetectUseEffect","pageRef","productPageLoadCounter","originalProductId","includedCheckboxOptions","nonIncludedCheckboxOptions","hasIncluded","firstNonIncludedCheckboxIndex","sliderState","sliderHeightTransitionDuration","addToCartDisabledBypass","lsDigestKey","loadFromSavedOptionValues","cartItemRef","optionIdListRef","requiredOptionsHashRef","digestLoadedRef","enabledOptionsHashInit","isOpenRef","genEnabledOptionsHash","ret","enabledValue","isOpen","optionIdList","optionId","requiredOptionsHash","includedId","addToCartId","currentCartItemDigestRef","cart","digest","saveItemCartToLocalStorage","savedOptionValues","acceptedKeys","cartLink","cartItem","optionValues","key","defaultSet","lstore","activatedOptionsMap","generateCartItemInitialOptionValues","quantityDisplay","uuid","version","items","item","multiSelect","currentlyEditingUuid","digestValue","tmpCartItem","processLoadedDigestForMobileSliderHeightState","optionValue","removeDeadVariants","enabledOptionsHash","scrollToOption","optionsSliderRef","optionElem","querySelector","pageElem","midpointOffsetTopFromScreen","offsetTop","offsetParent","scrollTop","delta","innerHeight","startScrollTop","duration","lastSetScroll","timestamp","Date","getTime","next","x","timespan","pow","requestAnimationFrame","refreshPrice","incVersion","generateCartItemPriceProperties","enforceLimitOnePerOrder","ignoreUuid","updateItemCartOptionValue","found","beforeEnabledHash","afterEnabledHash","newlyEnabledOptionId","slideFrameRef","tempDisableAddToCartRef","addToCartClickHandler","calculateSliderHeightTransitionDuration","firstOptionId","highlightIds","flashIds","open","addToCartViewInCartHandler","foundFirstCartLink","isFirstCartLink","component","colorPickerSize","addedOptionCount","getSimpleOptionPrice","isSimpleObject","range","from","to","unit","placeholder","filters","sort","itemCaption","products","productSelectProductListCache","itemCaptionFn","productSelectItemCaptionFnCache","multiple","limitOnePerOrder","variants","variantSelectItemsFnCache","variant","dollarPriceToCentPrice","classNameAddons","variantSelectItemCaptionFnCache","stubs","variantId","res","exec","trim","vars","VerticalSlider","children","isArray","targetItemWidth","itemWidth","spacer","viewIndexRef","itemsPerPageRef","isTransitioningRef","scrollLeft","scrollTransitionDuration","refOnResize","remainder","times","potSpacer","maxIndex","targetIndex","newScrollLeft","getScrollLeftFromIndex","slideToViewIndex","index1","index2","toScrollLeft","distance","element","flex","marginRight","toIndex","ProductItem","router","useCustomRouter","dataRef","imageSrc","imageHoverSrc","productPageRoute","useCachedValue","GridItem","data","clickHandler","FrequentlyBoughtWith","productIds","useDesktopScrollbar","styles","injectedStyles","alsoBoughtWith","titleColor","sliderInjectedStyles","isMobile","sliderStyles","sliderClassName","reviewBarFontSize","ReviewBar","starCount","percentage","reviewCount","reviewCountTextWidth","notSelected","productReviews","reviewStarsBarHoverTextColor","reviewStarsBarHighlighterColor","reviewStarsBarBorderColor","reviewStarsBarPercentageBarColor","reviewStarsBarPercentageBarHoverColor","reviewStarsBarPercentageBarBorderColor","reviewStarsBarPercentageBarHoverBorderColor","reviewStarsBarPercentageBarSelectedColor","ratingFilterBadgeCrossColor","overlapVert","ReviewItem","first","reviewItemTextColor","reviewItemDateTextColor","reviewItemAvatarBackgroundColor","toUpperCase","date","monthTable","getMonth","getDate","getFullYear","timestampToDateDisplay","NoReviews","noReviewsTextColor","noReviewsIconColor","ReviewList","reviews","CenteredSpinner","LoadMoreSection","initialShowState","onLoadMore","loadingMoreReviews","showState","useStringState","loadMoreButtonColor","loadMoreButtonHoverColor","loadMoreButtonTextColor","hasMore","Reviews","byRating","summary","libMockReviews","useProductReviewSummary","header","reviewsState","lastSortKeyRef","reviewsOrder","firstPassRef","reviewListRef","loadMoreKey","loadMoreInitialStateRef","reviewsOrderChangedFirstRef","loadingNewOrder","reviewListRemHeight","lastRatingValueRef","lastSortKey","maxTextWidth","ratings","reviewTotal","ratingPercentages","percentageTotal","pnt","loadMoreHandler","lighterTextColor","ratingFilterBadgeColor","ratingFilterBadgeHoverColor","ratingFilterBadgeTextColor","ratingFilterBadgeBorderColor","whole","ratingToSingleDecimal","disabled","Icon","NavigationArrow","side","iconSize","fontSize","zIndex","TabsHeader","displayStyle","hasScroll","isActive","windowSize","WindowSizeContext","headersRef","headerWidthsRef","showLeftNavigator","showRightNavigator","scrollerRef","scrollHandler","updateHasScroll","availableScroll","scrollerElem","scrollWidth","navigatorClickHandler","getHeaderOffsetLeft","headerWidths","reduce","acc","inc","centeredScrollLeft","targetScrollLeft","headerElem","headersElem","selectorLineStyles","navigatorProps","productDescriptionTabs","hoverTextColor","selectedColor","onScroll","optionsWidths","optionsCutoffs","useExpandable","closedHeight","onBeforeShowLess","innerOffsetHeight","innerRef","initialHeightAssessedRef","transitionDurationRef","isDisabled","scaleFactorDetectUseEffect","calculateTransitionDuration","controllerStyle","fadeStyle","directionClassName","ProductDescription","descriptionRef","rawDescriptionHtml","descriptionHtml","decriptionRef","querySelectorAll","anchorElem","href","getAttribute","startsWith","onclick","preventDefault","productDescription","boldTextColor","linkTextColor","tableAltBackgroundColor","tableBackgroundColor","tableBorderColor","DescriptionTabs","tabs","selectedHeaderIndex","tabHtml","ProductDescriptionExpandable","hideBottomLine","hasTabsRef","hasTabs","descriptionClosedHeightMobile","descriptionClosedHeight","descriptionExpandable","tabsCacheRef","tabsProductIdCacheRef","lastPartCaption","Product","reactRouter","useRouter","lastIsMobileRef","query","product_id","productHandle","ProductContent","collectionHandle","NoticeAction","action","alias","productStub","pageRoute","seoLinkUrl","collection","collectionItems","omitSupport","collectionRoute","route","crumbCategoryClickHandler","galleryRef","backToTopRef","showBackToTop","beforePushSubscribe","scrollToTopWithCallback","blocked","addToCartElem","addToCartPos","backToTopElem","getBoundingClientRect","y","bottomSectionClosedHeightMobile","bottomSectionClosedHeightDesktop","bottomSectionClosedHeight","bottomSectionExpandable","reviewSectionRef","descriptionDecisionResizeCounter","optionsInnerWrapperResizeTimeoutHandle","optionsInnerWrapperRef","clearTimeout","optionDescriptionRef","identifierRef","hasOptions","descriptionPosition","optionsInnerWrapperElem","galleryElem","identifierElem","galleryAreaHeight","optionsHeight","bodyDescriptionRef","optionsHaveAddOns","frequentlyBoughtTogetherProductIds","consumeBoughtTogetherClient","lastProductIdRef","productChangeCounterRef","pageUrl","productBreadcrumbs","linkColor","linkHoverColor","Head","getInjectableHeaderTags","seo","CollectionNavBar","leftIconName","leftIconClickHandler","leftIconSeoLinkUrl","collectionItem","a","ProductGallery","reviewSectionOffsetTop","bodyDescriptionElem","AlsoBought","closeSideCartHandler","itemCount","onHidden","onProductPage","BackToTop","right","bottom","handleScrollToTop","React","effect","destroy","inputs","hasDestroy","result","mounted","maybePromise","Promise","resolve","then","module","exports"],"sourceRoot":""}